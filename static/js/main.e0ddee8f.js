/*! For license information please see main.e0ddee8f.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var r=n(853),i=n(43),s=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var f=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),x=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope");var I=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var C=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var N=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var D=Symbol.for("react.client.reference");function M(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===D?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case _:return"Suspense";case E:return"SuspenseList";case I:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case x:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return M(e(t))}catch(n){}}return null}var O=Array.isArray,P=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},j=[],F=-1;function V(e){return{current:e}}function z(e){0>F||(e.current=j[F],j[F]=null,F--)}function U(e,t){F++,j[F]=e.current,e.current=t}var B,q,G=V(null),H=V(null),K=V(null),Q=V(null);function W(e,t){switch(U(K,t),U(H,e),U(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vh(t=yh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(G),U(G,e)}function X(){z(G),z(H),z(K)}function Y(e){null!==e.memoizedState&&U(Q,e);var t=G.current,n=vh(t,e.type);t!==n&&(U(H,e),U(G,n))}function J(e){H.current===e&&(z(G),z(H)),Q.current===e&&(z(Q),ud._currentValue=R)}function $(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||"",q=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+B+e+q}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){r=s}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?$(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return $(e.type);case 16:return $("Lazy");case 13:return e.child!==t&&null!==t?$("Suspense Fallback"):$("Suspense");case 19:return $("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return $("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,se=r.unstable_cancelCallback,oe=r.unstable_shouldYield,ae=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,he=r.unstable_UserBlockingPriority,de=r.unstable_NormalPriority,fe=r.unstable_LowPriority,pe=r.unstable_IdlePriority,me=r.log,ge=r.unstable_setDisableYieldValue,ye=null,ve=null;function be(e){if("function"===typeof me&&ge(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(ye,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xe(e)/Se|0)|0},xe=Math.log,Se=Math.LN2;var _e=256,Ee=262144,Te=4194304;function ke(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ie(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,s=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~s)?i=ke(r):0!==(o&=a)?i=ke(o):n||0!==(n=a&~e)&&(i=ke(n)):0!==(a=r&~s)?i=ke(a):0!==o?i=ke(o):n||0!==(n=r&~e)&&(i=ke(n)),0===i?0:0!==t&&t!==i&&0===(t&s)&&((s=i&-i)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:i}function Ce(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ne(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ae(){var e=Te;return 0===(62914560&(Te<<=1))&&(Te=4194304),e}function De(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Me(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-we(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Pe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-we(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Le(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Re(n))&(e.suspendedLanes|t))?0:n}function Re(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function je(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:kd(e.type)}function Ve(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var ze=Math.random().toString(36).slice(2),Ue="__reactFiber$"+ze,Be="__reactProps$"+ze,qe="__reactContainer$"+ze,Ge="__reactEvents$"+ze,He="__reactListeners$"+ze,Ke="__reactHandles$"+ze,Qe="__reactResources$"+ze,We="__reactMarker$"+ze;function Xe(e){delete e[Ue],delete e[Be],delete e[Ge],delete e[He],delete e[Ke]}function Ye(e){var t=e[Ue];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qe]||n[Ue]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Rh(e);null!==e;){if(n=e[Ue])return n;e=Rh(e)}return t}n=(e=n).parentNode}return null}function Je(e){if(e=e[Ue]||e[qe]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function $e(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Ze(e){var t=e[Qe];return t||(t=e[Qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[We]=!0}var tt=new Set,nt={};function rt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},at={};function lt(e,t,n){if(i=t,re.call(at,i)||!re.call(ot,i)&&(st.test(i)?at[i]=!0:(ot[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ht(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=dt(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function yt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,i,s,o,a){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ht(t)):e.value!==""+ht(t)&&(e.value=""+ht(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?wt(e,o,ht(t)):null!=n?wt(e,o,ht(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=s&&(e.defaultChecked=!!s),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ht(a):e.removeAttribute("name")}function bt(e,t,n,r,i,s,o,a){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void ft(e);n=null!=n?""+ht(n):"",t=null!=t?""+ht(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o),ft(e)}function wt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function xt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ht(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function St(e,t,n){null==t||((t=""+ht(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ht(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function _t(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(o(92));if(O(r)){if(1<r.length)throw Error(o(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ht(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Tt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Tt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function It(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&kt(e,i,r)}else for(var s in t)t.hasOwnProperty(s)&&kt(e,s,t[s])}function Ct(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Dt(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mt(){}var Ot=null;function Pt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,Rt=null;function jt(e){var t=Je(e);if(t&&(e=t.stateNode)){var n=e[Be]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Be]||null;if(!i)throw Error(o(90));vt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&pt(r)}break e;case"textarea":St(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&xt(e,!!n.multiple,t,!1)}}}var Ft=!1;function Vt(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Lt||null!==Rt)&&(Zc(),Lt&&(t=Lt,e=Rt,Rt=Lt=null,jt(t),e)))for(t=0;t<e.length;t++)jt(e[t])}}function zt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Be]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Ut=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Bt=!1;if(Ut)try{var qt={};Object.defineProperty(qt,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",qt,qt),window.removeEventListener("test",qt,qt)}catch(Jd){Bt=!1}var Gt=null,Ht=null,Kt=null;function Qt(){if(Kt)return Kt;var e,t,n=Ht,r=n.length,i="value"in Gt?Gt.value:Gt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Kt=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Xt(){return!0}function Yt(){return!1}function Jt(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Xt:Yt,this.isPropagationStopped=Yt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),t}var $t,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Jt(tn),rn=f({},tn,{view:0,detail:0}),sn=Jt(rn),on=f({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?($t=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=$t=0,en=e),$t)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),an=Jt(on),ln=Jt(f({},on,{dataTransfer:0})),cn=Jt(f({},rn,{relatedTarget:0})),un=Jt(f({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),hn=Jt(f({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),dn=Jt(f({},tn,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function yn(){return gn}var vn=Jt(f({},rn,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Jt(f({},on,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wn=Jt(f({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn})),xn=Jt(f({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sn=Jt(f({},on,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),_n=Jt(f({},tn,{newState:0,oldState:0})),En=[9,13,27,32],Tn=Ut&&"CompositionEvent"in window,kn=null;Ut&&"documentMode"in document&&(kn=document.documentMode);var In=Ut&&"TextEvent"in window&&!kn,Cn=Ut&&(!Tn||kn&&8<kn&&11>=kn),Nn=String.fromCharCode(32),An=!1;function Dn(e,t){switch(e){case"keyup":return-1!==En.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var On=!1;var Pn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Pn[e.type]:"textarea"===t}function Rn(e,t,n,r){Lt?Rt?Rt.push(r):Rt=[r]:Lt=r,0<(t=rh(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var jn=null,Fn=null;function Vn(e){Xu(e,0)}function zn(e){if(pt($e(e)))return e}function Un(e,t){if("change"===e)return t}var Bn=!1;if(Ut){var qn;if(Ut){var Gn="oninput"in document;if(!Gn){var Hn=document.createElement("div");Hn.setAttribute("oninput","return;"),Gn="function"===typeof Hn.oninput}qn=Gn}else qn=!1;Bn=qn&&(!document.documentMode||9<document.documentMode)}function Kn(){jn&&(jn.detachEvent("onpropertychange",Qn),Fn=jn=null)}function Qn(e){if("value"===e.propertyName&&zn(Fn)){var t=[];Rn(t,Fn,e,Pt(e)),Vt(Vn,t)}}function Wn(e,t,n){"focusin"===e?(Kn(),Fn=n,(jn=t).attachEvent("onpropertychange",Qn)):"focusout"===e&&Kn()}function Xn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zn(Fn)}function Yn(e,t){if("click"===e)return zn(t)}function Jn(e,t){if("input"===e||"change"===e)return zn(t)}var $n="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if($n(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!$n(e[i],t[i]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ir(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sr=Ut&&"documentMode"in document&&11>=document.documentMode,or=null,ar=null,lr=null,cr=!1;function ur(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==or||or!==mt(r)||("selectionStart"in(r=or)&&ir(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&Zn(lr,r)||(lr=r,0<(r=rh(ar,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=or)))}function hr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var dr={animationend:hr("Animation","AnimationEnd"),animationiteration:hr("Animation","AnimationIteration"),animationstart:hr("Animation","AnimationStart"),transitionrun:hr("Transition","TransitionRun"),transitionstart:hr("Transition","TransitionStart"),transitioncancel:hr("Transition","TransitionCancel"),transitionend:hr("Transition","TransitionEnd")},fr={},pr={};function mr(e){if(fr[e])return fr[e];if(!dr[e])return e;var t,n=dr[e];for(t in n)if(n.hasOwnProperty(t)&&t in pr)return fr[e]=n[t];return e}Ut&&(pr=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);var gr=mr("animationend"),yr=mr("animationiteration"),vr=mr("animationstart"),br=mr("transitionrun"),wr=mr("transitionstart"),xr=mr("transitioncancel"),Sr=mr("transitionend"),_r=new Map,Er="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){_r.set(e,t),rt(t,[e])}Er.push("scrollEnd");var kr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ir=[],Cr=0,Nr=0;function Ar(){for(var e=Cr,t=Nr=Cr=0;t<e;){var n=Ir[t];Ir[t++]=null;var r=Ir[t];Ir[t++]=null;var i=Ir[t];Ir[t++]=null;var s=Ir[t];if(Ir[t++]=null,null!==r&&null!==i){var o=r.pending;null===o?i.next=i:(i.next=o.next,o.next=i),r.pending=i}0!==s&&Pr(n,i,s)}}function Dr(e,t,n,r){Ir[Cr++]=e,Ir[Cr++]=t,Ir[Cr++]=n,Ir[Cr++]=r,Nr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Mr(e,t,n,r){return Dr(e,t,n,r),Lr(e)}function Or(e,t){return Dr(e,null,null,t),Lr(e)}function Pr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(i=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,i&&null!==t&&(i=31-we(n),null===(r=(e=s.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),s):null}function Lr(e){if(50<Gc)throw Gc=0,Hc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Rr={};function jr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new jr(e,t,n,r)}function Vr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zr(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Ur(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,n,r,i,s){var a=0;if(r=e,"function"===typeof e)Vr(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case I:return(e=Fr(31,n,t,i)).elementType=I,e.lanes=s,e;case y:return qr(n.children,i,s,t);case v:a=8,i|=24;break;case b:return(e=Fr(12,n,t,2|i)).elementType=b,e.lanes=s,e;case _:return(e=Fr(13,n,t,i)).elementType=_,e.lanes=s,e;case E:return(e=Fr(19,n,t,i)).elementType=E,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:a=10;break e;case w:a=9;break e;case S:a=11;break e;case T:a=14;break e;case k:a=16,r=null;break e}a=29,n=Error(o(130,null===e?"null":typeof e,"")),r=null}return(t=Fr(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function qr(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function Gr(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function Hr(e){var t=Fr(18,null,null,0);return t.stateNode=e,t}function Kr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Qr=new WeakMap;function Wr(e,t){if("object"===typeof e&&null!==e){var n=Qr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Qr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Xr=[],Yr=0,Jr=null,$r=0,Zr=[],ei=0,ti=null,ni=1,ri="";function ii(e,t){Xr[Yr++]=$r,Xr[Yr++]=Jr,Jr=e,$r=t}function si(e,t,n){Zr[ei++]=ni,Zr[ei++]=ri,Zr[ei++]=ti,ti=e;var r=ni;e=ri;var i=32-we(r)-1;r&=~(1<<i),n+=1;var s=32-we(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ni=1<<32-we(t)+i|n<<i|r,ri=s+e}else ni=1<<s|n<<i|r,ri=e}function oi(e){null!==e.return&&(ii(e,1),si(e,1,0))}function ai(e){for(;e===Jr;)Jr=Xr[--Yr],Xr[Yr]=null,$r=Xr[--Yr],Xr[Yr]=null;for(;e===ti;)ti=Zr[--ei],Zr[ei]=null,ri=Zr[--ei],Zr[ei]=null,ni=Zr[--ei],Zr[ei]=null}function li(e,t){Zr[ei++]=ni,Zr[ei++]=ri,Zr[ei++]=ti,ni=t.id,ri=t.overflow,ti=e}var ci=null,ui=null,hi=!1,di=null,fi=!1,pi=Error(o(519));function mi(e){throw xi(Wr(Error(o(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),pi}function gi(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ue]=e,t[Be]=r,n){case"dialog":Yu("cancel",t),Yu("close",t);break;case"iframe":case"object":case"embed":Yu("load",t);break;case"video":case"audio":for(n=0;n<Qu.length;n++)Yu(Qu[n],t);break;case"source":Yu("error",t);break;case"img":case"image":case"link":Yu("error",t),Yu("load",t);break;case"details":Yu("toggle",t);break;case"input":Yu("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Yu("invalid",t);break;case"textarea":Yu("invalid",t),_t(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||ch(t.textContent,n)?(null!=r.popover&&(Yu("beforetoggle",t),Yu("toggle",t)),null!=r.onScroll&&Yu("scroll",t),null!=r.onScrollEnd&&Yu("scrollend",t),null!=r.onClick&&(t.onclick=Mt),t=!0):t=!1,t||mi(e,!0)}function yi(e){for(ci=e.return;ci;)switch(ci.tag){case 5:case 31:case 13:return void(fi=!1);case 27:case 3:return void(fi=!0);default:ci=ci.return}}function vi(e){if(e!==ci)return!1;if(!hi)return yi(e),hi=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bh(e.type,e.memoizedProps)),t=!t),t&&ui&&mi(e),yi(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));ui=Lh(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));ui=Lh(e)}else 27===n?(n=ui,kh(e.type)?(e=Ph,Ph=null,ui=e):ui=n):ui=ci?Oh(e.stateNode.nextSibling):null;return!0}function bi(){ui=ci=null,hi=!1}function wi(){var e=di;return null!==e&&(null===Ac?Ac=e:Ac.push.apply(Ac,e),di=null),e}function xi(e){null===di?di=[e]:di.push(e)}var Si=V(null),_i=null,Ei=null;function Ti(e,t,n){U(Si,t._currentValue),t._currentValue=n}function ki(e){e._currentValue=Si.current,z(Si)}function Ii(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var a=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ii(s.return,n,e),r||(a=null);break e}s=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(o(341));a.lanes|=n,null!==(s=a.alternate)&&(s.lanes|=n),Ii(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Ni(e,t,n,r){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(0!==(524288&i.flags))s=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(o(387));if(null!==(a=a.memoizedProps)){var l=i.type;$n(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===Q.current){if(null===(a=i.alternate))throw Error(o(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(ud):e=[ud])}i=i.return}null!==e&&Ci(t,e,n,r),t.flags|=262144}function Ai(e){for(e=e.firstContext;null!==e;){if(!$n(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Di(e){_i=e,Ei=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Mi(e){return Pi(_i,e)}function Oi(e,t){return null===_i&&Di(e),Pi(e,t)}function Pi(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ei){if(null===e)throw Error(o(308));Ei=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ei=Ei.next=t;return n}var Li="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ri=r.unstable_scheduleCallback,ji=r.unstable_NormalPriority,Fi={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vi(){return{controller:new Li,data:new Map,refCount:0}}function zi(e){e.refCount--,0===e.refCount&&Ri(ji,function(){e.controller.abort()})}var Ui=null,Bi=0,qi=0,Gi=null;function Hi(){if(0===--Bi&&null!==Ui){null!==Gi&&(Gi.status="fulfilled");var e=Ui;Ui=null,qi=0,Gi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ki=P.S;P.S=function(e,t){Oc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ui){var n=Ui=[];Bi=0,qi=Bu(),Gi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Bi++,t.then(Hi,Hi)}(0,t),null!==Ki&&Ki(e,t)};var Qi=V(null);function Wi(){var e=Qi.current;return null!==e?e:pc.pooledCache}function Xi(e,t){U(Qi,null===t?Qi.current:t.pool)}function Yi(){var e=Wi();return null===e?null:{parent:Fi._currentValue,pool:e}}var Ji=Error(o(460)),$i=Error(o(474)),Zi=Error(o(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ns(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Mt,Mt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw os(e=t.reason),e;default:if("string"===typeof t.status)t.then(Mt,Mt);else{if(null!==(e=pc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw os(e=t.reason),e}throw is=t,Ji}}function rs(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw is=t,Ji;throw t}}var is=null;function ss(){if(null===is)throw Error(o(459));var e=is;return is=null,e}function os(e){if(e===Ji||e===Zi)throw Error(o(483))}var as=null,ls=0;function cs(e){var t=ls;return ls+=1,null===as&&(as=[]),ns(as,e,t)}function us(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function hs(e,t){if(t.$$typeof===p)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ds(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=zr(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Gr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===y?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===k&&rs(s)===t.type)?(us(t=i(t,n.props),n),t.return=e,t):(us(t=Br(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Kr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=qr(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Gr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return us(n=Br(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Kr(t,e.mode,n)).return=e,t;case k:return d(e,t=rs(t),n)}if(O(t)||A(t))return(t=qr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return d(e,cs(t),n);if(t.$$typeof===x)return d(e,Oi(e,t),n);hs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===i?c(e,t,n,r):null;case g:return n.key===i?u(e,t,n,r):null;case k:return f(e,t,n=rs(n),r)}if(O(n)||A(n))return null!==i?null:h(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,cs(n),r);if(n.$$typeof===x)return f(e,t,Oi(e,n),r);hs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case m:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return p(e,t,n,r=rs(r),i)}if(O(r)||A(r))return h(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return p(e,t,n,cs(r),i);if(r.$$typeof===x)return p(e,t,n,Oi(t,r),i);hs(t,r)}return null}function v(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===y&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===y){if(7===c.tag){n(l,c.sibling),(h=i(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===k&&rs(b)===c.type){n(l,c.sibling),us(h=i(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===y?((h=qr(u.props.children,l.mode,h,u.key)).return=l,l=h):(us(h=Br(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return a(l);case g:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=i(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=Kr(u,l.mode,h)).return=l,l=h}return a(l);case k:return v(l,c,u=rs(u),h)}if(O(u))return function(i,o,a,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(i,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),o=s(y,o,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return n(i,h),hi&&ii(i,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(o=s(h,o,m),null===u?c=h:u.sibling=h,u=h);return hi&&ii(i,m),c}for(h=r(h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),hi&&ii(i,m),c}(l,c,u,h);if(A(u)){if("function"!==typeof(b=A(u)))throw Error(o(150));return function(i,a,l,c){if(null==l)throw Error(o(151));for(var u=null,h=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(i,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),a=s(b,a,g),null===h?u=b:h.sibling=b,h=b,m=y}if(v.done)return n(i,m),hi&&ii(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(a=s(v,a,g),null===h?u=v:h.sibling=v,h=v);return hi&&ii(i,g),u}for(m=r(m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=s(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach(function(e){return t(i,e)}),hi&&ii(i,g),u}(l,c,u=b.call(u),h)}if("function"===typeof u.then)return v(l,c,cs(u),h);if(u.$$typeof===x)return v(l,c,Oi(l,u),h);hs(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=i(c,u)).return=l,l=h):(n(l,c),(h=Gr(u,l.mode,h)).return=l,l=h),a(l)):n(l,c)}return function(e,t,n,r){try{ls=0;var i=v(e,t,n,r);return as=null,i}catch(o){if(o===Ji||o===Zi)throw o;var s=Fr(29,o,null,e.mode);return s.lanes=r,s.return=e,s}}}var fs=ds(!0),ps=ds(!1),ms=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ys(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function vs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function bs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&fc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Lr(e),Pr(e,null,n),t}return Dr(e,r,t,n),Lr(e)}function ws(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Pe(e,n)}}function xs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ss=!1;function _s(){if(Ss){if(null!==Gi)throw Gi}}function Es(e,t,n,r){Ss=!1;var i=e.updateQueue;ms=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=-536870913&a.lane,p=d!==a.lane;if(p?(gc&d)===d:(r&d)===d){0!==d&&d===qi&&(Ss=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,g=a;d=t;var y=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(y,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=g.payload)?m.call(y,h,d):m)||void 0===d)break e;h=f({},h,d);break e;case 2:ms=!0}}null!==(d=a.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[d]:p.push(d))}else p={lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(p=a).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===s&&(i.shared.lanes=0),Ec|=o,e.lanes=o,e.memoizedState=h}}function Ts(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function ks(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ts(n[e],t)}var Is=V(null),Cs=V(0);function Ns(e,t){U(Cs,e=Sc),U(Is,t),Sc=e|t.baseLanes}function As(){U(Cs,Sc),U(Is,Is.current)}function Ds(){Sc=Cs.current,z(Is),z(Cs)}var Ms=V(null),Os=null;function Ps(e){var t=e.alternate;U(Vs,1&Vs.current),U(Ms,e),null===Os&&(null===t||null!==Is.current||null!==t.memoizedState)&&(Os=e)}function Ls(e){U(Vs,Vs.current),U(Ms,e),null===Os&&(Os=e)}function Rs(e){22===e.tag?(U(Vs,Vs.current),U(Ms,e),null===Os&&(Os=e)):js()}function js(){U(Vs,Vs.current),U(Ms,Ms.current)}function Fs(e){z(Ms),Os===e&&(Os=null),z(Vs)}var Vs=V(0);function zs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Dh(n)||Mh(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Us=0,Bs=null,qs=null,Gs=null,Hs=!1,Ks=!1,Qs=!1,Ws=0,Xs=0,Ys=null,Js=0;function $s(){throw Error(o(321))}function Zs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$n(e[n],t[n]))return!1;return!0}function eo(e,t,n,r,i,s){return Us=s,Bs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,P.H=null===e||null===e.memoizedState?ga:ya,Qs=!1,s=n(r,i),Qs=!1,Ks&&(s=no(t,n,r,i)),to(e),s}function to(e){P.H=ma;var t=null!==qs&&null!==qs.next;if(Us=0,Gs=qs=Bs=null,Hs=!1,Xs=0,Ys=null,t)throw Error(o(300));null===e||Oa||null!==(e=e.dependencies)&&Ai(e)&&(Oa=!0)}function no(e,t,n,r){Bs=e;var i=0;do{if(Ks&&(Ys=null),Xs=0,Ks=!1,25<=i)throw Error(o(301));if(i+=1,Gs=qs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}P.H=va,s=t(n,r)}while(Ks);return s}function ro(){var e=P.H,t=e.useState()[0];return t="function"===typeof t.then?co(t):t,e=e.useState()[0],(null!==qs?qs.memoizedState:null)!==e&&(Bs.flags|=1024),t}function io(){var e=0!==Ws;return Ws=0,e}function so(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function oo(e){if(Hs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Hs=!1}Us=0,Gs=qs=Bs=null,Ks=!1,Xs=Ws=0,Ys=null}function ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Gs?Bs.memoizedState=Gs=e:Gs=Gs.next=e,Gs}function lo(){if(null===qs){var e=Bs.alternate;e=null!==e?e.memoizedState:null}else e=qs.next;var t=null===Gs?Bs.memoizedState:Gs.next;if(null!==t)Gs=t,qs=e;else{if(null===e){if(null===Bs.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(qs=e).memoizedState,baseState:qs.baseState,baseQueue:qs.baseQueue,queue:qs.queue,next:null},null===Gs?Bs.memoizedState=Gs=e:Gs=Gs.next=e}return Gs}function co(e){var t=Xs;return Xs+=1,null===Ys&&(Ys=[]),e=ns(Ys,e,t),t=Bs,null===(null===Gs?t.memoizedState:Gs.next)&&(t=t.alternate,P.H=null===t||null===t.memoizedState?ga:ya),e}function uo(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return co(e);if(e.$$typeof===x)return Mi(e)}throw Error(o(438,String(e)))}function ho(e){var t=null,n=Bs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Bs.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Bs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=C;return t.index++,n}function fo(e,t){return"function"===typeof t?t(e):t}function po(e){return mo(lo(),qs,e)}function mo(e,t,n){var r=e.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=n;var i=e.baseQueue,s=r.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}t.baseQueue=i=s,r.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=a=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(gc&d)===d:(Us&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===qi&&(h=!0);else{if((Us&f)===f){u=u.next,f===qi&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,a=s):c=c.next=d,Bs.lanes|=f,Ec|=f}d=u.action,Qs&&n(s,d),s=u.hasEagerState?u.eagerState:n(s,d)}else f={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=s):c=c.next=f,Bs.lanes|=d,Ec|=d;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!$n(s,e.memoizedState)&&(Oa=!0,h&&null!==(n=Gi)))throw n;e.memoizedState=s,e.baseState=a,e.baseQueue=c,r.lastRenderedState=s}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function go(e){var t=lo(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);$n(s,t.memoizedState)||(Oa=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function yo(e,t,n){var r=Bs,i=lo(),s=hi;if(s){if(void 0===n)throw Error(o(407));n=n()}else n=t();var a=!$n((qs||i).memoizedState,n);if(a&&(i.memoizedState=n,Oa=!0),i=i.queue,Bo(wo.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==Gs&&1&Gs.memoizedState.tag){if(r.flags|=2048,jo(9,{destroy:void 0},bo.bind(null,r,i,n,t),null),null===pc)throw Error(o(349));s||0!==(127&Us)||vo(r,t,n)}return n}function vo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Bs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Bs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function bo(e,t,n,r){t.value=n,t.getSnapshot=r,xo(t)&&So(e)}function wo(e,t,n){return n(function(){xo(t)&&So(e)})}function xo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!$n(e,n)}catch(r){return!0}}function So(e){var t=Or(e,2);null!==t&&Wc(t,e,2)}function _o(e){var t=ao();if("function"===typeof e){var n=e;if(e=n(),Qs){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:e},t}function Eo(e,t,n,r){return e.baseState=n,mo(e,qs,"function"===typeof r?r:fo)}function To(e,t,n,r,i){if(da(e))throw Error(o(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==P.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,ko(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ko(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var s=P.T,o={};P.T=o;try{var a=n(i,r),l=P.S;null!==l&&l(o,a),Io(e,t,a)}catch(c){No(e,t,c)}finally{null!==s&&null!==o.types&&(s.types=o.types),P.T=s}}else try{Io(e,t,s=n(i,r))}catch(u){No(e,t,u)}}function Io(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Co(e,t,n)},function(n){return No(e,t,n)}):Co(e,t,n)}function Co(e,t,n){t.status="fulfilled",t.value=n,Ao(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ko(e,n)))}function No(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ao(t),t=t.next}while(t!==r)}e.action=null}function Ao(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Do(e,t){return t}function Mo(e,t){if(hi){var n=pc.formState;if(null!==n){e:{var r=Bs;if(hi){if(ui){t:{for(var i=ui,s=fi;8!==i.nodeType;){if(!s){i=null;break t}if(null===(i=Oh(i.nextSibling))){i=null;break t}}i="F!"===(s=i.data)||"F"===s?i:null}if(i){ui=Oh(i.nextSibling),r="F!"===i.data;break e}}mi(r)}r=!1}r&&(t=n[0])}}return(n=ao()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Do,lastRenderedState:t},n.queue=r,n=ca.bind(null,Bs,r),r.dispatch=n,r=_o(!1),s=ha.bind(null,Bs,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=ao()).queue=i,n=To.bind(null,Bs,i,s,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function Oo(e){return Po(lo(),qs,e)}function Po(e,t,n){if(t=mo(e,t,Do)[0],e=po(fo)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=co(t)}catch(o){if(o===Ji)throw Zi;throw o}else r=t;var i=(t=lo()).queue,s=i.dispatch;return n!==t.memoizedState&&(Bs.flags|=2048,jo(9,{destroy:void 0},Lo.bind(null,i,n),null)),[r,s,e]}function Lo(e,t){e.action=t}function Ro(e){var t=lo(),n=qs;if(null!==n)return Po(t,n,e);lo(),t=t.memoizedState;var r=(n=lo()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function jo(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Bs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Bs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fo(){return lo().memoizedState}function Vo(e,t,n,r){var i=ao();Bs.flags|=e,i.memoizedState=jo(1|t,{destroy:void 0},n,void 0===r?null:r)}function zo(e,t,n,r){var i=lo();r=void 0===r?null:r;var s=i.memoizedState.inst;null!==qs&&null!==r&&Zs(r,qs.memoizedState.deps)?i.memoizedState=jo(t,s,n,r):(Bs.flags|=e,i.memoizedState=jo(1|t,s,n,r))}function Uo(e,t){Vo(8390656,8,e,t)}function Bo(e,t){zo(2048,8,e,t)}function qo(e){var t=lo().memoizedState;return function(e){Bs.flags|=4;var t=Bs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Bs.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fc))throw Error(o(440));return t.impl.apply(void 0,arguments)}}function Go(e,t){return zo(4,2,e,t)}function Ho(e,t){return zo(4,4,e,t)}function Ko(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Qo(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,zo(4,4,Ko.bind(null,t,e),n)}function Wo(){}function Xo(e,t){var n=lo();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Zs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=lo();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Zs(t,r[1]))return r[0];if(r=e(),Qs){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function Jo(e,t,n){return void 0===n||0!==(1073741824&Us)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=n,e=Qc(),Bs.lanes|=e,Ec|=e,n)}function $o(e,t,n,r){return $n(n,t)?n:null!==Is.current?(e=Jo(e,n,r),$n(e,t)||(Oa=!0),e):0===(42&Us)||0!==(1073741824&Us)&&0===(261930&gc)?(Oa=!0,e.memoizedState=n):(e=Qc(),Bs.lanes|=e,Ec|=e,t)}function Zo(e,t,n,r,i){var s=L.p;L.p=0!==s&&8>s?s:8;var o=P.T,a={};P.T=a,ha(e,!1,t,n);try{var l=i(),c=P.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)ua(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Kc());else ua(e,t,r,Kc())}catch(u){ua(e,t,{then:function(){},status:"rejected",reason:u},Kc())}finally{L.p=s,null!==o&&null!==a.types&&(o.types=a.types),P.T=o}}function ea(){}function ta(e,t,n,r){if(5!==e.tag)throw Error(o(476));var i=na(e).queue;Zo(e,i,t,R,null===n?ea:function(){return ra(e),n(r)})}function na(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:R},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ra(e){var t=na(e);null===t.next&&(t=e.alternate.memoizedState),ua(e,t.next.queue,{},Kc())}function ia(){return Mi(ud)}function sa(){return lo().memoizedState}function oa(){return lo().memoizedState}function aa(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Kc(),r=bs(t,e=vs(n),n);return null!==r&&(Wc(r,t,n),ws(r,t,n)),t={cache:Vi()},void(e.payload=t)}t=t.return}}function la(e,t,n){var r=Kc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},da(e)?fa(t,n):null!==(n=Mr(e,t,n,r))&&(Wc(n,e,r),pa(n,t,r))}function ca(e,t,n){ua(e,t,n,Kc())}function ua(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(da(e))fa(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,$n(a,o))return Dr(e,t,i,0),null===pc&&Ar(),!1}catch(l){}if(null!==(n=Mr(e,t,i,r)))return Wc(n,e,r),pa(n,t,r),!0}return!1}function ha(e,t,n,r){if(r={lane:2,revertLane:Bu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},da(e)){if(t)throw Error(o(479))}else null!==(t=Mr(e,n,r,2))&&Wc(t,e,2)}function da(e){var t=e.alternate;return e===Bs||null!==t&&t===Bs}function fa(e,t){Ks=Hs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function pa(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Pe(e,n)}}var ma={readContext:Mi,use:uo,useCallback:$s,useContext:$s,useEffect:$s,useImperativeHandle:$s,useLayoutEffect:$s,useInsertionEffect:$s,useMemo:$s,useReducer:$s,useRef:$s,useState:$s,useDebugValue:$s,useDeferredValue:$s,useTransition:$s,useSyncExternalStore:$s,useId:$s,useHostTransitionStatus:$s,useFormState:$s,useActionState:$s,useOptimistic:$s,useMemoCache:$s,useCacheRefresh:$s};ma.useEffectEvent=$s;var ga={readContext:Mi,use:uo,useCallback:function(e,t){return ao().memoizedState=[e,void 0===t?null:t],e},useContext:Mi,useEffect:Uo,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4194308,4,Ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){Vo(4,2,e,t)},useMemo:function(e,t){var n=ao();t=void 0===t?null:t;var r=e();if(Qs){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=ao();if(void 0!==n){var i=n(t);if(Qs){be(!0);try{n(t)}finally{be(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=la.bind(null,Bs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ao().memoizedState=e},useState:function(e){var t=(e=_o(e)).queue,n=ca.bind(null,Bs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Wo,useDeferredValue:function(e,t){return Jo(ao(),e,t)},useTransition:function(){var e=_o(!1);return e=Zo.bind(null,Bs,e.queue,!0,!1),ao().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Bs,i=ao();if(hi){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===pc)throw Error(o(349));0!==(127&gc)||vo(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Uo(wo.bind(null,r,s,e),[e]),r.flags|=2048,jo(9,{destroy:void 0},bo.bind(null,r,s,n,t),null),n},useId:function(){var e=ao(),t=pc.identifierPrefix;if(hi){var n=ri;t="_"+t+"R_"+(n=(ni&~(1<<32-we(ni)-1)).toString(32)+n),0<(n=Ws++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Js++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ia,useFormState:Mo,useActionState:Mo,useOptimistic:function(e){var t=ao();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ha.bind(null,Bs,!0,n),n.dispatch=t,[e,t]},useMemoCache:ho,useCacheRefresh:function(){return ao().memoizedState=aa.bind(null,Bs)},useEffectEvent:function(e){var t=ao(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&fc))throw Error(o(440));return n.impl.apply(void 0,arguments)}}},ya={readContext:Mi,use:uo,useCallback:Xo,useContext:Mi,useEffect:Bo,useImperativeHandle:Qo,useInsertionEffect:Go,useLayoutEffect:Ho,useMemo:Yo,useReducer:po,useRef:Fo,useState:function(){return po(fo)},useDebugValue:Wo,useDeferredValue:function(e,t){return $o(lo(),qs.memoizedState,e,t)},useTransition:function(){var e=po(fo)[0],t=lo().memoizedState;return["boolean"===typeof e?e:co(e),t]},useSyncExternalStore:yo,useId:sa,useHostTransitionStatus:ia,useFormState:Oo,useActionState:Oo,useOptimistic:function(e,t){return Eo(lo(),0,e,t)},useMemoCache:ho,useCacheRefresh:oa};ya.useEffectEvent=qo;var va={readContext:Mi,use:uo,useCallback:Xo,useContext:Mi,useEffect:Bo,useImperativeHandle:Qo,useInsertionEffect:Go,useLayoutEffect:Ho,useMemo:Yo,useReducer:go,useRef:Fo,useState:function(){return go(fo)},useDebugValue:Wo,useDeferredValue:function(e,t){var n=lo();return null===qs?Jo(n,e,t):$o(n,qs.memoizedState,e,t)},useTransition:function(){var e=go(fo)[0],t=lo().memoizedState;return["boolean"===typeof e?e:co(e),t]},useSyncExternalStore:yo,useId:sa,useHostTransitionStatus:ia,useFormState:Ro,useActionState:Ro,useOptimistic:function(e,t){var n=lo();return null!==qs?Eo(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ho,useCacheRefresh:oa};function ba(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}va.useEffectEvent=qo;var wa={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Kc(),i=vs(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=bs(e,i,r))&&(Wc(t,e,r),ws(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Kc(),i=vs(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=bs(e,i,r))&&(Wc(t,e,r),ws(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kc(),r=vs(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=bs(e,r,n))&&(Wc(t,e,n),ws(t,e,n))}};function xa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,r)||!Zn(i,s))}function Sa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&wa.enqueueReplaceState(t,t.state,null)}function _a(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=f({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function Ea(e){kr(e)}function Ta(e){console.error(e)}function ka(e){kr(e)}function Ia(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ca(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Na(e,t,n){return(n=vs(n)).tag=3,n.payload={element:null},n.callback=function(){Ia(e,t)},n}function Aa(e){return(e=vs(e)).tag=3,e}function Da(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var s=r.value;e.payload=function(){return i(s)},e.callback=function(){Ca(t,n,r)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Ca(t,n,r),"function"!==typeof i&&(null===Rc?Rc=new Set([this]):Rc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ma=Error(o(461)),Oa=!1;function Pa(e,t,n,r){t.child=null===e?ps(t,null,n,r):fs(t,e.child,n,r)}function La(e,t,n,r,i){n=n.render;var s=t.ref;if("ref"in r){var o={};for(var a in r)"ref"!==a&&(o[a]=r[a])}else o=r;return Di(t),r=eo(e,t,n,o,s,i),a=io(),null===e||Oa?(hi&&a&&oi(t),t.flags|=1,Pa(e,t,r,i),t.child):(so(e,t,i),il(e,t,i))}function Ra(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Vr(s)||void 0!==s.defaultProps||null!==n.compare?((e=Br(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,ja(e,t,s,r,i))}if(s=e.child,!sl(e,i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(o,r)&&e.ref===t.ref)return il(e,t,i)}return t.flags|=1,(e=zr(s,r)).ref=t.ref,e.return=t,t.child=e}function ja(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(Zn(s,r)&&e.ref===t.ref){if(Oa=!1,t.pendingProps=r=s,!sl(e,i))return t.lanes=e.lanes,il(e,t,i);0!==(131072&e.flags)&&(Oa=!0)}}return Ga(e,t,n,r,i)}function Fa(e,t,n,r){var i=r.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|n:n,null!==e){for(r=t.child=e.child,i=0;null!==r;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~s}else r=0,t.child=null;return za(e,t,s,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,za(e,t,null!==s?s.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Xi(0,null!==s?s.cachePool:null),null!==s?Ns(t,s):As(),Rs(t)}else null!==s?(Xi(0,s.cachePool),Ns(t,s),js(),t.memoizedState=null):(null!==e&&Xi(0,null),As(),js());return Pa(e,t,i,n),t.child}function Va(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function za(e,t,n,r,i){var s=Wi();return s=null===s?null:{parent:Fi._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},null!==e&&Xi(0,null),As(),Rs(t),null!==e&&Ni(e,t,r,!0),t.childLanes=i,null}function Ua(e,t){return(t=Za({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Ba(e,t,n){return fs(t,e.child,null,n),(e=Ua(t,t.pendingProps)).flags|=2,Fs(t),t.memoizedState=null,e}function qa(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ga(e,t,n,r,i){return Di(t),n=eo(e,t,n,r,void 0,i),r=io(),null===e||Oa?(hi&&r&&oi(t),t.flags|=1,Pa(e,t,n,i),t.child):(so(e,t,i),il(e,t,i))}function Ha(e,t,n,r,i,s){return Di(t),t.updateQueue=null,n=no(t,r,n,i),to(e),r=io(),null===e||Oa?(hi&&r&&oi(t),t.flags|=1,Pa(e,t,n,s),t.child):(so(e,t,s),il(e,t,s))}function Ka(e,t,n,r,i){if(Di(t),null===t.stateNode){var s=Rr,o=n.contextType;"object"===typeof o&&null!==o&&(s=Mi(o)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=wa,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},gs(t),o=n.contextType,s.context="object"===typeof o&&null!==o?Mi(o):Rr,s.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(ba(t,n,o,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(o=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),o!==s.state&&wa.enqueueReplaceState(s,s.state,null),Es(t,r,s,i),_s(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var a=t.memoizedProps,l=_a(n,a);s.props=l;var c=s.context,u=n.contextType;o=Rr,"object"===typeof u&&null!==u&&(o=Mi(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a||c!==o)&&Sa(t,s,r,o),ms=!1;var d=t.memoizedState;s.state=d,Es(t,r,s,i),_s(),c=t.memoizedState,a||d!==c||ms?("function"===typeof h&&(ba(t,n,h,r),c=t.memoizedState),(l=ms||xa(t,n,l,r,d,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=o,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,ys(e,t),u=_a(n,o=t.memoizedProps),s.props=u,h=t.pendingProps,d=s.context,c=n.contextType,l=Rr,"object"===typeof c&&null!==c&&(l=Mi(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&Sa(t,s,r,l),ms=!1,d=t.memoizedState,s.state=d,Es(t,r,s,i),_s();var f=t.memoizedState;o!==h||d!==f||ms||null!==e&&null!==e.dependencies&&Ai(e.dependencies)?("function"===typeof a&&(ba(t,n,a,r),f=t.memoizedState),(u=ms||xa(t,n,u,r,d,f,l)||null!==e&&null!==e.dependencies&&Ai(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,qa(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=fs(t,e.child,null,i),t.child=fs(t,null,n,i)):Pa(e,t,n,i),t.memoizedState=s.state,e=t.child):e=il(e,t,i),e}function Qa(e,t,n,r){return bi(),t.flags|=256,Pa(e,t,n,r),t.child}var Wa={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xa(e){return{baseLanes:e,cachePool:Yi()}}function Ya(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ic),e}function Ja(e,t,n){var r,i=t.pendingProps,s=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Vs.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(hi){if(s?Ps(t):js(),(e=ui)?null!==(e=null!==(e=Ah(e,fi))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},(n=Hr(e)).return=t,t.child=n,ci=t,ui=null):e=null,null===e)throw mi(t);return Mh(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,s?(js(),l=Za({mode:"hidden",children:l},s=t.mode),i=qr(i,s,n,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Xa(n),i.childLanes=Ya(e,r,n),t.memoizedState=Wa,Va(null,i)):(Ps(t),$a(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(a)256&t.flags?(Ps(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(js(),t.child=e.child,t.flags|=128,t=null):(js(),l=i.fallback,s=t.mode,i=Za({mode:"visible",children:i.children},s),(l=qr(l,s,n,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,fs(t,e.child,null,n),(i=t.child).memoizedState=Xa(n),i.childLanes=Ya(e,r,n),t.memoizedState=Wa,t=Va(null,i));else if(Ps(t),Mh(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(o(419))).stack="",i.digest=r,xi({value:i,source:null,stack:null}),t=el(e,t,n)}else if(Oa||Ni(e,t,n,!1),r=0!==(n&e.childLanes),Oa||r){if(null!==(r=pc)&&(0!==(i=Le(r,n))&&i!==c.retryLane))throw c.retryLane=i,Or(e,i),Wc(r,e,i),Ma;Dh(l)||ou(),t=el(e,t,n)}else Dh(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ui=Oh(l.nextSibling),ci=t,hi=!0,di=null,fi=!1,null!==e&&li(t,e),(t=$a(t,i.children)).flags|=4096);return t}return s?(js(),l=i.fallback,s=t.mode,u=(c=e.child).sibling,(i=zr(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=zr(u,l):(l=qr(l,s,n,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Va(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Xa(n):(null!==(s=l.cachePool)?(c=Fi._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=Yi(),l={baseLanes:l.baseLanes|n,cachePool:s}),i.memoizedState=l,i.childLanes=Ya(e,r,n),t.memoizedState=Wa,Va(e.child,i)):(Ps(t),e=(n=e.child).sibling,(n=zr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function $a(e,t){return(t=Za({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Za(e,t){return(e=Fr(22,e,null,t)).lanes=0,e}function el(e,t,n){return fs(t,e.child,null,n),(e=$a(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ii(e.return,t,n)}function nl(e,t,n,r,i,s){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.treeForkCount=s)}function rl(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;r=r.children;var o=Vs.current,a=0!==(2&o);if(a?(o=1&o|2,t.flags|=128):o&=1,U(Vs,o),Pa(e,t,r,n),r=hi?$r:0,!a&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===zs(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),nl(t,!1,i,n,s,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===zs(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}nl(t,!0,n,null,s,r);break;case"together":nl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function il(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ec|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ni(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=zr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ai(e))}function ol(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Oa=!0;else{if(!sl(e,n)&&0===(128&t.flags))return Oa=!1,function(e,t,n){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),Ti(0,Fi,e.memoizedState.cache),bi();break;case 27:case 5:Y(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:Ti(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Ls(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Ps(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ja(e,t,n):(Ps(t),null!==(e=il(e,t,n))?e.sibling:null);Ps(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ni(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return rl(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),U(Vs,Vs.current),r)break;return null;case 22:return t.lanes=0,Fa(e,t,n,t.pendingProps);case 24:Ti(0,Fi,e.memoizedState.cache)}return il(e,t,n)}(e,t,n);Oa=0!==(131072&e.flags)}else Oa=!1,hi&&0!==(1048576&t.flags)&&si(t,$r,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=rs(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var i=e.$$typeof;if(i===S){t.tag=11,t=La(null,t,e,r,n);break e}if(i===T){t.tag=14,t=Ra(null,t,e,r,n);break e}}throw t=M(e)||e,Error(o(306,t,""))}Vr(e)?(r=_a(e,r),t.tag=1,t=Ka(null,t,e,r,n)):(t.tag=0,t=Ga(null,t,e,r,n))}return t;case 0:return Ga(e,t,t.type,t.pendingProps,n);case 1:return Ka(e,t,r=t.type,i=_a(r,t.pendingProps),n);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(o(387));r=t.pendingProps;var s=t.memoizedState;i=s.element,ys(e,t),Es(t,r,null,n);var a=t.memoizedState;if(r=a.cache,Ti(0,Fi,r),r!==s.cache&&Ci(t,[Fi],n,!0),_s(),r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Qa(e,t,r,n);break e}if(r!==i){xi(i=Wr(Error(o(424)),t)),t=Qa(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ui=Oh(e.firstChild),ci=t,hi=!0,di=null,fi=!0,n=ps(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(bi(),r===i){t=il(e,t,n);break e}Pa(e,t,r,n)}t=t.child}return t;case 26:return qa(e,t),null===e?(n=Hh(t.type,null,t.pendingProps,null))?t.memoizedState=n:hi||(n=t.type,e=t.pendingProps,(r=gh(K.current).createElement(n))[Ue]=t,r[Be]=e,dh(r,n,e),et(r),t.stateNode=r):t.memoizedState=Hh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&hi&&(r=t.stateNode=jh(t.type,t.pendingProps,K.current),ci=t,fi=!0,i=ui,kh(t.type)?(Ph=i,ui=Oh(r.firstChild)):ui=i),Pa(e,t,t.pendingProps.children,n),qa(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&hi&&((i=r=ui)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[We])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===s)return e}if(null===(e=Oh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fi))?(t.stateNode=r,ci=t,ui=Oh(r.firstChild),fi=!1,i=!0):i=!1),i||mi(t)),Y(t),i=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,r=s.children,bh(i,s)?r=null:null!==a&&bh(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=eo(e,t,ro,null,null,n),ud._currentValue=i),qa(e,t),Pa(e,t,r,n),t.child;case 6:return null===e&&hi&&((e=n=ui)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Oh(e.nextSibling)))return null}return e}(n,t.pendingProps,fi))?(t.stateNode=n,ci=t,ui=null,e=!0):e=!1),e||mi(t)),null;case 13:return Ja(e,t,n);case 4:return W(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=fs(t,null,r,n):Pa(e,t,r,n),t.child;case 11:return La(e,t,t.type,t.pendingProps,n);case 7:return Pa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Pa(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Ti(0,t.type,r.value),Pa(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Di(t),r=r(i=Mi(i)),t.flags|=1,Pa(e,t,r,n),t.child;case 14:return Ra(e,t,t.type,t.pendingProps,n);case 15:return ja(e,t,t.type,t.pendingProps,n);case 19:return rl(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,i=0!==(128&t.flags);if(t.flags&=-129,null===e){if(hi){if("hidden"===r.mode)return e=Ua(t,r),t.lanes=536870912,Va(null,e);if(Ls(t),(e=ui)?null!==(e=null!==(e=Ah(e,fi))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},(n=Hr(e)).return=t,t.child=n,ci=t,ui=null):e=null,null===e)throw mi(t);return t.lanes=536870912,null}return Ua(t,r)}var s=e.memoizedState;if(null!==s){var a=s.dehydrated;if(Ls(t),i)if(256&t.flags)t.flags&=-257,t=Ba(e,t,n);else{if(null===t.memoizedState)throw Error(o(558));t.child=e.child,t.flags|=128,t=null}else if(Oa||Ni(e,t,n,!1),i=0!==(n&e.childLanes),Oa||i){if(null!==(r=pc)&&0!==(a=Le(r,n))&&a!==s.retryLane)throw s.retryLane=a,Or(e,a),Wc(r,e,a),Ma;ou(),t=Ba(e,t,n)}else e=s.treeContext,ui=Oh(a.nextSibling),ci=t,hi=!0,di=null,fi=!1,null!==e&&li(t,e),(t=Ua(t,r)).flags|=4096;return t}return(e=zr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fa(e,t,n,t.pendingProps);case 24:return Di(t),r=Mi(Fi),null===e?(null===(i=Wi())&&(i=pc,s=Vi(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:r,cache:i},gs(t),Ti(0,Fi,i)):(0!==(e.lanes&n)&&(ys(e,t),Es(t,null,null,n),_s()),i=e.memoizedState,s=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Ti(0,Fi,r)):(r=s.cache,Ti(0,Fi,r),r!==i.cache&&Ci(t,[Fi],n,!0))),Pa(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function al(e){e.flags|=4}function ll(e,t,n,r,i){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&i)===i)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw is=es,$i;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!id(t)){if(!ru())throw is=es,$i;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ae():536870912,e.lanes|=t,Cc|=t)}function hl(e,t){if(!hi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function dl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fl(e,t,n){var r=t.pendingProps;switch(ai(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return dl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),ki(Fi),X(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(vi(t)?al(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,wi())),dl(t),null;case 26:var i=t.type,s=t.memoizedState;return null===e?(al(t),null!==s?(dl(t),cl(t,s)):(dl(t),ll(t,i,0,0,n))):s?s!==e.memoizedState?(al(t),dl(t),cl(t,s)):(dl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&al(t),dl(t),ll(t,i,0,0,n)),null;case 27:if(J(t),n=K.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&al(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return dl(t),null}e=G.current,vi(t)?gi(t):(e=jh(i,r,n),t.stateNode=e,al(t))}return dl(t),null;case 5:if(J(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&al(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return dl(t),null}if(s=G.current,vi(t))gi(t);else{var a=gh(K.current);switch(s){case 1:s=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:s=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":s=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":s=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(s=a.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?s.multiple=!0:r.size&&(s.size=r.size);break;default:s="string"===typeof r.is?a.createElement(i,{is:r.is}):a.createElement(i)}}s[Ue]=t,s[Be]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)s.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=s;e:switch(dh(s,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&al(t)}}return dl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&al(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(e=K.current,vi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ci))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Ue]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||ch(e.nodeValue,n)))||mi(t,!0)}else(e=gh(e).createTextNode(r))[Ue]=t,t.stateNode=e}return dl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=vi(t),null!==n){if(null===e){if(!r)throw Error(o(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(o(557));e[Ue]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dl(t),e=!1}else n=wi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Fs(t),t):(Fs(t),null);if(0!==(128&t.flags))throw Error(o(558))}return dl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=vi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[Ue]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dl(t),i=!1}else i=wi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(Fs(t),t):(Fs(t),null)}return Fs(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),s=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),dl(t),null);case 4:return X(),null===e&&Zu(t.stateNode.containerInfo),dl(t),null;case 10:return ki(t.type),dl(t),null;case 19:if(z(Vs),null===(r=t.memoizedState))return dl(t),null;if(i=0!==(128&t.flags),null===(s=r.rendering))if(i)hl(r,!1);else{if(0!==_c||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=zs(e))){for(t.flags|=128,hl(r,!1),e=s.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Ur(n,e),n=n.sibling;return U(Vs,1&Vs.current|2),hi&&ii(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Pc&&(t.flags|=128,i=!0,hl(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=zs(s))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),hl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!hi)return dl(t),null}else 2*le()-r.renderingStartTime>Pc&&536870912!==n&&(t.flags|=128,i=!0,hl(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=Vs.current,U(Vs,i?1&n|2:1&n),hi&&ii(t,r.treeForkCount),e):(dl(t),null);case 22:case 23:return Fs(t),Ds(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(dl(t),6&t.subtreeFlags&&(t.flags|=8192)):dl(t),null!==(n=t.updateQueue)&&ul(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&z(Qi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ki(Fi),dl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function pl(e,t){switch(ai(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ki(Fi),X(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(Fs(t),null===t.alternate)throw Error(o(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fs(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return z(Vs),null;case 4:return X(),null;case 10:return ki(t.type),null;case 22:case 23:return Fs(t),Ds(),null!==e&&z(Qi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return ki(Fi),null;default:return null}}function ml(e,t){switch(ai(t),t.tag){case 3:ki(Fi),X();break;case 26:case 27:case 5:J(t);break;case 4:X();break;case 31:null!==t.memoizedState&&Fs(t);break;case 13:Fs(t);break;case 19:z(Vs);break;case 10:ki(t.type);break;case 22:case 23:Fs(t),Ds(),null!==e&&z(Qi);break;case 24:ki(Fi)}}function gl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var s=n.create,o=n.inst;r=s(),o.destroy=r}n=n.next}while(n!==i)}}catch(a){_u(t,t.return,a)}}function yl(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var s=i.next;r=s;do{if((r.tag&e)===e){var o=r.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,i=t;var l=n,c=a;try{c()}catch(u){_u(i,l,u)}}}r=r.next}while(r!==s)}}catch(u){_u(t,t.return,u)}}function vl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ks(t,n)}catch(r){_u(e,e.return,r)}}}function bl(e,t,n){n.props=_a(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){_u(e,t,r)}}function wl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){_u(e,t,i)}}function xl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){_u(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){_u(e,t,s)}else n.current=null}function Sl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){_u(e,e.return,i)}}function _l(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,a=null,l=null,c=null,u=null,h=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:r.hasOwnProperty(p)||uh(e,t,p,null,r,d)}}for(var f in r){var p=r[f];if(d=n[f],r.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":s=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:p!==d&&uh(e,t,f,p,r,d)}}return void vt(e,a,l,c,u,h,s,i);case"select":for(s in p=a=l=f=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||uh(e,t,s,null,r,c)}for(i in r)if(s=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&uh(e,t,i,s,r,c)}return t=l,n=a,r=p,void(null!=f?xt(e,!!n,f,!1):!!r!==!!n&&(null!=t?xt(e,!!n,t,!0):xt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:uh(e,t,l,null,r,i)}for(a in r)if(i=r[a],s=n[a],r.hasOwnProperty(a)&&(null!=i||null!=s))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(o(91));break;default:i!==s&&uh(e,t,a,i,r,s)}return void St(e,f,p);case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else uh(e,t,m,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else uh(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g)&&uh(e,t,g,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:uh(e,t,u,f,r,p)}return;default:if(Ct(t)){for(var y in n)f=n[y],n.hasOwnProperty(y)&&void 0!==f&&!r.hasOwnProperty(y)&&hh(e,t,y,void 0,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||hh(e,t,h,f,r,p);return}}for(var v in n)f=n[v],n.hasOwnProperty(v)&&null!=f&&!r.hasOwnProperty(v)&&uh(e,t,v,null,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||null==f&&null==p||uh(e,t,d,f,r,p)}(r,e.type,n,t),r[Be]=t}catch(i){_u(e,e.return,i)}}function El(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&kh(e.type)||4===e.tag}function Tl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||El(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&kh(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function kl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Mt));else if(4!==r&&(27===r&&kh(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(kl(e,t,n),e=e.sibling;null!==e;)kl(e,t,n),e=e.sibling}function Il(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&kh(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Il(e,t,n),e=e.sibling;null!==e;)Il(e,t,n),e=e.sibling}function Cl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);dh(t,r,n),t[Ue]=e,t[Be]=n}catch(s){_u(e,e.return,s)}}var Nl=!1,Al=!1,Dl=!1,Ml="function"===typeof WeakSet?WeakSet:Set,Ol=null;function Pl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Wl(e,n),4&r&&gl(5,n);break;case 1:if(Wl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){_u(n,n.return,o)}else{var i=_a(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){_u(n,n.return,a)}}64&r&&vl(n),512&r&&wl(n,n.return);break;case 3:if(Wl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ks(e,t)}catch(o){_u(n,n.return,o)}}break;case 27:null===t&&4&r&&Cl(n);case 26:case 5:Wl(e,n),null===t&&4&r&&Sl(n),512&r&&wl(n,n.return);break;case 12:Wl(e,n);break;case 31:Wl(e,n),4&r&&zl(e,n);break;case 13:Wl(e,n),4&r&&Ul(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Iu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Nl)){t=null!==t&&null!==t.memoizedState||Al,i=Nl;var s=Al;Nl=r,(Al=t)&&!s?Yl(e,n,0!==(8772&n.subtreeFlags)):Wl(e,n),Nl=i,Al=s}break;case 30:break;default:Wl(e,n)}}function Ll(e){var t=e.alternate;null!==t&&(e.alternate=null,Ll(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Rl=null,jl=!1;function Fl(e,t,n){for(n=n.child;null!==n;)Vl(e,t,n),n=n.sibling}function Vl(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ye,n)}catch(s){}switch(n.tag){case 26:Al||xl(n,t),Fl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Al||xl(n,t);var r=Rl,i=jl;kh(n.type)&&(Rl=n.stateNode,jl=!1),Fl(e,t,n),Fh(n.stateNode),Rl=r,jl=i;break;case 5:Al||xl(n,t);case 6:if(r=Rl,i=jl,Rl=null,Fl(e,t,n),jl=i,null!==(Rl=r))if(jl)try{(9===Rl.nodeType?Rl.body:"HTML"===Rl.nodeName?Rl.ownerDocument.body:Rl).removeChild(n.stateNode)}catch(o){_u(n,t,o)}else try{Rl.removeChild(n.stateNode)}catch(o){_u(n,t,o)}break;case 18:null!==Rl&&(jl?(Ih(9===(e=Rl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Gd(e)):Ih(Rl,n.stateNode));break;case 4:r=Rl,i=jl,Rl=n.stateNode.containerInfo,jl=!0,Fl(e,t,n),Rl=r,jl=i;break;case 0:case 11:case 14:case 15:yl(2,n,t),Al||yl(4,n,t),Fl(e,t,n);break;case 1:Al||(xl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bl(n,t,r)),Fl(e,t,n);break;case 21:Fl(e,t,n);break;case 22:Al=(r=Al)||null!==n.memoizedState,Fl(e,t,n),Al=r;break;default:Fl(e,t,n)}}function zl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Gd(e)}catch(n){_u(t,t.return,n)}}}function Ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Gd(e)}catch(n){_u(t,t.return,n)}}function Bl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ml),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ml),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Cu.bind(null,e,t);t.then(r,r)}})}function ql(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(kh(l.type)){Rl=l.stateNode,jl=!1;break e}break;case 5:Rl=l.stateNode,jl=!1;break e;case 3:case 4:Rl=l.stateNode.containerInfo,jl=!0;break e}l=l.return}if(null===Rl)throw Error(o(160));Vl(s,a,i),Rl=null,jl=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Hl(t,e),t=t.sibling}var Gl=null;function Hl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ql(t,e),Kl(e),4&r&&(yl(3,e,e.return),gl(3,e),yl(5,e,e.return));break;case 1:ql(t,e),Kl(e),512&r&&(Al||null===n||xl(n,n.return)),64&r&&Nl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Gl;if(ql(t,e),Kl(e),512&r&&(Al||null===n||xl(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(s=i.getElementsByTagName("title")[0])||s[We]||s[Ue]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(r),i.head.insertBefore(s,i.querySelector("head > title"))),dh(s,r,n),s[Ue]=e,et(s),r=s;break e;case"link":var a=nd("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}dh(s=i.createElement(r),r,n),i.head.appendChild(s);break;case"meta":if(a=nd("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}dh(s=i.createElement(r),r,n),i.head.appendChild(s);break;default:throw Error(o(468,r))}s[Ue]=e,et(s),r=s}e.stateNode=r}else rd(i,e.type,e.stateNode);else e.stateNode=Jh(i,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?rd(i,e.type,e.stateNode):Jh(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&_l(e,e.memoizedProps,n.memoizedProps)}break;case 27:ql(t,e),Kl(e),512&r&&(Al||null===n||xl(n,n.return)),null!==n&&4&r&&_l(e,e.memoizedProps,n.memoizedProps);break;case 5:if(ql(t,e),Kl(e),512&r&&(Al||null===n||xl(n,n.return)),32&e.flags){i=e.stateNode;try{Et(i,"")}catch(m){_u(e,e.return,m)}}4&r&&null!=e.stateNode&&_l(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(Dl=!0);break;case 6:if(ql(t,e),Kl(e),4&r){if(null===e.stateNode)throw Error(o(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(m){_u(e,e.return,m)}}break;case 3:if(td=null,i=Gl,Gl=Uh(t.containerInfo),ql(t,e),Gl=i,Kl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Gd(t.containerInfo)}catch(m){_u(e,e.return,m)}Dl&&(Dl=!1,Ql(e));break;case 4:r=Gl,Gl=Uh(e.stateNode.containerInfo),ql(t,e),Kl(e),Gl=r;break;case 12:default:ql(t,e),Kl(e);break;case 31:case 19:ql(t,e),Kl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Bl(e,r)));break;case 13:ql(t,e),Kl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Mc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Bl(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=Nl,h=Al;if(Nl=u||i,Al=h||c,ql(t,e),Al=h,Nl=u,Kl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||Nl||Al||Xl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,i)"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,f=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(m){_u(c,c.return,m)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(m){_u(c,c.return,m)}}}else if(18===t.tag){if(null===n){c=t;try{var p=c.stateNode;i?Ch(p,!0):Ch(c.stateNode,!1)}catch(m){_u(c,c.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Bl(e,n))));case 30:case 21:}}function Kl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(El(r)){n=r;break}r=r.return}if(null==n)throw Error(o(160));switch(n.tag){case 27:var i=n.stateNode;Il(e,Tl(e),i);break;case 5:var s=n.stateNode;32&n.flags&&(Et(s,""),n.flags&=-33),Il(e,Tl(e),s);break;case 3:case 4:var a=n.stateNode.containerInfo;kl(e,Tl(e),a);break;default:throw Error(o(161))}}catch(l){_u(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ql(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ql(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Wl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Pl(e,t.alternate,t),t=t.sibling}function Xl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yl(4,t,t.return),Xl(t);break;case 1:xl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bl(t,t.return,n),Xl(t);break;case 27:Fh(t.stateNode);case 26:case 5:xl(t,t.return),Xl(t);break;case 22:null===t.memoizedState&&Xl(t);break;default:Xl(t)}e=e.sibling}}function Yl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:Yl(i,s,n),gl(4,s);break;case 1:if(Yl(i,s,n),"function"===typeof(i=(r=s).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){_u(r,r.return,c)}if(null!==(i=(r=s).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)Ts(l[i],a)}catch(c){_u(r,r.return,c)}}n&&64&o&&vl(s),wl(s,s.return);break;case 27:Cl(s);case 26:case 5:Yl(i,s,n),n&&null===r&&4&o&&Sl(s),wl(s,s.return);break;case 12:Yl(i,s,n);break;case 31:Yl(i,s,n),n&&4&o&&zl(i,s);break;case 13:Yl(i,s,n),n&&4&o&&Ul(i,s);break;case 22:null===s.memoizedState&&Yl(i,s,n),wl(s,s.return);break;case 30:break;default:Yl(i,s,n)}t=t.sibling}}function Jl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&zi(n))}function $l(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&zi(e))}function Zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,r),t=t.sibling}function ec(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,n,r),2048&i&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,n,r);break;case 3:Zl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&zi(e)));break;case 12:if(2048&i){Zl(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;"function"===typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){_u(t,t.return,l)}}else Zl(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,o=t.alternate,null!==t.memoizedState?2&s._visibility?Zl(e,t,n,r):nc(e,t):2&s._visibility?Zl(e,t,n,r):(s._visibility|=2,tc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&i&&Jl(o,t);break;case 24:Zl(e,t,n,r),2048&i&&$l(t.alternate,t)}}function tc(e,t,n,r,i){for(i=i&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,o=t,a=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:tc(s,o,a,l,i),gl(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?tc(s,o,a,l,i):nc(s,o):(u._visibility|=2,tc(s,o,a,l,i)),i&&2048&c&&Jl(o.alternate,o);break;case 24:tc(s,o,a,l,i),i&&2048&c&&$l(o.alternate,o);break;default:tc(s,o,a,l,i)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:nc(n,r),2048&i&&Jl(r.alternate,r);break;case 24:nc(n,r),2048&i&&$l(r.alternate,r);break;default:nc(n,r)}t=t.sibling}}var rc=8192;function ic(e,t,n){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:ic(e,t,n),e.flags&rc&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var i=Kh(r.href),s=t.querySelector(Qh(i));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=od.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=s,void et(s);s=t.ownerDocument||t,r=Wh(r),(i=Vh.get(i))&&Zh(r,i),et(s=s.createElement("link"));var o=s;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),dh(s,"link",r),n.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=od.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Gl,e.memoizedState,e.memoizedProps);break;case 5:default:ic(e,t,n);break;case 3:case 4:var r=Gl;Gl=Uh(e.stateNode.containerInfo),ic(e,t,n),Gl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,ic(e,t,n),rc=r):ic(e,t,n))}}function oc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function ac(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ol=r,uc(r,e)}oc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:ac(e),2048&e.flags&&yl(9,e,e.return);break;case 3:case 12:default:ac(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):ac(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ol=r,uc(r,e)}oc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Ol;){var n=Ol;switch(n.tag){case 0:case 11:case 15:yl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:zi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ol=r;else e:for(n=e;null!==Ol;){var i=(r=Ol).sibling,s=r.return;if(Ll(r),r===n){Ol=null;break e}if(null!==i){i.return=s,Ol=i;break e}Ol=s}}}var hc={getCacheForType:function(e){var t=Mi(Fi),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Mi(Fi).controller.signal}},dc="function"===typeof WeakMap?WeakMap:Map,fc=0,pc=null,mc=null,gc=0,yc=0,vc=null,bc=!1,wc=!1,xc=!1,Sc=0,_c=0,Ec=0,Tc=0,kc=0,Ic=0,Cc=0,Nc=null,Ac=null,Dc=!1,Mc=0,Oc=0,Pc=1/0,Lc=null,Rc=null,jc=0,Fc=null,Vc=null,zc=0,Uc=0,Bc=null,qc=null,Gc=0,Hc=null;function Kc(){return 0!==(2&fc)&&0!==gc?gc&-gc:null!==P.T?Bu():Fe()}function Qc(){if(0===Ic)if(0===(536870912&gc)||hi){var e=Ee;0===(3932160&(Ee<<=1))&&(Ee=262144),Ic=e}else Ic=536870912;return null!==(e=Ms.current)&&(e.flags|=32),Ic}function Wc(e,t,n){(e!==pc||2!==yc&&9!==yc)&&null===e.cancelPendingCommit||(tu(e,0),$c(e,gc,Ic,!1)),Me(e,n),0!==(2&fc)&&e===pc||(e===pc&&(0===(2&fc)&&(Tc|=n),4===_c&&$c(e,gc,Ic,!1)),Lu(e))}function Xc(e,t,n){if(0!==(6&fc))throw Error(o(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ce(e,t),i=r?function(e,t){var n=fc;fc|=2;var r=iu(),i=su();pc!==e||gc!==t?(Lc=null,Pc=le()+500,tu(e,t)):wc=Ce(e,t);e:for(;;)try{if(0!==yc&&null!==mc){t=mc;var s=vc;t:switch(yc){case 1:yc=0,vc=null,du(e,t,s,1);break;case 2:case 9:if(ts(s)){yc=0,vc=null,hu(t);break}t=function(){2!==yc&&9!==yc||pc!==e||(yc=7),Lu(e)},s.then(t,t);break e;case 3:yc=7;break e;case 4:yc=5;break e;case 7:ts(s)?(yc=0,vc=null,hu(t)):(yc=0,vc=null,du(e,t,s,7));break;case 5:var a=null;switch(mc.tag){case 26:a=mc.memoizedState;case 5:case 27:var l=mc;if(a?id(a):l.stateNode.complete){yc=0,vc=null;var c=l.sibling;if(null!==c)mc=c;else{var u=l.return;null!==u?(mc=u,fu(u)):mc=null}break t}}yc=0,vc=null,du(e,t,s,5);break;case 6:yc=0,vc=null,du(e,t,s,6);break;case 8:eu(),_c=6;break e;default:throw Error(o(462))}}cu();break}catch(h){nu(e,h)}return Ei=_i=null,P.H=r,P.A=i,fc=n,null!==mc?0:(pc=null,gc=0,Ar(),_c)}(e,t):au(e,t,!0),s=r;;){if(0===i){wc&&!r&&$c(e,t,0,!1);break}if(n=e.current.alternate,!s||Jc(n)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=Nc;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,a).flags|=256),2!==(a=au(l,a,!1))){if(xc&&!c){l.errorRecoveryDisabledLanes|=s,Tc|=s,i=4;break e}s=Ac,Ac=i,null!==s&&(null===Ac?Ac=s:Ac.push.apply(Ac,s))}i=a}if(s=!1,2!==i)continue}}if(1===i){tu(e,0),$c(e,t,0,!0);break}e:{switch(r=e,s=i){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:$c(r,t,Ic,!bc);break e;case 2:Ac=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(i=Mc+300-le())){if($c(r,t,Ic,!bc),0!==Ie(r,0,!0))break e;zc=t,r.timeoutHandle=xh(Yc.bind(null,r,n,Ac,Lc,Dc,t,Ic,Tc,Cc,bc,s,"Throttled",-0,0),i)}else Yc(r,n,Ac,Lc,Dc,t,Ic,Tc,Cc,bc,s,null,-0,0)}break}i=au(e,t,!1),s=!1}Lu(e)}function Yc(e,t,n,r,i,s,o,a,l,c,u,h,d,f){if(e.timeoutHandle=-1,8192&(h=t.subtreeFlags)||16785408===(16785408&h)){sc(t,s,h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mt});var p=(62914560&s)===s?Mc-le():(4194048&s)===s?Oc-le():0;if(null!==(p=function(e,t){return e.stylesheets&&0===e.count&&ld(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sd&&(sd=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var i=n[r],s=i.transferSize,o=i.initiatorType,a=i.duration;if(s&&a&&fh(o)){for(o=0,a=i.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>a)break;var u=l.transferSize,h=l.initiatorType;u&&fh(h)&&(o+=u*((l=l.responseEnd)<a?1:(a-c)/(l-c)))}if(--r,t+=8*(s+o)/(i.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var i=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sd?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}(h,p)))return zc=s,e.cancelPendingCommit=p(mu.bind(null,e,t,s,n,r,i,o,a,l,u,h,null,d,f)),void $c(e,s,o,!c)}mu(e,t,s,n,r,i,o,a,l)}function Jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!$n(s(),i))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $c(e,t,n,r){t&=~kc,t&=~Tc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var s=31-we(i),o=1<<s;r[s]=-1,i&=~o}0!==n&&Oe(e,n,t)}function Zc(){return 0!==(6&fc)||(Ru(0,!1),!1)}function eu(){if(null!==mc){if(0===yc)var e=mc.return;else Ei=_i=null,oo(e=mc),as=null,ls=0,e=mc;for(;null!==e;)ml(e.alternate,e),e=e.return;mc=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Sh(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),zc=0,eu(),pc=e,mc=n=zr(e.current,null),gc=t,yc=0,vc=null,bc=!1,wc=Ce(e,t),xc=!1,Cc=Ic=kc=Tc=Ec=_c=0,Ac=Nc=null,Dc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-we(r),s=1<<i;t|=e[i],r&=~s}return Sc=t,Ar(),n}function nu(e,t){Bs=null,P.H=ma,t===Ji||t===Zi?(t=ss(),yc=3):t===$i?(t=ss(),yc=4):yc=t===Ma?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,vc=t,null===mc&&(_c=1,Ia(e,Wr(t,e.current)))}function ru(){var e=Ms.current;return null===e||((4194048&gc)===gc?null===Os:((62914560&gc)===gc||0!==(536870912&gc))&&e===Os)}function iu(){var e=P.H;return P.H=ma,null===e?ma:e}function su(){var e=P.A;return P.A=hc,e}function ou(){_c=4,bc||(4194048&gc)!==gc&&null!==Ms.current||(wc=!0),0===(134217727&Ec)&&0===(134217727&Tc)||null===pc||$c(pc,gc,Ic,!1)}function au(e,t,n){var r=fc;fc|=2;var i=iu(),s=su();pc===e&&gc===t||(Lc=null,tu(e,t)),t=!1;var o=_c;e:for(;;)try{if(0!==yc&&null!==mc){var a=mc,l=vc;switch(yc){case 8:eu(),o=6;break e;case 3:case 2:case 9:case 6:null===Ms.current&&(t=!0);var c=yc;if(yc=0,vc=null,du(e,a,l,c),n&&wc){o=0;break e}break;default:c=yc,yc=0,vc=null,du(e,a,l,c)}}lu(),o=_c;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,Ei=_i=null,fc=r,P.H=i,P.A=s,null===mc&&(pc=null,gc=0,Ar()),o}function lu(){for(;null!==mc;)uu(mc)}function cu(){for(;null!==mc&&!oe();)uu(mc)}function uu(e){var t=ol(e.alternate,e,Sc);e.memoizedProps=e.pendingProps,null===t?fu(e):mc=t}function hu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ha(n,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Ha(n,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:oo(t);default:ml(n,t),t=ol(n,t=mc=Ur(t,Sc),Sc)}e.memoizedProps=e.pendingProps,null===t?fu(e):mc=t}function du(e,t,n,r){Ei=_i=null,oo(t),as=null,ls=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ni(t,n,i,!0),null!==(n=Ms.current)){switch(n.tag){case 31:case 13:return null===Os?ou():null===n.alternate&&0===_c&&(_c=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===es?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Eu(e,r,i)),!1;case 22:return n.flags|=65536,r===es?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Eu(e,r,i)),!1}throw Error(o(435,n.tag))}return Eu(e,r,i),ou(),!1}if(hi)return null!==(t=Ms.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==pi&&xi(Wr(e=Error(o(422),{cause:r}),n))):(r!==pi&&xi(Wr(t=Error(o(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Wr(r,n),xs(e,i=Na(e.stateNode,r,i)),4!==_c&&(_c=2)),!1;var s=Error(o(520),{cause:r});if(s=Wr(s,n),null===Nc?Nc=[s]:Nc.push(s),4!==_c&&(_c=2),null===t)return!0;r=Wr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,xs(n,e=Na(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Rc||!Rc.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,Da(i=Aa(i),e,n,r),xs(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,gc))return _c=1,Ia(e,Wr(n,e.current)),void(mc=null)}catch(s){if(null!==i)throw mc=i,s;return _c=1,Ia(e,Wr(n,e.current)),void(mc=null)}32768&t.flags?(hi||1===r?e=!0:wc||0!==(536870912&gc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Ms.current)&&13===r.tag&&(r.flags|=16384))),pu(t,e)):fu(t)}function fu(e){var t=e;do{if(0!==(32768&t.flags))return void pu(t,bc);e=t.return;var n=fl(t.alternate,t,Sc);if(null!==n)return void(mc=n);if(null!==(t=t.sibling))return void(mc=t);mc=t=e}while(null!==t);0===_c&&(_c=5)}function pu(e,t){do{var n=pl(e.alternate,e);if(null!==n)return n.flags&=32767,void(mc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(mc=e);mc=e=n}while(null!==e);_c=6,mc=null}function mu(e,t,n,r,i,s,a,l,c){e.cancelPendingCommit=null;do{wu()}while(0!==jc);if(0!==(6&fc))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,i,s){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-we(n),h=1<<u;a[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&Oe(e,r,0),0!==s&&0===i&&0!==e.tag&&(e.suspendedLanes|=s&~(o&~t))}(e,n,s|=Nr,a,l,c),e===pc&&(mc=pc=null,gc=0),Vc=t,Fc=e,zc=n,Uc=s,Bc=i,qc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ie(de,function(){return xu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=P.T,P.T=null,i=L.p,L.p=2,a=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,ph=bd,ir(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==s||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===s&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(mh={focusedElem:e,selectionRange:n},bd=!1,Ol=t;null!==Ol;)if(e=(t=Ol).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ol=e;else for(;null!==Ol;){switch(s=(t=Ol).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var m=_a(n.type,i);e=r.getSnapshotBeforeUpdate(m,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){_u(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Nh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Nh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,Ol=e;break}Ol=t.return}}(e,t)}finally{fc=a,L.p=i,P.T=r}}jc=1,gu(),yu(),vu()}}function gu(){if(1===jc){jc=0;var e=Fc,t=Vc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=P.T,P.T=null;var r=L.p;L.p=2;var i=fc;fc|=4;try{Hl(t,e);var s=mh,o=rr(e.containerInfo),a=s.focusedElem,l=s.selectionRange;if(o!==a&&a&&a.ownerDocument&&nr(a.ownerDocument.documentElement,a)){if(null!==l&&ir(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var h=a.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=a.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!f.extend&&m>g&&(o=g,g=m,m=o);var y=tr(a,m),v=tr(a,g);if(y&&v&&(1!==f.rangeCount||f.anchorNode!==y.node||f.anchorOffset!==y.offset||f.focusNode!==v.node||f.focusOffset!==v.offset)){var b=h.createRange();b.setStart(y.node,y.offset),f.removeAllRanges(),m>g?(f.addRange(b),f.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),f.addRange(b))}}}}for(h=[],f=a;f=f.parentNode;)1===f.nodeType&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<h.length;a++){var w=h[a];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}bd=!!ph,mh=ph=null}finally{fc=i,L.p=r,P.T=n}}e.current=t,jc=2}}function yu(){if(2===jc){jc=0;var e=Fc,t=Vc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=P.T,P.T=null;var r=L.p;L.p=2;var i=fc;fc|=4;try{Pl(e,t.alternate,t)}finally{fc=i,L.p=r,P.T=n}}jc=3}}function vu(){if(4===jc||3===jc){jc=0,ae();var e=Fc,t=Vc,n=zc,r=qc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?jc=5:(jc=0,Vc=Fc=null,bu(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Rc=null),je(n),t=t.stateNode,ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ye,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=P.T,i=L.p,L.p=2,P.T=null;try{for(var s=e.onRecoverableError,o=0;o<r.length;o++){var a=r[o];s(a.value,{componentStack:a.stack})}}finally{P.T=t,L.p=i}}0!==(3&zc)&&wu(),Lu(e),i=e.pendingLanes,0!==(261930&n)&&0!==(42&i)?e===Hc?Gc++:(Gc=0,Hc=e):Gc=0,Ru(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,zi(t)))}function wu(){return gu(),yu(),vu(),xu()}function xu(){if(5!==jc)return!1;var e=Fc,t=Uc;Uc=0;var n=je(zc),r=P.T,i=L.p;try{L.p=32>n?32:n,P.T=null,n=Bc,Bc=null;var s=Fc,a=zc;if(jc=0,Vc=Fc=null,zc=0,0!==(6&fc))throw Error(o(331));var l=fc;if(fc|=4,lc(s.current),ec(s,s.current,a,n),fc=l,Ru(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ye,s)}catch(c){}return!0}finally{L.p=i,P.T=r,bu(e,t)}}function Su(e,t,n){t=Wr(n,t),null!==(e=bs(e,t=Na(e.stateNode,t,2),2))&&(Me(e,2),Lu(e))}function _u(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Rc||!Rc.has(r))){e=Wr(n,e),null!==(r=bs(t,n=Aa(2),2))&&(Da(n,r,t,e),Me(r,2),Lu(r));break}}t=t.return}}function Eu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new dc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(xc=!0,i.add(n),e=Tu.bind(null,e,t,n),t.then(e,e))}function Tu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,pc===e&&(gc&n)===n&&(4===_c||3===_c&&(62914560&gc)===gc&&300>le()-Mc?0===(2&fc)&&tu(e,0):kc|=n,Cc===gc&&(Cc=0)),Lu(e)}function ku(e,t){0===t&&(t=Ae()),null!==(e=Or(e,t))&&(Me(e,t),Lu(e))}function Iu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ku(e,n)}function Cu(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==r&&r.delete(t),ku(e,n)}var Nu=null,Au=null,Du=!1,Mu=!1,Ou=!1,Pu=0;function Lu(e){e!==Au&&null===e.next&&(null===Au?Nu=Au=e:Au=Au.next=e),Mu=!0,Du||(Du=!0,Eh(function(){0!==(6&fc)?ie(ue,ju):Fu()}))}function Ru(e,t){if(!Ou&&Mu){Ou=!0;do{for(var n=!1,r=Nu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var s=0;else{var o=r.suspendedLanes,a=r.pingedLanes;s=(1<<31-we(42|e)+1)-1,s=201326741&(s&=i&~(o&~a))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,Uu(r,s))}else s=gc,0===(3&(s=Ie(r,r===pc?s:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ce(r,s)||(n=!0,Uu(r,s));r=r.next}}while(n);Ou=!1}}function ju(){Fu()}function Fu(){Mu=Du=!1;var e=0;0!==Pu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==wh&&(wh=e,!0);return wh=null,!1}()&&(e=Pu);for(var t=le(),n=null,r=Nu;null!==r;){var i=r.next,s=Vu(r,t);0===s?(r.next=null,null===n?Nu=i:n.next=i,null===i&&(Au=n)):(n=r,(0!==e||0!==(3&s))&&(Mu=!0)),r=i}0!==jc&&5!==jc||Ru(e,!1),0!==Pu&&(Pu=0)}function Vu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var o=31-we(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=Ne(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(n=gc,n=Ie(e,e===(t=pc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===yc||9===yc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ce(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&se(r),je(n)){case 2:case 8:n=he;break;case 32:default:n=de;break;case 268435456:n=pe}return r=zu.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function zu(e,t){if(0!==jc&&5!==jc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(wu()&&e.callbackNode!==n)return null;var r=gc;return 0===(r=Ie(e,e===pc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Xc(e,r,t),Vu(e,le()),null!=e.callbackNode&&e.callbackNode===n?zu.bind(null,e):null)}function Uu(e,t){if(wu())return null;Xc(e,t,!0)}function Bu(){if(0===Pu){var e=qi;0===e&&(e=_e,0===(261888&(_e<<=1))&&(_e=256)),Pu=e}return Pu}function qu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Dt(""+e)}function Gu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Hu=0;Hu<Er.length;Hu++){var Ku=Er[Hu];Tr(Ku.toLowerCase(),"on"+(Ku[0].toUpperCase()+Ku.slice(1)))}Tr(gr,"onAnimationEnd"),Tr(yr,"onAnimationIteration"),Tr(vr,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(br,"onTransitionRun"),Tr(wr,"onTransitionStart"),Tr(xr,"onTransitionCancel"),Tr(Sr,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qu));function Xu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){kr(u)}i.currentTarget=null,s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){kr(u)}i.currentTarget=null,s=l}}}}function Yu(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var r=e+"__bubble";n.has(r)||(eh(t,e,2,!1),n.add(r))}function Ju(e,t,n){var r=0;t&&(r|=4),eh(n,e,r,t)}var $u="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[$u]){e[$u]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Wu.has(t)||Ju(t,!1,e),Ju(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$u]||(t[$u]=!0,Ju("selectionchange",!1,t))}}function eh(e,t,n,r){switch(kd(t)){case 2:var i=wd;break;case 8:i=xd;break;default:i=Sd}n=i.bind(null,t,n,e),i=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function th(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===i)return;o=o.return}for(;null!==a;){if(null===(o=Ye(a)))return;if(5===(c=o.tag)||6===c||26===c||27===c){r=s=o;continue e}a=a.parentNode}}r=r.return}Vt(function(){var r=s,i=Pt(n),o=[];e:{var a=_r.get(e);if(void 0!==a){var c=nn,u=e;switch(e){case"keypress":if(0===Wt(n))break e;case"keydown":case"keyup":c=vn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=an;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=wn;break;case gr:case yr:case vr:c=un;break;case Sr:c=xn;break;case"scroll":case"scrollend":c=sn;break;case"wheel":c=Sn;break;case"copy":case"cut":case"paste":c=hn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=bn;break;case"toggle":case"beforetoggle":c=_n}var h=0!==(4&t),d=!h&&("scroll"===e||"scrollend"===e),f=h?null!==a?a+"Capture":null:a;h=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===f||null!=(g=zt(m,f))&&h.push(nh(m,g,p)),d)break;m=m.return}0<h.length&&(a=new c(a,u,null,n,i),o.push({event:a,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Ot||!(u=n.relatedTarget||n.fromElement)||!Ye(u)&&!u[qe])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Ye(u):null)&&(d=l(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=r),c!==u)){if(h=an,g="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=bn,g="onPointerLeave",f="onPointerEnter",m="pointer"),d=null==c?a:$e(c),p=null==u?a:$e(u),(a=new h(g,m+"leave",c,n,i)).target=d,a.relatedTarget=p,g=null,Ye(i)===r&&((h=new h(f,m+"enter",u,n,i)).target=p,h.relatedTarget=d,g=h),d=g,c&&u)e:{for(h=ih,m=u,p=0,g=f=c;g;g=h(g))p++;g=0;for(var y=m;y;y=h(y))g++;for(;0<p-g;)f=h(f),p--;for(;0<g-p;)m=h(m),g--;for(;p--;){if(f===m||null!==m&&f===m.alternate){h=f;break e}f=h(f),m=h(m)}h=null}else h=null;null!==c&&sh(o,a,c,h,!1),null!==u&&null!==d&&sh(o,d,u,h,!0)}if("select"===(c=(a=r?$e(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var v=Un;else if(Ln(a))if(Bn)v=Jn;else{v=Xn;var b=Wn}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Ct(r.elementType)&&(v=Un):v=Yn;switch(v&&(v=v(e,r))?Rn(o,v,n,i):(b&&b(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&wt(a,"number",a.value)),b=r?$e(r):window,e){case"focusin":(Ln(b)||"true"===b.contentEditable)&&(or=b,ar=r,lr=null);break;case"focusout":lr=ar=or=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,ur(o,n,i);break;case"selectionchange":if(sr)break;case"keydown":case"keyup":ur(o,n,i)}var w;if(Tn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else On?Dn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Cn&&"ko"!==n.locale&&(On||"onCompositionStart"!==x?"onCompositionEnd"===x&&On&&(w=Qt()):(Ht="value"in(Gt=i)?Gt.value:Gt.textContent,On=!0)),0<(b=rh(r,x)).length&&(x=new dn(x,e,null,n,i),o.push({event:x,listeners:b}),w?x.data=w:null!==(w=Mn(n))&&(x.data=w))),(w=In?function(e,t){switch(e){case"compositionend":return Mn(t);case"keypress":return 32!==t.which?null:(An=!0,Nn);case"textInput":return(e=t.data)===Nn&&An?null:e;default:return null}}(e,n):function(e,t){if(On)return"compositionend"===e||!Tn&&Dn(e,t)?(e=Qt(),Kt=Ht=Gt=null,On=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(x=rh(r,"onBeforeInput")).length&&(b=new dn("onBeforeInput","beforeinput",null,n,i),o.push({event:b,listeners:x}),b.data=w)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var s=qu((i[Be]||null).action),o=r.submitter;o&&null!==(t=(t=o[Be]||null)?qu(t.formAction):o.getAttribute("formAction"))&&(s=t,o=null);var a=new nn("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Pu){var e=o?Gu(i,o):new FormData(i);ta(n,{pending:!0,data:e,method:i.method,action:s},null,e)}}else"function"===typeof s&&(a.preventDefault(),e=o?Gu(i,o):new FormData(i),ta(n,{pending:!0,data:e,method:i.method,action:s},s,e))},currentTarget:i}]})}}(o,e,r,n,i)}Xu(o,t)})}function nh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rh(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===s||(null!=(i=zt(e,n))&&r.unshift(nh(e,i,s)),null!=(i=zt(e,t))&&r.push(nh(e,i,s))),3===e.tag)return r;e=e.return}return[]}function ih(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sh(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=zt(n,s))&&o.unshift(nh(n,c,l)):i||null!=(c=zt(n,s))&&o.push(nh(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var oh=/\r\n?/g,ah=/\u0000|\uFFFD/g;function lh(e){return("string"===typeof e?e:""+e).replace(oh,"\n").replace(ah,"")}function ch(e,t){return t=lh(t),lh(e)===t}function uh(e,t,n,r,i,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":It(e,r,s);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Dt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&uh(e,t,"name",i.name,i,null),uh(e,t,"formEncType",i.formEncType,i,null),uh(e,t,"formMethod",i.formMethod,i,null),uh(e,t,"formTarget",i.formTarget,i,null)):(uh(e,t,"encType",i.encType,i,null),uh(e,t,"method",i.method,i,null),uh(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Dt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Mt);break;case"onScroll":null!=r&&Yu("scroll",e);break;case"onScrollEnd":null!=r&&Yu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Dt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Yu("beforetoggle",e),Yu("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=Nt.get(n)||n,r)}}function hh(e,t,n,r,i,s){switch(n){case"style":It(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&Yu("scroll",e);break;case"onScrollEnd":null!=r&&Yu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Mt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(s=null!=(s=e[Be]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function dh(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yu("error",e),Yu("load",e);var r,i=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:uh(e,t,r,a,n,null)}}return s&&uh(e,t,"srcSet",n.srcSet,n,null),void(i&&uh(e,t,"src",n.src,n,null));case"input":Yu("invalid",e);var l=r=a=s=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":s=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(o(137,t));break;default:uh(e,t,i,h,n,null)}}return void bt(e,r,l,c,u,a,s,!1);case"select":for(s in Yu("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:uh(e,t,s,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?xt(e,!!i,t,!1):null!=n&&xt(e,!!i,n,!0));case"textarea":for(a in Yu("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:uh(e,t,a,l,n,null)}return void _t(e,i,s,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else uh(e,t,c,i,n,null);return;case"dialog":Yu("beforetoggle",e),Yu("toggle",e),Yu("cancel",e),Yu("close",e);break;case"iframe":case"object":Yu("load",e);break;case"video":case"audio":for(i=0;i<Qu.length;i++)Yu(Qu[i],e);break;case"image":Yu("error",e),Yu("load",e);break;case"details":Yu("toggle",e);break;case"embed":case"source":case"link":Yu("error",e),Yu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:uh(e,t,u,i,n,null)}return;default:if(Ct(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&hh(e,t,h,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&uh(e,t,l,i,n,null))}function fh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var ph=null,mh=null;function gh(e){return 9===e.nodeType?e:e.ownerDocument}function yh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wh=null;var xh="function"===typeof setTimeout?setTimeout:void 0,Sh="function"===typeof clearTimeout?clearTimeout:void 0,_h="function"===typeof Promise?Promise:void 0,Eh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof _h?function(e){return _h.resolve(null).then(e).catch(Th)}:xh;function Th(e){setTimeout(function(){throw e})}function kh(e){return"head"===e}function Ih(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)||"/&"===n){if(0===r)return e.removeChild(i),void Gd(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Fh(e.ownerDocument.documentElement);else if("head"===n){Fh(n=e.ownerDocument.head);for(var s=n.firstChild;s;){var o=s.nextSibling,a=s.nodeName;s[We]||"SCRIPT"===a||"STYLE"===a||"LINK"===a&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=o}}else"body"===n&&Fh(e.ownerDocument.body);n=i}while(n);Gd(t)}function Ch(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Nh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Nh(n),Xe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Ah(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Oh(e.nextSibling)))return null}return e}function Dh(e){return"$?"===e.data||"$~"===e.data}function Mh(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Oh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ph=null;function Lh(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Oh(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Rh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function jh(e,t,n){switch(t=gh(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function Fh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var Vh=new Map,zh=new Set;function Uh(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Bh=L.d;L.d={f:function(){var e=Bh.f(),t=Zc();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?ra(t):Bh.r(e)},D:function(e){Bh.D(e),Gh("dns-prefetch",e,null)},C:function(e,t){Bh.C(e,t),Gh("preconnect",e,t)},L:function(e,t,n){Bh.L(e,t,n);var r=qh;if(r&&e&&t){var i='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+yt(n.imageSizes)+'"]')):i+='[href="'+yt(e)+'"]';var s=i;switch(t){case"style":s=Kh(e);break;case"script":s=Xh(e)}Vh.has(s)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Vh.set(s,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Qh(s))||"script"===t&&r.querySelector(Yh(s))||(dh(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Bh.m(e,t);var n=qh;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+yt(r)+'"][href="'+yt(e)+'"]',s=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Xh(e)}if(!Vh.has(s)&&(e=f({rel:"modulepreload",href:e},t),Vh.set(s,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Yh(s)))return}dh(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){Bh.X(e,t);var n=qh;if(n&&e){var r=Ze(n).hoistableScripts,i=Xh(e),s=r.get(i);s||((s=n.querySelector(Yh(i)))||(e=f({src:e,async:!0},t),(t=Vh.get(i))&&ed(e,t),et(s=n.createElement("script")),dh(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}},S:function(e,t,n){Bh.S(e,t,n);var r=qh;if(r&&e){var i=Ze(r).hoistableStyles,s=Kh(e);t=t||"default";var o=i.get(s);if(!o){var a={loading:0,preload:null};if(o=r.querySelector(Qh(s)))a.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Vh.get(s))&&Zh(e,n);var l=o=r.createElement("link");et(l),dh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,$h(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:a},i.set(s,o)}}},M:function(e,t){Bh.M(e,t);var n=qh;if(n&&e){var r=Ze(n).hoistableScripts,i=Xh(e),s=r.get(i);s||((s=n.querySelector(Yh(i)))||(e=f({src:e,async:!0,type:"module"},t),(t=Vh.get(i))&&ed(e,t),et(s=n.createElement("script")),dh(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}}};var qh="undefined"===typeof document?null:document;function Gh(e,t,n){var r=qh;if(r&&"string"===typeof t&&t){var i=yt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),zh.has(i)||(zh.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(dh(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Hh(e,t,n,r){var i,s,a,l,c=(c=K.current)?Uh(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Kh(n.href),(r=(n=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Kh(n.href);var u=Ze(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Qh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Vh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Vh.set(e,n),u||(i=c,s=e,a=n,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),dh(s,"link",a),et(s),i.head.appendChild(s))))),t&&null===r)throw Error(o(528,""));return h}if(t&&null!==r)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Xh(n),(r=(n=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Kh(e){return'href="'+yt(e)+'"'}function Qh(e){return'link[rel="stylesheet"]['+e+"]"}function Wh(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Xh(e){return'[src="'+yt(e)+'"]'}function Yh(e){return"script[async]"+e}function Jh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var i=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),dh(r,"style",i),$h(r,n.precedence,e),t.instance=r;case"stylesheet":i=Kh(n.href);var s=e.querySelector(Qh(i));if(s)return t.state.loading|=4,t.instance=s,et(s),s;r=Wh(n),(i=Vh.get(i))&&Zh(r,i),et(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),dh(s,"link",r),t.state.loading|=4,$h(s,n.precedence,e),t.instance=s;case"script":return s=Xh(n.src),(i=e.querySelector(Yh(s)))?(t.instance=i,et(i),i):(r=n,(i=Vh.get(s))&&ed(r=f({},n),i),et(i=(e=e.ownerDocument||e).createElement("script")),dh(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,$h(r,n.precedence,e));return t.instance}function $h(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,s=i,o=0;o<r.length;o++){var a=r[o];if(a.dataset.precedence===t)s=a;else if(s!==i)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Zh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function ed(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var td=null;function nd(e,t,n){if(null===td){var r=new Map,i=td=new Map;i.set(n,r)}else(r=(i=td).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var s=n[i];if(!(s[We]||s[Ue]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var o=s.getAttribute(t)||"";o=e+o;var a=r.get(o);a?a.push(s):r.set(o,[s])}}return r}function rd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function id(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sd=0;function od(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)ld(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ad=null;function ld(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ad=new Map,t.forEach(cd,e),ad=null,od.call(e))}function cd(e,t){if(!(4&t.state.loading)){var n=ad.get(e);if(n)var r=n.get(null);else{n=new Map,ad.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<i.length;s++){var o=i[s];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(i=t.instance).getAttribute("data-precedence"),(s=n.get(o)||r)===r&&n.set(null,i),n.set(o,i),this.count++,r=od.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),s?s.parentNode.insertBefore(i,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var ud={$$typeof:x,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function hd(e,t,n,r,i,s,o,a,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=De(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=De(0),this.hiddenUpdates=De(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function dd(e,t,n,r,i,s,o,a,l,c,u,h){return e=new hd(e,t,n,o,l,c,u,h,a),t=1,!0===s&&(t|=24),s=Fr(3,null,null,t),e.current=s,s.stateNode=e,(t=Vi()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},gs(s),e}function fd(e){return e?e=Rr:Rr}function pd(e,t,n,r,i,s){i=fd(i),null===r.context?r.context=i:r.pendingContext=i,(r=vs(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=bs(e,r,t))&&(Wc(n,0,t),ws(n,e,t))}function md(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gd(e,t){md(e,t),(e=e.alternate)&&md(e,t)}function yd(e){if(13===e.tag||31===e.tag){var t=Or(e,67108864);null!==t&&Wc(t,0,67108864),gd(e,67108864)}}function vd(e){if(13===e.tag||31===e.tag){var t=Kc(),n=Or(e,t=Re(t));null!==n&&Wc(n,0,t),gd(e,t)}}var bd=!0;function wd(e,t,n,r){var i=P.T;P.T=null;var s=L.p;try{L.p=2,Sd(e,t,n,r)}finally{L.p=s,P.T=i}}function xd(e,t,n,r){var i=P.T;P.T=null;var s=L.p;try{L.p=8,Sd(e,t,n,r)}finally{L.p=s,P.T=i}}function Sd(e,t,n,r){if(bd){var i=_d(r);if(null===i)th(e,t,r,Ed,n),Ld(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Cd=Rd(Cd,e,t,n,r,i),!0;case"dragenter":return Nd=Rd(Nd,e,t,n,r,i),!0;case"mouseover":return Ad=Rd(Ad,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Dd.set(s,Rd(Dd.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Md.set(s,Rd(Md.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ld(e,r),4&t&&-1<Pd.indexOf(e)){for(;null!==i;){var s=Je(i);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var o=ke(s.pendingLanes);if(0!==o){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-we(o);a.entanglements[1]|=l,o&=~l}Lu(s),0===(6&fc)&&(Pc=le()+500,Ru(0,!1))}}break;case 31:case 13:null!==(a=Or(s,2))&&Wc(a,0,2),Zc(),gd(s,2)}if(null===(s=_d(r))&&th(e,t,r,Ed,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else th(e,t,r,null,n)}}function _d(e){return Td(e=Pt(e))}var Ed=null;function Td(e){if(Ed=null,null!==(e=Ye(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ed=e,null}function kd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case fe:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Id=!1,Cd=null,Nd=null,Ad=null,Dd=new Map,Md=new Map,Od=[],Pd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ld(e,t){switch(e){case"focusin":case"focusout":Cd=null;break;case"dragenter":case"dragleave":Nd=null;break;case"mouseover":case"mouseout":Ad=null;break;case"pointerover":case"pointerout":Dd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Md.delete(t.pointerId)}}function Rd(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=Je(t))&&yd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function jd(e){var t=Ye(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void Ve(e.priority,function(){vd(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Ve(e.priority,function(){vd(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=_d(e.nativeEvent);if(null!==n)return null!==(t=Je(n))&&yd(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ot=r,n.target.dispatchEvent(r),Ot=null,t.shift()}return!0}function Vd(e,t,n){Fd(e)&&n.delete(t)}function zd(){Id=!1,null!==Cd&&Fd(Cd)&&(Cd=null),null!==Nd&&Fd(Nd)&&(Nd=null),null!==Ad&&Fd(Ad)&&(Ad=null),Dd.forEach(Vd),Md.forEach(Vd)}function Ud(e,t){e.blockedOn===t&&(e.blockedOn=null,Id||(Id=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zd)))}var Bd=null;function qd(e){Bd!==e&&(Bd=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Bd===e&&(Bd=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===Td(r||n))continue;break}var s=Je(n);null!==s&&(e.splice(t,3),t-=3,ta(s,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Gd(e){function t(t){return Ud(t,e)}null!==Cd&&Ud(Cd,e),null!==Nd&&Ud(Nd,e),null!==Ad&&Ud(Ad,e),Dd.forEach(t),Md.forEach(t);for(var n=0;n<Od.length;n++){var r=Od[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Od.length&&null===(n=Od[0]).blockedOn;)jd(n),null===n.blockedOn&&Od.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],s=n[r+1],o=i[Be]||null;if("function"===typeof s)o||qd(n);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(i=s,o=s[Be]||null)a=o.formAction;else if(null!==Td(i))continue}else a=o.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),qd(n)}}}function Hd(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==i&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==i&&(i(),i=null)}}}function Kd(e){this._internalRoot=e}function Qd(e){this._internalRoot=e}Qd.prototype.render=Kd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));pd(t.current,Kc(),e,t,null,null)},Qd.prototype.unmount=Kd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;pd(e.current,2,null,e,null,null),Zc(),t[qe]=null}},Qd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Od.length&&0!==t&&t<Od[n].priority;n++);Od.splice(n,0,e),0===n&&jd(e)}};var Wd=i.version;if("19.2.3"!==Wd)throw Error(o(527,Wd,"19.2.3"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return h(i),e;if(s===r)return h(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Xd={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{ye=Yd.inject(Xd),ve=Yd}catch($d){}}t.createRoot=function(e,t){if(!a(e))throw Error(o(299));var n=!1,r="",i=Ea,s=Ta,l=ka;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=dd(e,1,!1,null,0,n,r,null,i,s,l,Hd),e[qe]=t.current,Zu(e),new Kd(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(o(299));var r=!1,i="",s=Ea,l=Ta,c=ka,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=dd(e,1,!0,t,0,r,i,u,s,l,c,Hd)).context=fd(null),n=t.current,(i=vs(r=Re(r=Kc()))).callback=null,bs(n,i,r),n=r,t.current.lanes=n,Me(t,n),Lu(t),e[qe]=t.current,Zu(e),new Qd(t)},t.version="19.2.3"},43:(e,t,n)=>{"use strict";e.exports=n(288)},45:(e,t,n)=>{var r=n(738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},98:(e,t,n)=>{"use strict";var r=n(897).default;Object.defineProperty(t,"__esModule",{value:!0});var i=n(858),s=n(887),o=n(679),a=n(799);class l{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const c="@firebase/app",u="0.14.6",h=new s.Logger("@firebase/app"),d="@firebase/app-compat",f="@firebase/analytics-compat",p="@firebase/analytics",m="@firebase/app-check-compat",g="@firebase/app-check",y="@firebase/auth",v="@firebase/auth-compat",b="@firebase/database",w="@firebase/data-connect",x="@firebase/database-compat",S="@firebase/functions",_="@firebase/functions-compat",E="@firebase/installations",T="@firebase/installations-compat",k="@firebase/messaging",I="@firebase/messaging-compat",C="@firebase/performance",N="@firebase/performance-compat",A="@firebase/remote-config",D="@firebase/remote-config-compat",M="@firebase/storage",O="@firebase/storage-compat",P="@firebase/firestore",L="@firebase/ai",R="@firebase/firestore-compat",j="firebase",F="[DEFAULT]",V={[c]:"fire-core",[d]:"fire-core-compat",[p]:"fire-analytics",[f]:"fire-analytics-compat",[g]:"fire-app-check",[m]:"fire-app-check-compat",[y]:"fire-auth",[v]:"fire-auth-compat",[b]:"fire-rtdb",[w]:"fire-data-connect",[x]:"fire-rtdb-compat",[S]:"fire-fn",[_]:"fire-fn-compat",[E]:"fire-iid",[T]:"fire-iid-compat",[k]:"fire-fcm",[I]:"fire-fcm-compat",[C]:"fire-perf",[N]:"fire-perf-compat",[A]:"fire-rc",[D]:"fire-rc-compat",[M]:"fire-gcs",[O]:"fire-gcs-compat",[P]:"fire-fst",[R]:"fire-fst-compat",[L]:"fire-vertex","fire-js":"fire-js",[j]:"fire-js-all"},z=new Map,U=new Map,B=new Map;function q(e,t){try{e.container.addComponent(t)}catch(n){h.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function G(e){const t=e.name;if(B.has(t))return h.debug("There were multiple attempts to register component ".concat(t,".")),!1;B.set(t,e);for(const n of z.values())q(n,e);for(const n of U.values())q(n,e);return!0}function H(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function K(e){return void 0!==e.options}function Q(e){return!K(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}const W={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},X=new o.ErrorFactory("app","Firebase",W);class Y{constructor(e,t,n){this._isDeleted=!1,this._options=r({},e),this._config=r({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw X.create("app-deleted",{appName:this._name})}}function J(e,t){const n=o.base64Decode(e.split(".")[1]);if(null===n)return void console.error("FirebaseServerApp ".concat(t," is invalid: second part could not be parsed."));if(void 0===JSON.parse(n).exp)return void console.error("FirebaseServerApp ".concat(t," is invalid: expiration claim could not be parsed"));1e3*JSON.parse(n).exp-(new Date).getTime()<=0&&console.error("FirebaseServerApp ".concat(t," is invalid: the token has expired."))}class $ extends Y{constructor(e,t,n,i){const s=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,o={name:n,automaticDataCollectionEnabled:s};if(void 0!==e.apiKey)super(e,o,i);else{super(e.options,o,i)}this._serverConfig=r({automaticDataCollectionEnabled:s},t),this._serverConfig.authIdToken&&J(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&J(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!==typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,te(c,u,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){ee(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw X.create("server-app-deleted")}}function Z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const s=r({name:F,automaticDataCollectionEnabled:!0},t),a=s.name;if("string"!==typeof a||!a)throw X.create("bad-app-name",{appName:String(a)});if(n||(n=o.getDefaultAppConfig()),!n)throw X.create("no-options");const l=z.get(a);if(l){if(o.deepEqual(n,l.options)&&o.deepEqual(s,l.config))return l;throw X.create("duplicate-app",{appName:a})}const c=new i.ComponentContainer(a);for(const r of B.values())c.addComponent(r);const u=new Y(n,s,c);return z.set(a,u),u}async function ee(e){let t=!1;const n=e.name;if(z.has(n))t=!0,z.delete(n);else if(U.has(n)){e.decRefCount()<=0&&(U.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function te(e,t,n){var r;let s=null!==(r=V[e])&&void 0!==r?r:e;n&&(s+="-".concat(n));const o=s.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),o&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void h.warn(e.join(" "))}G(new i.Component("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const ne="firebase-heartbeat-store";let re=null;function ie(){return re||(re=a.openDB("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ne)}catch(n){console.warn(n)}}}).catch(e=>{throw X.create("idb-open",{originalErrorMessage:e.message})})),re}async function se(e,t){try{const n=(await ie()).transaction(ne,"readwrite"),r=n.objectStore(ne);await r.put(t,oe(e)),await n.done}catch(n){if(n instanceof o.FirebaseError)h.warn(n.message);else{const e=X.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});h.warn(e.message)}}}function oe(e){return"".concat(e.name,"!").concat(e.options.appId)}class ae{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ce(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=le();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){h.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=le(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),ue(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ue(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=o.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return h.warn(t),""}}}function le(){return(new Date).toISOString().substring(0,10)}class ce{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!o.isIndexedDBAvailable()&&o.validateIndexedDBOpenable().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ie()).transaction(ne),n=await t.objectStore(ne).get(oe(e));return await t.done,n}catch(t){if(t instanceof o.FirebaseError)h.warn(t.message);else{const e=X.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});h.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return se(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return se(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ue(e){return o.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}var he;he="node",G(new i.Component("platform-logger",e=>new l(e),"PRIVATE")),G(new i.Component("heartbeat",e=>new ae(e),"PRIVATE")),te(c,u,he),te(c,u,"cjs2020"),te("fire-js",""),Object.defineProperty(t,"FirebaseError",{enumerable:!0,get:function(){return o.FirebaseError}}),t.SDK_VERSION="12.6.0",t._DEFAULT_ENTRY_NAME=F,t._addComponent=q,t._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},t._apps=z,t._clearComponents=function(){B.clear()},t._components=B,t._getProvider=H,t._isFirebaseApp=K,t._isFirebaseServerApp=function(e){return null!==e&&void 0!==e&&void 0!==e.settings},t._isFirebaseServerAppSettings=Q,t._registerComponent=G,t._removeServiceInstance=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F;H(e,t).clearInstance(n)},t._serverApps=U,t.deleteApp=ee,t.getApp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;const t=z.get(e);if(!t&&e===F&&o.getDefaultAppConfig())return Z();if(!t)throw X.create("no-app",{appName:e});return t},t.getApps=function(){return Array.from(z.values())},t.initializeApp=Z,t.initializeServerApp=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o.isBrowser()&&!o.isWebWorker())throw X.create("invalid-server-app-environment");let s=n||{};if(e&&(K(e)?t=e.options:Q(e)?s=e:t=e),void 0===s.automaticDataCollectionEnabled&&(s.automaticDataCollectionEnabled=!0),t||(t=o.getDefaultAppConfig()),!t)throw X.create("no-options");const a=r(r({},s),t);if(void 0!==a.releaseOnDeref&&delete a.releaseOnDeref,void 0!==s.releaseOnDeref&&"undefined"===typeof FinalizationRegistry)throw X.create("finalization-registry-not-supported",{});const l=""+(c=JSON.stringify(a),[...c].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0));var c;const u=U.get(l);if(u)return u.incRefCount(s.releaseOnDeref),u;const h=new i.ComponentContainer(l);for(const r of B.values())h.addComponent(r);const d=new $(t,s,l,h);return U.set(l,d),d},t.onLog=function(e,t){if(null!==e&&"function"!==typeof e)throw X.create("invalid-log-argument");s.setUserLogHandler(e,t)},t.registerVersion=te,t.setLogLevel=function(e){s.setLogLevel(e)}},180:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},193:(e,t,n)=>{(function(){"use strict";var t;function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function r(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let s,o=e.g[3];s=t+(o^n&(i^o))+r[0]+3614090360&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[2]+606105819&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[3]+3250441966&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[4]+4118548399&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[7]+4249261313&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[8]+1770035416&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[11]+2304563134&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[12]+1804603682&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[15]+1236535329&4294967295,s=t+(i^o&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[11]+643717713&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[0]+3921069994&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[15]+3634488961&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[4]+3889429448&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[3]+4107603335&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[8]+1163531501&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[7]+1735328473&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[12]+2368359562&4294967295,s=t+((n=i+(s<<20&4294967295|s>>>12))^i^o)+r[5]+4294588738&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[11]+1839030562&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[14]+4259657740&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[1]+2763975236&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[7]+4139469664&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[10]+3200236656&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[13]+681279174&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[3]+3572445317&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[6]+76029189&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[9]+3654602809&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[15]+530742520&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[2]+3299628645&4294967295,s=t+(i^((n=i+(s<<23&4294967295|s>>>9))|~o))+r[0]+4096336452&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[14]+2878612391&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[12]+1700485571&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[10]+4293915773&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[8]+1873313359&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[6]+2734768916&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[4]+4149444226&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[2]+718787259&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function i(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(n,function(){this.blockSize=-1}),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},n.prototype.v=function(e,t){void 0===t&&(t=e.length);const n=t-this.blockSize,i=this.C;let s=this.h,o=0;for(;o<t;){if(0==s)for(;o<=n;)r(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){r(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){r(this,i),s=0;break}}this.h=s,this.o+=t},n.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var s={};function o(e){return-128<=e&&e<128?function(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new i([0|e],e<0?-1:0)}):new i([0|e],e<0?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return l;if(e<0)return f(a(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var l=o(0),c=o(1),u=o(16777216);function h(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function f(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(c)}function p(e,t){return e.add(f(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function y(e,t){if(h(t))throw Error("division by zero");if(h(e))return new g(l,l);if(d(e))return t=y(f(e),t),new g(f(t.g),f(t.h));if(d(t))return t=y(e,f(t)),new g(f(t.g),t.h);if(e.g.length>30){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=t;r.l(e)<=0;)n=v(n),r=v(r);var i=b(n,1),s=b(r,1);for(r=b(r,2),n=b(n,2);!h(r);){var o=s.add(r);o.l(e)<=0&&(i=i.add(n),s=o),r=b(r,1),n=b(n,1)}return t=p(e,i.j(t)),new g(i,t)}for(i=l;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),o=(s=a(n)).j(t);d(o)||o.l(e)>0;)o=(s=a(n-=r)).j(t);h(s)&&(s=c),i=i.add(s),e=p(e,o)}return new g(i,e)}function v(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function b(e,t){const n=t>>5;t%=32;const r=e.g.length-n,s=[];for(let i=0;i<r;i++)s[i]=t>0?e.i(i+n)>>>t|e.i(i+n+1)<<32-t:e.i(i+n);return new i(s,e.h)}(t=i.prototype).m=function(){if(d(this))return-f(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},t.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(h(this))return"0";if(d(this))return"-"+f(this).toString(e);const t=a(Math.pow(e,6));var n=this;let r="";for(;;){const i=y(n,t).g;let s=(((n=p(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(h(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},t.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},t.l=function(e){return d(e=p(this,e))?-1:h(e)?0:1},t.abs=function(){return d(this)?f(this):this},t.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let r=0;for(let i=0;i<=t;i++){let t=r+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=s>>>16,t&=65535,s&=65535,n[i]=s<<16|t}return new i(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(e){if(h(this)||h(e))return l;if(d(this))return d(e)?f(this).j(f(e)):f(f(this).j(e));if(d(e))return f(this.j(f(e)));if(this.l(u)<0&&e.l(u)<0)return a(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){const i=this.i(r)>>>16,s=65535&this.i(r),o=e.i(t)>>>16,a=65535&e.i(t);n[2*r+2*t]+=s*a,m(n,2*r+2*t),n[2*r+2*t+1]+=i*a,m(n,2*r+2*t+1),n[2*r+2*t+1]+=s*o,m(n,2*r+2*t+1),n[2*r+2*t+2]+=i*o,m(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new i(n,0)},t.B=function(e){return y(this,e).h},t.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},t.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},t.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,e.exports.Md5=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=a,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=a(Math.pow(n,8));let i=l;for(let o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o);const e=parseInt(t.substring(o,o+s),n);s<8?(s=a(Math.pow(n,s)),i=i.j(s).add(a(e))):(i=i.j(r),i=i.add(a(e)))}return i},e.exports.Integer=i}).apply("undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},198:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultsFromPostinstall=()=>{}},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var x=w.prototype=new b;x.constructor=w,g(x,v.prototype),x.isPureReactComponent=!0;var S=Array.isArray;function _(){}var E={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function k(e,t,r){var i=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==i?i:null,props:r}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case d:return A((u=e._init)(e._payload),t,i,s,o)}}if(u)return o=o(e),u=""===s?"."+N(e,0):s,S(o)?(i="",null!=u&&(i=u.replace(C,"$&/")+"/"),A(o,t,i,"",function(e){return e})):null!=o&&(I(o)&&(l=o,c=i+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+u,o=k(l.type,c,l.props)),t.push(o)),1;u=0;var h,f=""===s?".":s+":";if(S(e))for(var m=0;m<e.length;m++)u+=A(s=e[m],t,i,a=f+N(s,m),o);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=p&&h[p]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=A(s=s.value,t,i,a=f+N(s,m++),o);else if("object"===a){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(_,_):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,s,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function D(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",function(e){return t.call(n,e,i++)}),r}function M(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},P={map:D,forEach:function(e,t,n){D(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(e){return e})||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=P,t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=w,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(s in void 0!==t.key&&(i=""+t.key),t)!T.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];r.children=o}return k(e.type,i,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)T.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===i[r]&&(i[r]=o[r]);return k(e,s,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var r=e(),i=E.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(_,O)}catch(s){O(s)}finally{null!==t&&null!==n.types&&(t.types=n.types),E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return E.H.useEffect(e,t)},t.useEffectEvent=function(e){return E.H.useEffectEvent(e)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.2.3"},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},544:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(968);Object.keys(r).forEach(function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},555:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>a})},579:(e,t,n)=>{"use strict";e.exports=n(180)},672:(e,t,n)=>{"use strict";var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(i(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:s}):"script"===n&&o.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.3"},679:(e,t,n)=>{"use strict";var r=n(897).default;Object.defineProperty(t,"__esModule",{value:!0});var i=n(198);const s={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+s.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},l=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(l(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new u;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class u extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const h=function(e){const t=l(e);return c.encodeByteArray(t,!0)},d=function(e){return h(e).replace(/\./g,"")},f=function(e){try{return c.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&m(n)&&(e[n]=p(e[n],t[n]));return e}function m(e){return"__proto__"!==e}function g(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const y=()=>{try{return i.getDefaultsFromPostinstall()||g().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/team-accounting",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&f(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},v=e=>{var t;return null===(t=y())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]};class b{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function w(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}const x={};let S=!1;function _(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function E(){var e;const t=null===(e=y())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function T(){return"undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope}class k extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I.prototype.create)}}class I{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(C,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new k(n,s,t)}}const C=/\{\$([^}]+)}/g;function N(e){return JSON.parse(e)}const A=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=N(f(s[0])||""),n=N(f(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(s){}return{header:t,claims:n,data:r,signature:i}};function D(e){return null!==e&&"object"===typeof e}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=O),void 0===r.error&&(r.error=O),void 0===r.complete&&(r.complete=O);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O(){}function P(e,t){return"".concat(e," failed: ").concat(t," argument ")}const L=144e5;t.CONSTANTS=s,t.DecodeBase64StringError=u,t.Deferred=b,t.ErrorFactory=I,t.FirebaseError=k,t.MAX_VALUE_MILLIS=L,t.RANDOM_FACTOR=.5,t.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(r=l^o&(a^l),i=1518500249):(r=o^a^l,i=1859775393):u<60?(r=o&a|l&(o|a),i=2400959708):(r=o^a^l,i=3395469782);const e=(s<<5|s>>>27)+r+c+i+n[u]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}},t.areCookiesEnabled=function(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)},t.assert=o,t.assertionError=a,t.async=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];Promise.resolve(!0).then(()=>{e(...r)}).catch(e=>{t&&t(e)})}},t.base64=c,t.base64Decode=f,t.base64Encode=h,t.base64urlEncodeWithoutPadding=d,t.calculateBackoffMillis=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(L,n+r)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createMockUserToken=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=r({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(o)),""].join(".")},t.createSubscribe=function(e,t){const n=new M(e,t);return n.subscribe.bind(n)},t.decode=A,t.deepCopy=function(e){return p(void 0,e)},t.deepEqual=function e(t,n){if(t===n)return!0;const r=Object.keys(t),i=Object.keys(n);for(const s of r){if(!i.includes(s))return!1;const r=t[s],o=n[s];if(D(r)&&D(o)){if(!e(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!r.includes(s))return!1;return!0},t.deepExtend=p,t.errorPrefix=P,t.extractQuerystring=function(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)},t.getDefaultAppConfig=()=>{var e;return null===(e=y())||void 0===e?void 0:e.config},t.getDefaultEmulatorHost=v,t.getDefaultEmulatorHostnameAndPort=e=>{const t=v(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},t.getDefaults=y,t.getExperimentalSetting=e=>{var t;return null===(t=y())||void 0===t?void 0:t["_".concat(e)]},t.getGlobal=g,t.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},t.getUA=_,t.isAdmin=function(e){const t=A(e).claims;return"object"===typeof t&&!0===t.admin},t.isBrowser=function(){return"undefined"!==typeof window||T()},t.isBrowserExtension=function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id},t.isCloudWorkstation=w,t.isCloudflareWorker=function(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent},t.isElectron=function(){return _().indexOf("Electron/")>=0},t.isEmpty=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){const e=_();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){try{return"object"===typeof indexedDB}catch(e){return!1}},t.isMobileCordova=function(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_())},t.isNode=E,t.isNodeSdk=function(){return!0===s.NODE_CLIENT||!0===s.NODE_ADMIN},t.isReactNative=function(){return"object"===typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!E()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isSafariOrWebkit=function(){return!E()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return _().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){const t=A(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){const t=A(e).claims,n=Math.floor((new Date).getTime()/1e3);let r=0,i=0;return"object"===typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.isWebWorker=T,t.issuedAtTime=function(e){const t=A(e).claims;return"object"===typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=N,t.map=function(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.ordinal=function(e){return Number.isFinite(e)?e+function(e){e=Math.abs(e);const t=e%100;if(t>=10&&t<=20)return"th";const n=e%10;if(1===n)return"st";if(2===n)return"nd";if(3===n)return"rd";return"th"}(e):"".concat(e)},t.pingServer=async function(e){return(await fetch(e,{credentials:"include"})).ok},t.promiseWithTimeout=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;const n=new b;return setTimeout(()=>n.reject("timeout!"),t),e.then(n.resolve,n.reject),n.promise},t.querystring=function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,o(r<e.length,"Surrogate pair missing trail surrogate.");i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.updateEmulatorBanner=function(e,t){if("undefined"===typeof window||"undefined"===typeof document||!w(window.location.host)||x[e]===t||x[e]||S)return;function n(e){return"__firebase__banner__".concat(e)}x[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(x))x[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{S=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),l=document.getElementById(a)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,o,l,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()},t.validateArgCount=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(P(e,t)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(P(e,t)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})},t.validateNamespace=function(e,t,n){if((!n||t)&&"string"!==typeof t)throw new Error(P(e,"namespace")+"must be a valid firebase namespace.")}},693:(e,t,n)=>{var r=n(736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},736:(e,t,n)=>{var r=n(738).default,i=n(45);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},761:(e,t,n)=>{(function(){"use strict";var t,r=Object.defineProperty;var i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var n=i;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in n))break e;n=n[o]}(t=t(s=n[e=e[e.length-1]]))!=s&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}s("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var o=o||{},a=this||self;function l(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function c(e,t,n){return e.call.apply(e.bind,arguments)}function u(e,t,n){return(u=c).apply(null,arguments)}function h(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}var f="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function p(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function m(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function g(e){a.setTimeout(()=>{throw e},0)}function y(){var e=S;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var v=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new b,e=>e.reset());class b{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let w,x=!1,S=new class{constructor(){this.h=this.g=null}add(e,t){const n=v.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},_=()=>{const e=Promise.resolve(void 0);w=()=>{e.then(E)}};function E(){for(var e;e=y();){try{e.h.call(e.g)}catch(n){g(n)}var t=v;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}x=!1}function T(){this.u=this.u,this.C=this.C}function k(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},k.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function C(e){return/^[\s\xa0]*$/.test(e)}function N(e,t){k.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}d(N,k),N.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&N.Z.h.call(this)},N.prototype.h=function(){N.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var A="closure_listenable_"+(1e6*Math.random()|0),D=0;function M(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++D,this.da=this.fa=!1}function O(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function P(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function L(e){const t={};for(const n in e)t[n]=e[n];return t}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<R.length;t++)n=R[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function F(e){this.src=e,this.g={},this.h=0}function V(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(O(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function z(e,t,n,r){for(let i=0;i<e.length;++i){const s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}F.prototype.add=function(e,t,n,r,i){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const o=z(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new M(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var U="closure_lm_"+(1e6*Math.random()|0),B={};function q(e,t,n,r,i){if(r&&r.once)return H(e,t,n,r,i);if(Array.isArray(t)){for(let s=0;s<t.length;s++)q(e,t[s],n,r,i);return null}return n=$(n),e&&e[A]?e.J(t,n,l(r)?!!r.capture:!!r,i):G(e,t,n,!1,r,i)}function G(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");const o=l(i)?!!i.capture:!!i;let a=Y(e);if(a||(e[U]=a=new F(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)I||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(W(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function H(e,t,n,r,i){if(Array.isArray(t)){for(let s=0;s<t.length;s++)H(e,t[s],n,r,i);return null}return n=$(n),e&&e[A]?e.K(t,n,l(r)?!!r.capture:!!r,i):G(e,t,n,!0,r,i)}function K(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)K(e,t[s],n,r,i);else r=l(r)?!!r.capture:!!r,n=$(n),e&&e[A]?(e=e.i,(s=String(t).toString())in e.g&&((n=z(t=e.g[s],n,r,i))>-1&&(O(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--)))):e&&(e=Y(e))&&(t=e.g[t.toString()],e=-1,t&&(e=z(t,n,r,i)),(n=e>-1?t[e]:null)&&Q(n))}function Q(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[A])V(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(W(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Y(t))?(V(n,e),0==n.h&&(n.src=null,t[U]=null)):O(e)}}}function W(e){return e in B?B[e]:B[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new N(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&Q(e),e=n.call(r,t)}return e}function Y(e){return(e=e[U])instanceof F?e:null}var J="__closure_events_fn_"+(1e9*Math.random()>>>0);function $(e){return"function"===typeof e?e:(e[J]||(e[J]=function(t){return e.handleEvent(t)}),e[J])}function Z(){T.call(this),this.i=new F(this),this.M=this,this.G=null}function ee(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new k(t,e);else if(t instanceof k)t.target=t.target||e;else{var i=t;j(t=new k(r,e),i)}let s,o;if(i=!0,n)for(o=n.length-1;o>=0;o--)s=t.g=n[o],i=te(s,r,!0,t)&&i;if(s=t.g=e,i=te(s,r,!0,t)&&i,i=te(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.g=n[o],i=te(s,r,!1,t)&&i}function te(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){const o=t[s];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&V(e.i,o),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ne(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=u(e.handleEvent,e)}return Number(t)>2147483647?-1:a.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ne(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(Z,T),Z.prototype[A]=!0,Z.prototype.removeEventListener=function(e,t,n,r){K(this,e,t,n,r)},Z.prototype.N=function(){if(Z.Z.N.call(this),this.i){var e=this.i;let t=0;for(const n in e.g){const r=e.g[n];for(let e=0;e<r.length;e++)++t,O(r[e]);delete e.g[n],e.h--}}this.G=null},Z.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Z.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class re extends T{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ne(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ie(e){T.call(this),this.h=e,this.g={}}d(ie,T);var se=[];function oe(e){P(e.g,function(e,t){this.g.hasOwnProperty(t)&&Q(e)},e),e.g={}}ie.prototype.N=function(){ie.Z.N.call(this),oe(this)},ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ae=a.JSON.stringify,le=a.JSON.parse,ce=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function ue(){}function he(){}var de={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fe(){k.call(this,"d")}function pe(){k.call(this,"c")}d(fe,k),d(pe,k);var me={},ge=null;function ye(){return ge=ge||new Z}function ve(e){k.call(this,me.Ia,e)}function be(e){const t=ye();ee(t,new ve(t,e))}function we(e,t){k.call(this,me.STAT_EVENT,e),this.stat=t}function xe(e){const t=ye();ee(t,new we(t,e))}function Se(e,t){k.call(this,me.Ja,e),this.size=t}function _e(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function Ee(){this.g=!0}function Te(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return ae(s)}catch(s){return t}}(e,n)+(r?" "+r:"")})}me.Ia="serverreachability",d(ve,k),me.STAT_EVENT="statevent",d(we,k),me.Ja="timingevent",d(Se,k),Ee.prototype.ua=function(){this.g=!1},Ee.prototype.info=function(){};var ke,Ie={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ce={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ne(){}function Ae(e){return encodeURIComponent(String(e))}function De(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Me(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ie(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Oe}function Oe(){this.i=null,this.g="",this.h=!1}d(Ne,ue),Ne.prototype.g=function(){return new XMLHttpRequest},ke=new Ne;var Pe={},Le={};function Re(e,t,n){e.M=1,e.A=at(nt(t)),e.u=n,e.R=!0,je(e,null)}function je(e,t){e.F=Date.now(),ze(e),e.B=nt(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),xt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Oe,e.g=ln(e.j,n?t:null,!e.u),e.P>0&&(e.O=new re(u(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(se[0]=i.toString()),i=se);for(let s=0;s<i.length;s++){const e=q(n,i[s],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?L(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),be(1),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s){var o="",a=s.split("&");for(let e=0;e<a.length;e++){var l=a[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+l+"&":o+(e+"=redacted&")}}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Fe(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Ve(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Le:(n=Number(t.substring(n,r)),isNaN(n)?Pe:(r+=1)+n>t.length?Le:(t=t.slice(r,r+n),e.C=r+n,t))}function ze(e){e.T=Date.now()+e.H,Ue(e,e.H)}function Ue(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=_e(u(e.aa,e),t)}function Be(e){e.D&&(a.clearTimeout(e.D),e.D=null)}function qe(e){0==e.j.I||e.K||nn(e.j,e)}function Ge(e){Be(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,oe(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function He(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||Ye(n.h,e)))if(!e.L&&Ye(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;tn(n),Ht(n)}$t(n),xe(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=_e(u(n.Va,n),6e3));Xe(n.h)<=1&&n.ta&&(n.ta=void 0)}else sn(n,11)}else if((e.L||n.g==e)&&tn(n),!C(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let c=i[t];const u=c[0];if(!(u<=n.K))if(n.K=u,c=c[1],2==n.I)if("c"==c[0]){n.M=c[1],n.ba=c[2];const t=c[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=c[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=c[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Je(s,s.h),s.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,ot(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=an(r,r.L?r.ba:null,r.W),o.L){$e(r.h,o);var a=o,l=r.O;l&&(a.H=l),a.D&&(Be(a),ze(a)),r.g=o}else Jt(r);n.i.length>0&&Qt(n)}else"stop"!=c[0]&&"close"!=c[0]||sn(n,7);else 3==n.I&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sn(n,7):Gt(n):"noop"!=c[0]&&n.l&&n.l.qa(c),n.A=0)}be(4)}catch(c){}}Me.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==zt(e)?t.j():this.Y(e)},Me.prototype.Y=function(e){try{if(e==this.g)e:{const l=zt(this.g),c=this.g.ya(),u=this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||Ut(this.g)))){this.K||4!=l||7==c||be(8==c||u<=0?3:2),Be(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Fe(e))return e.g.la();const t=Ut(e.g);if(""===t)return"";let n="";const r=t.length,i=4==zt(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return Ge(e),qe(e),"";e.h.i=new a.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(i&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(r)){var s=r;break t}}s=null}if(!(e=s)){this.o=!1,this.m=3,xe(12),Ge(this),qe(this);break e}Te(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,He(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Ve(this,n),t==Le){4==l&&(this.m=4,xe(14),e=!1),Te(this.i,this.l,null,"[Incomplete Response]");break}if(t==Pe){this.m=4,xe(15),Te(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Te(this.i,this.l,t,null),He(this,t)}if(Fe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,xe(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zt(o),o.P=!0,xe(11))}}else Te(this.i,this.l,n,"[Invalid Chunked Response]"),Ge(this),qe(this)}else Te(this.i,this.l,n,null),He(this,n);4==l&&Ge(this),this.o&&!this.K&&(4==l?nn(this.j,this):(this.o=!1,ze(this)))}else(function(e){const t={};e=(e.g&&zt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(C(e[r]))continue;var n=De(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,xe(12)):(this.m=0,xe(13)),Ge(this),qe(this)}}}catch(l){}},Me.prototype.cancel=function(){this.K=!0,Ge(this)},Me.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(be(3),xe(17)),Ge(this),this.m=2,qe(this)):Ue(this,this.T-e)};var Ke=class{constructor(e,t){this.g=e,this.map=t}};function Qe(e){this.l=e||10,a.PerformanceNavigationTiming?e=(e=a.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function We(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ye(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Je(e,t){e.g?e.g.add(t):e.h=t}function $e(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Ze(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return p(e.i)}Qe.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var et=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tt(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof tt?(this.l=e.l,rt(this,e.j),this.o=e.o,this.g=e.g,it(this,e.u),this.h=e.h,st(this,St(e.i)),this.m=e.m):e&&(t=String(e).match(et))?(this.l=!1,rt(this,t[1]||"",!0),this.o=lt(t[2]||""),this.g=lt(t[3]||"",!0),it(this,t[4]),this.h=lt(t[5]||"",!0),st(this,t[6]||"",!0),this.m=lt(t[7]||"")):(this.l=!1,this.i=new gt(null,this.l))}function nt(e){return new tt(e)}function rt(e,t,n){e.j=n?lt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function it(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function st(e,t,n){t instanceof gt?(e.i=t,function(e,t){t&&!e.j&&(yt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(vt(this,t),xt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=ct(t,pt)),e.i=new gt(t,e.l))}function ot(e,t,n){e.i.set(t,n)}function at(e){return ot(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function lt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ct(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ut),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ut(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}tt.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(ct(t,ht,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ct(t,ht,!0),"@"),e.push(Ae(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ct(n,"/"==n.charAt(0)?ft:dt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ct(n,mt)),e.join("")},tt.prototype.resolve=function(e){const t=nt(this);let n=!!e.j;n?rt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)it(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?st(t,St(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ht=/[#\/\?@]/g,dt=/[#\?:]/g,ft=/[#\?]/g,pt=/[#\?@]/g,mt=/#/g;function gt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function yt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,s=null;r>=0?(i=e[n].substring(0,r),s=e[n].substring(r+1)):i=e[n],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function vt(e,t){yt(e),t=_t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function bt(e,t){return yt(e),t=_t(e,t),e.g.has(t)}function wt(e,t){yt(e);let n=[];if("string"===typeof t)bt(e,t)&&(n=n.concat(e.g.get(_t(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function xt(e,t,n){vt(e,t),n.length>0&&(e.i=null,e.g.set(_t(e,t),p(n)),e.h+=n.length)}function St(e){const t=new gt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function _t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Et(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Tt(){this.g=new ce}function kt(e){this.i=e.Sb||null,this.h=e.ab||!1}function It(e,t){Z.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ct(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Nt(e){e.readyState=4,e.l=null,e.j=null,e.B=null,At(e)}function At(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Dt(e){let t="";return P(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Mt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Dt(n),"string"===typeof e?(Ae(t),null!=n&&Ae(n)):ot(e,t,n))}function Ot(e){Z.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(t=gt.prototype).add=function(e,t){yt(this),this.i=null,e=_t(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},t.forEach=function(e,t){yt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},t.set=function(e,t){return yt(this),this.i=null,bt(this,e=_t(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&(e=wt(this,e)).length>0?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ae(n);n=wt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ae(n[t])),e.push(r)}}return this.i=e.join("&")},d(kt,ue),kt.prototype.g=function(){return new It(this.i,this.h)},d(It,Z),(t=It.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,At(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||a).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Nt(this)),this.readyState=0},t.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,At(this)),this.g&&(this.readyState=3,At(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ct(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},t.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Nt(this):At(this),3==this.readyState&&Ct(this)}},t.Oa=function(e){this.g&&(this.response=this.responseText=e,Nt(this))},t.Na=function(e){this.g&&(this.response=e,Nt(this))},t.ga=function(){this.g&&Nt(this)},t.setRequestHeader=function(e,t){this.A.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(It.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Ot,Z);var Pt=/^https?$/i,Lt=["POST","PUT"];function Rt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,jt(e),Vt(e)}function jt(e){e.A||(e.A=!0,ee(e,"complete"),ee(e,"error"))}function Ft(e){if(e.h&&"undefined"!=typeof o)if(e.v&&4==zt(e))setTimeout(e.Ca.bind(e),0);else if(ee(e,"readystatechange"),4==zt(e)){e.h=!1;try{const o=e.ca();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){let t=String(e.D).match(et)[1]||null;!t&&a.self&&a.self.location&&(t=a.self.location.protocol.slice(0,-1)),r=!Pt.test(t?t.toLowerCase():"")}n=r}if(n)ee(e,"complete"),ee(e,"success");else{e.o=6;try{var i=zt(e)>2?e.g.statusText:""}catch(s){i=""}e.l=i+" ["+e.ca()+"]",jt(e)}}finally{Vt(e)}}}function Vt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||ee(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function zt(e){return e.g?e.g.readyState:0}function Ut(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Bt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function qt(e){this.za=0,this.i=[],this.j=new Ee,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bt("baseRetryDelayMs",5e3,e),this.Za=Bt("retryDelaySeedMs",1e4,e),this.Ta=Bt("forwardChannelMaxRetries",2,e),this.va=Bt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new Qe(e&&e.concurrentRequestLimit),this.Ba=new Tt,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Gt(e){if(Kt(e),3==e.I){var t=e.V++,n=nt(e.J);if(ot(n,"SID",e.M),ot(n,"RID",t),ot(n,"TYPE","terminate"),Xt(e,n),(t=new Me(e,e.j,t)).M=2,t.A=at(nt(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.A,n=!0),n||(t.g=ln(t.j,null),t.g.ea(t.A)),t.F=Date.now(),ze(t)}on(e)}function Ht(e){e.g&&(Zt(e),e.g.cancel(),e.g=null)}function Kt(e){Ht(e),e.v&&(a.clearTimeout(e.v),e.v=null),tn(e),e.h.cancel(),e.m&&("number"===typeof e.m&&a.clearTimeout(e.m),e.m=null)}function Qt(e){if(!We(e.h)&&!e.m){e.m=!0;var t=e.Ea;w||_(),x||(w(),x=!0),S.add(t,e),e.D=0}}function Wt(e,t){var n;n=t?t.l:e.V++;const r=nt(e.J);ot(r,"SID",e.M),ot(r,"RID",n),ot(r,"AID",e.K),Xt(e,r),e.u&&e.o&&Mt(r,e.u,e.o),n=new Me(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Yt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Je(e.h,n),Re(n,r,t)}function Xt(e,t){e.H&&P(e.H,function(e,n){ot(t,n,e)}),e.l&&P({},function(e,n){ot(t,n,e)})}function Yt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?u(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let c=!0;for(let u=0;u<n;u++){var s=i[u].g;const n=i[u].map;if((s-=t)<0)t=Math.max(0,i[u].g-100),c=!1;else try{s="req"+s+"_"||0;try{var o=n instanceof Map?n:Object.entries(n);for(const[t,n]of o){let r=n;l(n)&&(r=ae(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(a){throw e.push(s+"type="+encodeURIComponent("_badmap")),a}}catch(a){r&&r(n)}}if(c){o=e.join("&");break e}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Jt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;w||_(),x||(w(),x=!0),S.add(t,e),e.A=0}}function $t(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=_e(u(e.Da,e),rn(e,e.A)),e.A++,!0)}function Zt(e){null!=e.B&&(a.clearTimeout(e.B),e.B=null)}function en(e){e.g=new Me(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=nt(e.na);ot(t,"RID","rpc"),ot(t,"SID",e.M),ot(t,"AID",e.K),ot(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&ot(t,"TO",e.ia),ot(t,"TYPE","xmlhttp"),Xt(e,t),e.u&&e.o&&Mt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=at(nt(t)),n.u=null,n.R=!0,je(n,e)}function tn(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function nn(e,t){var n=null;if(e.g==t){tn(e),Zt(e),e.g=null;var r=2}else{if(!Ye(e.h,t))return;n=t.G,$e(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;ee(r=ye(),new Se(r,n,t,i)),Qt(e)}else Jt(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=_e(u(e.Ea,e,t),rn(e,e.D)),e.D++,!0))}(e,t)||2==r&&$t(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:sn(e,5);break;case 4:sn(e,10);break;case 3:sn(e,6);break;default:sn(e,2)}}function rn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function sn(e,t){if(e.j.info("Error code "+t),2==t){var n=u(e.bb,e),r=e.Ua;const t=!r;r=new tt(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||rt(r,"https"),at(r),t?function(e,t){const n=new Ee;if(a.Image){const r=new Image;r.onload=h(Et,n,"TestLoadImage: loaded",!0,t,r),r.onerror=h(Et,n,"TestLoadImage: error",!1,t,r),r.onabort=h(Et,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=h(Et,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ee;const n=new AbortController,r=setTimeout(()=>{n.abort(),Et(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Et(0,0,!0,t):Et(0,0,!1,t)}).catch(()=>{clearTimeout(r),Et(0,0,!1,t)})}(r.toString(),n)}else xe(2);e.I=0,e.l&&e.l.pa(t),on(e),Kt(e)}function on(e){if(e.I=0,e.ja=[],e.l){const t=Ze(e.h);0==t.length&&0==e.i.length||(m(e.ja,t),m(e.ja,e.i),e.h.i.length=0,p(e.i),e.i.length=0),e.l.oa()}}function an(e,t,n){var r=n instanceof tt?nt(n):new tt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),it(r,r.u);else{var i=a.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new tt(null);r&&rt(e,r),t&&(e.g=t),i&&it(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&ot(r,n,t),ot(r,"VER",e.ka),Xt(e,r),r}function ln(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Ot(new kt({ab:n})):new Ot(e.ma)).Fa(e.L),t}function cn(){}function un(){}function hn(e,t){Z.call(this),this.g=new qt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!C(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!C(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new pn(this)}function dn(e){fe.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function fn(){pe.call(this),this.status=1}function pn(e){this.g=e}(t=Ot.prototype).Fa=function(e){this.H=e},t.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ke.g(),this.g.onreadystatechange=f(u(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Rt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=a.FormData&&e instanceof a.FormData,!(Array.prototype.indexOf.call(Lt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(s){Rt(this,s)}},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,ee(this,"complete"),ee(this,"abort"),Vt(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vt(this,!0)),Ot.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Ft(this):this.Xa())},t.Xa=function(){Ft(this)},t.isActive=function(){return!!this.g},t.ca=function(){try{return zt(this)>2?this.g.status:-1}catch(e){return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),le(t)}},t.ya=function(){return this.o},t.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(t=qt.prototype).ka=8,t.I=1,t.connect=function(e,t,n,r){xe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=an(this,null,this.W),Qt(this)},t.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new Me(this,this.j,e);let s=this.o;if(this.U&&(s?(s=L(s),j(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Yt(this,i,t),ot(n=nt(this.J),"RID",e),ot(n,"CVER",22),this.G&&ot(n,"X-HTTP-Session-Id",this.G),Xt(this,n),s&&(this.R?t="headers="+Ae(Dt(s))+"&"+t:this.u&&Mt(n,this.u,s)),Je(this.h,i),this.Ra&&ot(n,"TYPE","init"),this.S?(ot(n,"$req",t),ot(n,"SID","null"),i.U=!0,Re(i,n,null)):Re(i,n,t),this.I=2}}else 3==this.I&&(e?Wt(this,e):0==this.i.length||We(this.h)||Wt(this))},t.Da=function(){if(this.v=null,en(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=_e(u(this.Wa,this),e)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xe(10),Ht(this),en(this))},t.Va=function(){null!=this.C&&(this.C=null,Ht(this),$t(this),xe(19))},t.bb=function(e){e?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=cn.prototype).ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){},un.prototype.g=function(e,t){return new hn(e,t)},d(hn,Z),hn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},hn.prototype.close=function(){Gt(this.g)},hn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ae(e),e=n);t.i.push(new Ke(t.Ya++,e)),3==t.I&&Qt(t)},hn.prototype.N=function(){this.g.l=null,delete this.j,Gt(this.g),delete this.g,hn.Z.N.call(this)},d(dn,fe),d(fn,pe),d(pn,cn),pn.prototype.ra=function(){ee(this.g,"a")},pn.prototype.qa=function(e){ee(this.g,new dn(e))},pn.prototype.pa=function(e){ee(this.g,new fn(e))},pn.prototype.oa=function(){ee(this.g,"b")},un.prototype.createWebChannel=un.prototype.g,hn.prototype.send=hn.prototype.o,hn.prototype.open=hn.prototype.m,hn.prototype.close=hn.prototype.close,e.exports.createWebChannelTransport=function(){return new un},e.exports.getStatEventTarget=function(){return ye()},e.exports.Event=me,e.exports.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,e.exports.ErrorCode=Ie,Ce.COMPLETE="complete",e.exports.EventType=Ce,he.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",Z.prototype.listen=Z.prototype.J,e.exports.WebChannel=he,e.exports.FetchXmlHttpFactory=kt,Ot.prototype.listenOnce=Ot.prototype.K,Ot.prototype.getLastError=Ot.prototype.Ha,Ot.prototype.getLastErrorCode=Ot.prototype.ya,Ot.prototype.getStatus=Ot.prototype.ca,Ot.prototype.getResponseJson=Ot.prototype.La,Ot.prototype.getResponseText=Ot.prototype.la,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Fa,e.exports.XhrIo=Ot}).apply("undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},799:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteDB:()=>v,openDB:()=>y,unwrap:()=>g,wrap:()=>m});var r=n(555);const i=(e,t)=>t.some(t=>e instanceof t);let s,o;const a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return l.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(g(this),n),m(a.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(e.apply(g(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(g(this),t,...r);return c.set(s,t.sort?t.sort():[t]),m(s)}}function p(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(l.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});l.set(e,t)}(e),i(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function m(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(m(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&a.set(t,e)}).catch(()=>{}),h.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=p(e);return t!==e&&(u.set(e,t),h.set(t,e)),t}const g=e=>h.get(e);function y(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=m(o);return r&&o.addEventListener("upgradeneeded",e=>{r(m(o.result),e.oldVersion,e.newVersion,m(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}function v(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),m(n).then(()=>{})}const b=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],x=new Map;function S(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(x.get(t))return x.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!b.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return x.set(t,s),s}d=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>S(t,n)||e.get(t,n,r),has:(t,n)=>!!S(t,n)||e.has(t,n)}))(d)},853:(e,t,n)=>{"use strict";e.exports=n(896)},858:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(679);const i="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.Deferred;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===i?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}t.Component=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},t.ComponentContainer=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},t.Provider=s},887:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=[];var r;t.LogLevel=void 0,(r=t.LogLevel||(t.LogLevel={}))[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT";const i={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},s=t.LogLevel.INFO,o={[t.LogLevel.DEBUG]:"log",[t.LogLevel.VERBOSE]:"log",[t.LogLevel.INFO]:"info",[t.LogLevel.WARN]:"warn",[t.LogLevel.ERROR]:"error"},a=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};t.Logger=class{constructor(e){this.name=e,this._logLevel=s,this._logHandler=a,this._userLogHandler=null,n.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.DEBUG,...n),this._logHandler(this,t.LogLevel.DEBUG,...n)}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.VERBOSE,...n),this._logHandler(this,t.LogLevel.VERBOSE,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.INFO,...n),this._logHandler(this,t.LogLevel.INFO,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.WARN,...n),this._logHandler(this,t.LogLevel.WARN,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.ERROR,...n),this._logHandler(this,t.LogLevel.ERROR,...n)}},t.setLogLevel=function(e){n.forEach(t=>{t.setLogLevel(e)})},t.setUserLogHandler=function(e,r){for(const s of n){let n=null;r&&r.level&&(n=i[r.level]),s.userLogHandler=null===e?null:function(r,i){for(var s=arguments.length,o=new Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];const l=o.map(e=>{if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(e=>e).join(" ");i>=(null!==n&&void 0!==n?n:r.logLevel)&&e({level:t.LogLevel[i].toLowerCase(),message:l,args:o,type:r.name})}}}},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,x(e),!m)if(null!==r(c))m=!0,E||(E=!0,_());else{var t=r(u);null!==t&&M(S,t.startTime-e)}}var _,E=!1,T=-1,k=5,I=-1;function C(){return!!y||!(t.unstable_now()-I<k)}function N(){if(y=!1,E){var e=t.unstable_now();I=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(T),T=-1),p=!0;var s=f;try{t:{for(x(e),d=r(c);null!==d&&!(d.expirationTime>e&&C());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){d.callback=a,x(e),n=!0;break t}d===r(c)&&i(c),x(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&M(S,l.startTime-e),n=!1}}break e}finally{d=null,f=s,p=!1}n=void 0}}finally{n?_():E=!1}}}if("function"===typeof w)_=function(){w(N)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=N,_=function(){D.postMessage(null)}}else _=function(){v(N,0)};function M(e,n){T=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(b(T),T=-1):g=!0,M(S,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,E||(E=!0,_()))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},897:(e,t,n)=>{var r=n(693);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)},968:(e,t,n)=>{"use strict";var r=n(897).default;Object.defineProperty(t,"__esModule",{value:!0});var i=n(98),s=n(858),o=n(887),a=n(679),l=n(193),c=n(761);const u="@firebase/firestore",h="4.9.2";class d{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}d.UNAUTHENTICATED=new d(null),d.GOOGLE_CREDENTIALS=new d("google-credentials-uid"),d.FIRST_PARTY=new d("first-party-uid"),d.MOCK_USER=new d("mock-user");let f="12.3.0";const p=new o.Logger("@firebase/firestore");function m(){return p.logLevel}function g(e){if(p.logLevel<=o.LogLevel.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(b);p.debug("Firestore (".concat(f,"): ").concat(e),...i)}}function y(e){if(p.logLevel<=o.LogLevel.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(b);p.error("Firestore (".concat(f,"): ").concat(e),...i)}}function v(e){if(p.logLevel<=o.LogLevel.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(b);p.warn("Firestore (".concat(f,"): ").concat(e),...i)}}function b(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function w(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,x(e,r,n)}function x(e,t,n){let r="FIRESTORE (".concat(f,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw y(r),new Error(r)}function S(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||x(t,i,r)}function _(e,t){return e}const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class T extends a.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class k{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class I{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class C{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(d.UNAUTHENTICATED))}shutdown(){}}class N{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class A{constructor(e){this.t=e,this.currentUser=d.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){S(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new k;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new k,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{g("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(g("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new k)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(g("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(S("string"==typeof t.accessToken,31837,{l:t}),new I(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return S(null===e||"string"==typeof e,2055,{h:e}),new d(e)}}class D{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=d.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class M{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new D(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(d.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,i._isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){S(void 0===this.o,3512);const n=e=>{null!=e.error&&g("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,g("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{g("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):g("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new O(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(S("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new O(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function L(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class R{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=L(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function j(e,t){return e<t?-1:e>t?1:0}function F(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return U(n)===U(i)?j(n,i):U(n)?1:-1}return j(e.length,t.length)}const V=55296,z=57343;function U(e){const t=e.charCodeAt(0);return t>=V&&t<=z}function B(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function q(e){return e+"\0"}const G="__name__";class H{constructor(e,t,n){void 0===t?t=0:t>e.length&&w(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&w(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===H.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof H?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=H.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return j(e.length,t.length)}static compareSegments(e,t){const n=H.isNumericId(e),r=H.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?H.extractNumericId(e).compare(H.extractNumericId(t)):F(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return l.Integer.fromString(e.substring(4,e.length-2))}}class K extends H{construct(e,t,n){return new K(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new T(E.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new K(e)}static emptyPath(){return new K([])}}const Q=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class W extends H{construct(e,t,n){return new W(e,t,n)}static isValidIdentifier(e){return Q.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),W.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===G}static keyField(){return new W([G])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new T(E.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new T(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new T(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new T(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new W(t)}static emptyPath(){return new W([])}}class X{constructor(e){this.path=e}static fromPath(e){return new X(K.fromString(e))}static fromName(e){return new X(K.fromString(e).popFirst(5))}static empty(){return new X(K.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===K.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return K.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new K(e.slice()))}}function Y(e,t,n){if(!n)throw new T(E.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function J(e,t,n,r){if(!0===t&&!0===r)throw new T(E.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function $(e){if(!X.isDocumentKey(e))throw new T(E.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Z(e){if(X.isDocumentKey(e))throw new T(E.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ee(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function te(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":w(12329,{type:typeof e})}function ne(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new T(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=te(e);throw new T(E.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function re(e,t){if(t<=0)throw new T(E.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function ie(e,t){const n={typeString:e};return t&&(n.value=t),n}function se(e,t){if(!ee(e))throw new T(E.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const o=e[r];if(i&&typeof o!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==s&&o!==s.value){n="Expected '".concat(r,"' field to equal '").concat(s.value,"'");break}}if(n)throw new T(E.INVALID_ARGUMENT,n);return!0}const oe=-62135596800,ae=1e6;class le{static now(){return le.fromMillis(Date.now())}static fromDate(e){return le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ae);return new le(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new T(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new T(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oe)throw new T(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new T(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ae}_compareTo(e){return this.seconds===e.seconds?j(this.nanoseconds,e.nanoseconds):j(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:le._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(se(e,le._jsonSchema))return new le(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-oe;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}le._jsonSchemaVersion="firestore/timestamp/1.0",le._jsonSchema={type:ie("string",le._jsonSchemaVersion),seconds:ie("number"),nanoseconds:ie("number")};class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new le(0,0))}static max(){return new ce(new le(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ue=-1;class he{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function de(e){return e.fields.find(e=>2===e.kind)}function fe(e){return e.fields.filter(e=>2!==e.kind)}function pe(e,t){let n=j(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(n=ge(e.fields[r],t.fields[r]),0!==n)return n;return j(e.fields.length,t.fields.length)}he.UNKNOWN_ID=-1;class me{constructor(e,t){this.fieldPath=e,this.kind=t}}function ge(e,t){const n=W.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:j(e.kind,t.kind)}class ye{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ye(0,we.min())}}function ve(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ce.fromTimestamp(1e9===r?new le(n+1,0):new le(n,r));return new we(i,X.empty(),t)}function be(e){return new we(e.readTime,e.key,ue)}class we{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new we(ce.min(),X.empty(),ue)}static max(){return new we(ce.max(),X.empty(),ue)}}function xe(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=X.comparator(e.documentKey,t.documentKey),0!==n?n:j(e.largestBatchId,t.largestBatchId))}const Se="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _e{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ee(e){if(e.code!==E.FAILED_PRECONDITION||e.message!==Se)throw e;g("LocalStore","Unexpectedly lost primary lease")}class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&w(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Te((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Te?t:Te.resolve(t)}catch(e){return Te.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Te.reject(t)}static resolve(e){return new Te((t,n)=>{t(e)})}static reject(e){return new Te((t,n)=>{n(e)})}static waitFor(e){return new Te((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Te.resolve(!1);for(const n of e)t=t.next(e=>e?Te.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Te((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Te((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}const ke="SimpleDb";class Ie{static open(e,t,n,r){try{return new Ie(t,e.transaction(r,n))}catch(e){throw new De(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new k,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new De(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const n=Re(t.target.error);this.S.reject(new De(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(g(ke,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Oe(t)}}class Ce{static delete(e){return g(ke,"Removing database:",e),Pe(a.getGlobal().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!a.isIndexedDBAvailable())return!1;if(Ce.F())return!0;const e=a.getUA(),t=Ce.M(e),n=0<t&&t<10,r=Ne(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,12.2===Ce.M(a.getUA())&&y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(g(ke,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new De(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new T(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new T(E.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new De(e,r))},r.onupgradeneeded=e=>{g(ke,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.N.k(t,r.transaction,e.oldVersion,this.version).next(()=>{g(ke,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=e=>this.q(e)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.L(e);const t=Ie.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),Te.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(g(ke,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ne(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Ae{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Pe(this.U.delete())}}class De extends T{constructor(e,t){super(E.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(t)),this.name="IndexedDbTransactionError"}}function Me(e){return"IndexedDbTransactionError"===e.name}class Oe{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(g(ke,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(g(ke,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Pe(n)}add(e){return g(ke,"ADD",this.store.name,e,e),Pe(this.store.add(e))}get(e){return Pe(this.store.get(e)).next(t=>(void 0===t&&(t=null),g(ke,"GET",this.store.name,e,t),t))}delete(e){return g(ke,"DELETE",this.store.name,e),Pe(this.store.delete(e))}count(){return g(ke,"COUNT",this.store.name),Pe(this.store.count())}J(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Te((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(n),t=[];return this.H(e,(e,n)=>{t.push(n)}).next(()=>t)}}Y(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Te((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}Z(e,t){g(ke,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const r=this.cursor(n);return this.H(r,(e,t,n)=>n.delete())}ee(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.H(r,t)}te(e){const t=this.cursor({});return new Te((n,r)=>{t.onerror=e=>{const t=Re(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}H(e,t){const n=[];return new Te((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new Ae(i),o=t(i.primaryKey,i.value,s);if(o instanceof Te){const e=o.catch(e=>(s.done(),Te.reject(e)));n.push(e)}s.isDone?r():null===s.G?i.continue():i.continue(s.G)}}).next(()=>Te.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Pe(e){return new Te((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Re(e.target.error);n(t)}})}let Le=!1;function Re(e){const t=Ce.M(a.getUA());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new T("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(t,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Le||(Le=!0,setTimeout(()=>{throw e},0)),e}}return e}const je="IndexBackfiller";class Fe{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){g(je,"Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const e=await this.ne.ie();g(je,"Documents written: ".concat(e))}catch(e){Me(e)?g(je,"Ignoring IndexedDB error during index backfill: ",e):await Ee(e)}await this.re(6e4)})}}class Ve{constructor(e,t){this.localStore=e,this.persistence=t}async ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const n=new Set;let r=t,i=!0;return Te.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return g(je,"Processing collection: ".concat(t)),this.oe(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this._e(r,n)).next(n=>(g(je,"Updating offset: ".concat(n)),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}_e(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=be(t);xe(r,n)>0&&(n=r)}),new we(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ze{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ze.ce=-1;const Ue=-1;function Be(e){return null==e}function qe(e){return 0===e&&1/e==-1/0}function Ge(e){return"number"==typeof e&&Number.isInteger(e)&&!qe(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const He="\x01";function Ke(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=We(t)),t=Qe(e.get(n),t);return We(t)}function Qe(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case He:n+="\x01\x11";break;default:n+=t}}return n}function We(e){return e+He+"\x01"}function Xe(e){const t=e.length;if(S(t>=2,64408,{path:e}),2===t)return S(e.charAt(0)===He&&"\x01"===e.charAt(1),56145,{path:e}),K.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf(He,s);switch((t<0||t>n)&&w(50515,{path:e}),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:w(61167,{path:e})}s=t+2}return new K(r)}const Ye="remoteDocuments",Je="owner",$e="owner",Ze="mutationQueues",et="mutations",tt="batchId",nt="userMutationsIndex",rt=["userId","batchId"];function it(e,t){return[e,Ke(t)]}function st(e,t,n){return[e,Ke(t),n]}const ot={},at="documentMutations",lt="remoteDocumentsV14",ct=["prefixPath","collectionGroup","readTime","documentId"],ut="documentKeyIndex",ht=["prefixPath","collectionGroup","documentId"],dt="collectionGroupIndex",ft=["collectionGroup","readTime","prefixPath","documentId"],pt="remoteDocumentGlobal",mt="remoteDocumentGlobalKey",gt="targets",yt="queryTargetsIndex",vt=["canonicalId","targetId"],bt="targetDocuments",wt=["targetId","path"],xt="documentTargetsIndex",St=["path","targetId"],_t="targetGlobalKey",Et="targetGlobal",Tt="collectionParents",kt=["collectionId","parent"],It="clientMetadata",Ct="bundles",Nt="namedQueries",At="indexConfiguration",Dt="collectionGroupIndex",Mt="indexState",Ot=["indexId","uid"],Pt="sequenceNumberIndex",Lt=["uid","sequenceNumber"],Rt="indexEntries",jt=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ft="documentKeyIndex",Vt=["indexId","uid","orderedDocumentKey"],zt="documentOverlays",Ut=["userId","collectionPath","documentId"],Bt="collectionPathOverlayIndex",qt=["userId","collectionPath","largestBatchId"],Gt="collectionGroupOverlayIndex",Ht=["userId","collectionGroup","largestBatchId"],Kt="globals",Qt=[Ze,et,at,Ye,gt,Je,Et,bt,It,pt,Tt,Ct,Nt],Wt=[...Qt,zt],Xt=[Ze,et,at,lt,gt,Je,Et,bt,It,pt,Tt,Ct,Nt,zt],Yt=Xt,Jt=[...Yt,At,Mt,Rt],$t=Jt,Zt=[...Jt,Kt],en=Zt;class tn extends _e{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function nn(e,t){const n=_(e);return Ce.O(n.le,t)}function rn(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function sn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function on(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r,e));return n}function an(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ln{constructor(e,t){this.comparator=e,this.root=t||un.EMPTY}insert(e,t){return new ln(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new ln(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cn(this.root,e,this.comparator,!1)}getReverseIterator(){return new cn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cn(this.root,e,this.comparator,!0)}}class cn{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:un.RED,this.left=null!=r?r:un.EMPTY,this.right=null!=i?i:un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new un(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return un.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw w(43730,{key:this.key,value:this.value});if(this.right.isRed())throw w(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw w(27949);return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1,un.EMPTY=new class{constructor(){this.size=0}get key(){throw w(57766)}get value(){throw w(16141)}get color(){throw w(16727)}get left(){throw w(29726)}get right(){throw w(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hn{constructor(e){this.comparator=e,this.data=new ln(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dn(this.data.getIterator())}getIteratorFrom(e){return new dn(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof hn))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new hn(this.comparator);return t.data=e,t}}class dn{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fn(e){return e.hasNext()?e.getNext():void 0}class pn{constructor(e){this.fields=e,e.sort(W.comparator)}static empty(){return new pn([])}unionWith(e){let t=new hn(W.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return B(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class mn extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class gn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new mn("Invalid base64 string: "+e):e}}(e);return new gn(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new gn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return j(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gn.EMPTY_BYTE_STRING=new gn("");const yn=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vn(e){if(S(!!e,39018),"string"==typeof e){let t=0;const n=yn.exec(e);if(S(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:bn(e.seconds),nanos:bn(e.nanos)}}function bn(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function wn(e){return"string"==typeof e?gn.fromBase64String(e):gn.fromUint8Array(e)}const xn="server_timestamp",Sn="__type__",_n="__previous_value__",En="__local_write_time__";function Tn(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Sn])||void 0===t?void 0:t.stringValue)===xn}function kn(e){const t=e.mapValue.fields[_n];return Tn(t)?kn(t):t}function In(e){const t=vn(e.mapValue.fields[En].timestampValue);return new le(t.seconds,t.nanos)}class Cn{constructor(e,t,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const Nn="(default)";class An{constructor(e,t){this.projectId=e,this.database=t||Nn}static empty(){return new An("","")}get isDefaultDatabase(){return this.database===Nn}isEqual(e){return e instanceof An&&e.projectId===this.projectId&&e.database===this.database}}const Dn="__type__",Mn="__max__",On={mapValue:{fields:{__type__:{stringValue:Mn}}}},Pn="__vector__",Ln="value",Rn={nullValue:"NULL_VALUE"};function jn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Tn(e)?4:er(e)?9007199254740991:$n(e)?10:11:w(28295,{value:e})}function Fn(e,t){if(e===t)return!0;const n=jn(e);if(n!==jn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return In(e).isEqual(In(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=vn(e.timestampValue),r=vn(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return wn(e.bytesValue).isEqual(wn(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return bn(e.geoPointValue.latitude)===bn(t.geoPointValue.latitude)&&bn(e.geoPointValue.longitude)===bn(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return bn(e.integerValue)===bn(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=bn(e.doubleValue),r=bn(t.doubleValue);return n===r?qe(n)===qe(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return B(e.arrayValue.values||[],t.arrayValue.values||[],Fn);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(rn(n)!==rn(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Fn(n[i],r[i])))return!1;return!0}(e,t);default:return w(52216,{left:e})}}function Vn(e,t){return void 0!==(e.values||[]).find(e=>Fn(e,t))}function zn(e,t){if(e===t)return 0;const n=jn(e),r=jn(t);if(n!==r)return j(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return j(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=bn(e.integerValue||e.doubleValue),r=bn(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Un(e.timestampValue,t.timestampValue);case 4:return Un(In(e),In(t));case 5:return F(e.stringValue,t.stringValue);case 6:return function(e,t){const n=wn(e),r=wn(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=j(n[i],r[i]);if(0!==e)return e}return j(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=j(bn(e.latitude),bn(t.latitude));return 0!==n?n:j(bn(e.longitude),bn(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Bn(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o[Ln])||void 0===n?void 0:n.arrayValue,c=null===(r=a[Ln])||void 0===r?void 0:r.arrayValue,u=j((null===l||void 0===l||null===(i=l.values)||void 0===i?void 0:i.length)||0,(null===c||void 0===c||null===(s=c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Bn(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===On.mapValue&&t===On.mapValue)return 0;if(e===On.mapValue)return 1;if(t===On.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=F(r[o],s[o]);if(0!==e)return e;const t=zn(n[r[o]],i[s[o]]);if(0!==t)return t}return j(r.length,s.length)}(e.mapValue,t.mapValue);default:throw w(23264,{he:n})}}function Un(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return j(e,t);const n=vn(e),r=vn(t),i=j(n.seconds,r.seconds);return 0!==i?i:j(n.nanos,r.nanos)}function Bn(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=zn(n[i],r[i]);if(e)return e}return j(n.length,r.length)}function qn(e){return Gn(e)}function Gn(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=vn(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return wn(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return X.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Gn(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Gn(e.fields[i]));return n+"}"}(e.mapValue):w(61005,{value:e})}function Hn(e){switch(jn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=kn(e);return t?16+Hn(t):16;case 5:return 2*e.stringValue.length;case 6:return wn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Hn(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return sn(e.fields,(e,n)=>{t+=e.length+Hn(n)}),t}(e.mapValue);default:throw w(13486,{value:e})}}function Kn(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Qn(e){return!!e&&"integerValue"in e}function Wn(e){return!!e&&"arrayValue"in e}function Xn(e){return!!e&&"nullValue"in e}function Yn(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Jn(e){return!!e&&"mapValue"in e}function $n(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Dn])||void 0===t?void 0:t.stringValue)===Pn}function Zn(e){if(e.geoPointValue)return{geoPointValue:r({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:r({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return sn(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Zn(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Zn(e.arrayValue.values[n]);return t}return r({},e)}function er(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Mn}const tr={mapValue:{fields:{[Dn]:{stringValue:Pn},[Ln]:{arrayValue:{}}}}};function nr(e){return"nullValue"in e?Rn:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Kn(An.empty(),X.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?$n(e)?tr:{mapValue:{}}:w(35942,{value:e})}function rr(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Kn(An.empty(),X.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?tr:"mapValue"in e?$n(e)?{mapValue:{}}:On:w(61959,{value:e})}function ir(e,t){const n=zn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function sr(e,t){const n=zn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class or{constructor(e){this.value=e}static empty(){return new or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Jn(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zn(t)}setAll(e){let t=W.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Zn(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Jn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Jn(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){sn(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new or(Zn(this.value))}}function ar(e){const t=[];return sn(e.fields,(e,n)=>{const r=new W([e]);if(Jn(n)){const e=ar(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new pn(t)}class lr{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new lr(e,0,ce.min(),ce.min(),ce.min(),or.empty(),0)}static newFoundDocument(e,t,n,r){return new lr(e,1,t,ce.min(),n,r,0)}static newNoDocument(e,t){return new lr(e,2,t,ce.min(),ce.min(),or.empty(),0)}static newUnknownDocument(e,t){return new lr(e,3,t,ce.min(),ce.min(),or.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ce.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class cr{constructor(e,t){this.position=e,this.inclusive=t}}function ur(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?X.comparator(X.fromName(o.referenceValue),n.key):zn(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function hr(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Fn(e.position[n],t.position[n]))return!1;return!0}class dr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function fr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class pr{}class mr extends pr{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Tr(e,t,n):"array-contains"===t?new Nr(e,n):"in"===t?new Ar(e,n):"not-in"===t?new Dr(e,n):"array-contains-any"===t?new Mr(e,n):new mr(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new kr(e,n):new Ir(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(zn(t,this.value)):null!==t&&jn(this.value)===jn(t)&&this.matchesComparison(zn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return w(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gr extends pr{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gr(e,t)}matches(e){return yr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function yr(e){return"and"===e.op}function vr(e){return"or"===e.op}function br(e){return wr(e)&&yr(e)}function wr(e){for(const t of e.filters)if(t instanceof gr)return!1;return!0}function xr(e){if(e instanceof mr)return e.field.canonicalString()+e.op.toString()+qn(e.value);if(br(e))return e.filters.map(e=>xr(e)).join(",");{const t=e.filters.map(e=>xr(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Sr(e,t){return e instanceof mr?function(e,t){return t instanceof mr&&e.op===t.op&&e.field.isEqual(t.field)&&Fn(e.value,t.value)}(e,t):e instanceof gr?function(e,t){return t instanceof gr&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Sr(n,t.filters[r]),!0)}(e,t):void w(19439)}function _r(e,t){const n=e.filters.concat(t);return gr.create(n,e.op)}function Er(e){return e instanceof mr?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(qn(e.value))}(e):e instanceof gr?function(e){return e.op.toString()+" {"+e.getFilters().map(Er).join(" ,")+"}"}(e):"Filter"}class Tr extends mr{constructor(e,t,n){super(e,t,n),this.key=X.fromName(n.referenceValue)}matches(e){const t=X.comparator(e.key,this.key);return this.matchesComparison(t)}}class kr extends mr{constructor(e,t){super(e,"in",t),this.keys=Cr("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ir extends mr{constructor(e,t){super(e,"not-in",t),this.keys=Cr("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Cr(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>X.fromName(e.referenceValue))}class Nr extends mr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wn(t)&&Vn(t.arrayValue,this.value)}}class Ar extends mr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Vn(this.value.arrayValue,t)}}class Dr extends mr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Vn(this.value.arrayValue,t)}}class Mr extends mr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wn(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Vn(this.value.arrayValue,e))}}class Or{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Te=null}}function Pr(e){return new Or(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Lr(e){const t=_(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>xr(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Be(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>qn(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>qn(e)).join(",")),t.Te=e}return t.Te}function Rr(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!fr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Sr(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!hr(e.startAt,t.startAt)&&hr(e.endAt,t.endAt)}function jr(e){return X.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Fr(e,t){return e.filters.filter(e=>e instanceof mr&&e.field.isEqual(t))}function Vr(e,t,n){let r=Rn,i=!0;for(const s of Fr(e,t)){let e=Rn,t=!0;switch(s.op){case"<":case"<=":e=nr(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Rn}ir({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];ir({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function zr(e,t,n){let r=On,i=!0;for(const s of Fr(e,t)){let e=On,t=!0;switch(s.op){case">=":case">":e=rr(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=On}sr({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];sr({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Ur{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Br(e,t,n,r,i,s,o,a){return new Ur(e,t,n,r,i,s,o,a)}function qr(e){return new Ur(e)}function Gr(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Hr(e){return null!==e.collectionGroup}function Kr(e){const t=_(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new hn(W.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new dr(r,n))}),e.has(W.keyField().canonicalString())||t.Ie.push(new dr(W.keyField(),n))}return t.Ie}function Qr(e){const t=_(e);return t.Ee||(t.Ee=Xr(t,Kr(e))),t.Ee}function Wr(e){const t=_(e);return t.de||(t.de=Xr(t,e.explicitOrderBy)),t.de}function Xr(e,t){if("F"===e.limitType)return Pr(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new dr(e.field,t)});const n=e.endAt?new cr(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new cr(e.startAt.position,e.startAt.inclusive):null;return Pr(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Yr(e,t){const n=e.filters.concat([t]);return new Ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Jr(e,t,n){return new Ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function $r(e,t){return Rr(Qr(e),Qr(t))&&e.limitType===t.limitType}function Zr(e){return"".concat(Lr(Qr(e)),"|lt:").concat(e.limitType)}function ei(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Er(e)).join(", "),"]")),Be(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>qn(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>qn(e)).join(",")),"Target(".concat(t,")")}(Qr(e)),"; limitType=").concat(e.limitType,")")}function ti(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):X.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Kr(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ur(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Kr(e),t))&&!(e.endAt&&!function(e,t,n){const r=ur(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Kr(e),t))}(e,t)}function ni(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ri(e){return(t,n)=>{let r=!1;for(const i of Kr(e)){const e=ii(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function ii(e,t,n){const r=e.field.isKeyField()?X.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?zn(r,i):w(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return w(19790,{direction:e.dir})}}class si{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){sn(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return an(this.inner)}size(){return this.innerSize}}const oi=new ln(X.comparator);function ai(){return oi}const li=new ln(X.comparator);function ci(){let e=li;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function ui(e){let t=li;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function hi(){return fi()}function di(){return fi()}function fi(){return new si(e=>e.toString(),(e,t)=>e.isEqual(t))}const pi=new ln(X.comparator),mi=new hn(X.comparator);function gi(){let e=mi;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const yi=new hn(j);function vi(){return yi}function bi(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qe(t)?"-0":t}}function wi(e){return{integerValue:""+e}}function xi(e,t){return Ge(t)?wi(t):bi(e,t)}class Si{constructor(){this._=void 0}}function _i(e,t,n){return e instanceof ki?function(e,t){const n={fields:{[Sn]:{stringValue:xn},[En]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Tn(t)&&(t=kn(t)),t&&(n.fields[_n]=t),{mapValue:n}}(n,t):e instanceof Ii?Ci(e,t):e instanceof Ni?Ai(e,t):function(e,t){const n=Ti(e,t),r=Mi(n)+Mi(e.Ae);return Qn(n)&&Qn(e.Ae)?wi(r):bi(e.serializer,r)}(e,t)}function Ei(e,t,n){return e instanceof Ii?Ci(e,t):e instanceof Ni?Ai(e,t):n}function Ti(e,t){return e instanceof Di?function(e){return Qn(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class ki extends Si{}class Ii extends Si{constructor(e){super(),this.elements=e}}function Ci(e,t){const n=Oi(t);for(const r of e.elements)n.some(e=>Fn(e,r))||n.push(r);return{arrayValue:{values:n}}}class Ni extends Si{constructor(e){super(),this.elements=e}}function Ai(e,t){let n=Oi(t);for(const r of e.elements)n=n.filter(e=>!Fn(e,r));return{arrayValue:{values:n}}}class Di extends Si{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Mi(e){return bn(e.integerValue||e.doubleValue)}function Oi(e){return Wn(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Pi{constructor(e,t){this.field=e,this.transform=t}}class Li{constructor(e,t){this.version=e,this.transformResults=t}}class Ri{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ri}static exists(e){return new Ri(void 0,e)}static updateTime(e){return new Ri(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ji(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Fi{}function Vi(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Xi(e.key,Ri.none()):new Gi(e.key,e.data,Ri.none());{const n=e.data,r=or.empty();let i=new hn(W.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Hi(e.key,r,new pn(i.toArray()),Ri.none())}}function zi(e,t,n){e instanceof Gi?function(e,t,n){const r=e.value.clone(),i=Qi(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Hi?function(e,t,n){if(!ji(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Qi(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ki(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ui(e,t,n,r){return e instanceof Gi?function(e,t,n,r){if(!ji(e.precondition,t))return n;const i=e.value.clone(),s=Wi(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Hi?function(e,t,n,r){if(!ji(e.precondition,t))return n;const i=Wi(e.fieldTransforms,r,t),s=t.data;return s.setAll(Ki(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return ji(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Bi(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ti(r.transform,e||null);null!=i&&(null===n&&(n=or.empty()),n.set(r.field,i))}return n||null}function qi(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&B(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ii&&t instanceof Ii||e instanceof Ni&&t instanceof Ni?B(e.elements,t.elements,Fn):e instanceof Di&&t instanceof Di?Fn(e.Ae,t.Ae):e instanceof ki&&t instanceof ki}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Gi extends Fi{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Hi extends Fi{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ki(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Qi(e,t,n){const r=new Map;S(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Ei(o,a,n[i]))}return r}function Wi(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,_i(e,s,t))}return r}class Xi extends Fi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Yi extends Fi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ji{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&zi(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ui(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ui(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=di();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Vi(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(ce.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),gi())}isEqual(e){return this.batchId===e.batchId&&B(this.mutations,e.mutations,(e,t)=>qi(e,t))&&B(this.baseMutations,e.baseMutations,(e,t)=>qi(e,t))}}class $i{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){S(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=pi;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new $i(e,t,n,r)}}class Zi{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class es{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class ts{constructor(e,t){this.count=e,this.unchangedNames=t}}var ns,rs;function is(e){switch(e){case E.OK:return w(64938);case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0;default:return w(15467,{code:e})}}function ss(e){if(void 0===e)return y("GRPC error has no .code"),E.UNKNOWN;switch(e){case ns.OK:return E.OK;case ns.CANCELLED:return E.CANCELLED;case ns.UNKNOWN:return E.UNKNOWN;case ns.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case ns.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case ns.INTERNAL:return E.INTERNAL;case ns.UNAVAILABLE:return E.UNAVAILABLE;case ns.UNAUTHENTICATED:return E.UNAUTHENTICATED;case ns.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case ns.NOT_FOUND:return E.NOT_FOUND;case ns.ALREADY_EXISTS:return E.ALREADY_EXISTS;case ns.PERMISSION_DENIED:return E.PERMISSION_DENIED;case ns.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case ns.ABORTED:return E.ABORTED;case ns.OUT_OF_RANGE:return E.OUT_OF_RANGE;case ns.UNIMPLEMENTED:return E.UNIMPLEMENTED;case ns.DATA_LOSS:return E.DATA_LOSS;default:return w(39323,{code:e})}}(rs=ns||(ns={}))[rs.OK=0]="OK",rs[rs.CANCELLED=1]="CANCELLED",rs[rs.UNKNOWN=2]="UNKNOWN",rs[rs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rs[rs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rs[rs.NOT_FOUND=5]="NOT_FOUND",rs[rs.ALREADY_EXISTS=6]="ALREADY_EXISTS",rs[rs.PERMISSION_DENIED=7]="PERMISSION_DENIED",rs[rs.UNAUTHENTICATED=16]="UNAUTHENTICATED",rs[rs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rs[rs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rs[rs.ABORTED=10]="ABORTED",rs[rs.OUT_OF_RANGE=11]="OUT_OF_RANGE",rs[rs.UNIMPLEMENTED=12]="UNIMPLEMENTED",rs[rs.INTERNAL=13]="INTERNAL",rs[rs.UNAVAILABLE=14]="UNAVAILABLE",rs[rs.DATA_LOSS=15]="DATA_LOSS";let os=null;function as(){return new TextEncoder}const ls=new l.Integer([4294967295,4294967295],0);function cs(e){const t=as().encode(e),n=new l.Md5;return n.update(t),new Uint8Array(n.digest())}function us(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new l.Integer([n,r],0),new l.Integer([i,s],0)]}class hs{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ds("Invalid padding: ".concat(t));if(n<0)throw new ds("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new ds("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new ds("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=l.Integer.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(l.Integer.fromNumber(n)));return 1===r.compare(ls)&&(r=new l.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=cs(e),[n,r]=us(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new hs(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=cs(e),[n,r]=us(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ds extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class fs{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ps.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new fs(ce.min(),r,new ln(j),ai(),gi())}}class ps{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ps(n,t,gi(),gi(),gi())}}class ms{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class gs{constructor(e,t){this.targetId=e,this.Ce=t}}class ys{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gn.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class vs{constructor(){this.ve=0,this.Fe=xs(),this.Me=gn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gi(),t=gi(),n=gi();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:w(38017,{changeType:i})}}),new ps(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=xs()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,S(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bs{constructor(e){this.Ge=e,this.ze=new Map,this.je=ai(),this.Je=ws(),this.He=ws(),this.Ye=new ln(j)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:w(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(jr(s))if(0===n){const e=new X(s.path);this.et(t,e,lr.newNoDocument(e,ce.min()))}else S(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var i;const n=this.ut(e),s=n?this.ct(n,e,r):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(i=os)||void 0===i||i.lt(function(e,t,n,r,i){var s,o,a,l,c;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===i,hashCount:null!==(s=null===h||void 0===h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(o=null===h||void 0===h||null===(a=h.bits)||void 0===a||null===(a=a.bitmap)||void 0===a?void 0:a.length)&&void 0!==o?o:0,padding:null!==(l=null===h||void 0===h||null===(c=h.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=wn(n).toUint8Array()}catch(e){if(e instanceof mn)return v("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new hs(s,r,i)}catch(e){return v(e instanceof ds?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&jr(i.target)){const t=new X(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,lr.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=gi();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new fs(e,t,this.Ye,this.je,n);return this.je=ai(),this.Je=ws(),this.He=ws(),this.Ye=new ln(j),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new vs,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new hn(j),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new hn(j),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||g("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new vs),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ws(){return new ln(X.comparator)}function xs(){return new ln(X.comparator)}const Ss={asc:"ASCENDING",desc:"DESCENDING"},_s={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Es={and:"AND",or:"OR"};class Ts{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ks(e,t){return e.useProto3Json||Be(t)?t:{value:t}}function Is(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Cs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ns(e,t){return Is(e,t.toTimestamp())}function As(e){return S(!!e,49232),ce.fromTimestamp(function(e){const t=vn(e);return new le(t.seconds,t.nanos)}(e))}function Ds(e,t){return Ms(e,t).canonicalString()}function Ms(e,t){const n=function(e){return new K(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Os(e){const t=K.fromString(e);return S(no(t),10190,{key:t.toString()}),t}function Ps(e,t){return Ds(e.databaseId,t.path)}function Ls(e,t){const n=Os(t);if(n.get(1)!==e.databaseId.projectId)throw new T(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new T(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new X(Vs(n))}function Rs(e,t){return Ds(e.databaseId,t)}function js(e){const t=Os(e);return 4===t.length?K.emptyPath():Vs(t)}function Fs(e){return new K(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Vs(e){return S(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function zs(e,t,n){return{name:Ps(e,t),fields:n.value.mapValue.fields}}function Us(e,t,n){const r=Ls(e,t.name),i=As(t.updateTime),s=t.createTime?As(t.createTime):ce.min(),o=new or({mapValue:{fields:t.fields}}),a=lr.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Bs(e,t){let n;if(t instanceof Gi)n={update:zs(e,t.key,t.value)};else if(t instanceof Xi)n={delete:Ps(e,t.key)};else if(t instanceof Hi)n={update:zs(e,t.key,t.data),updateMask:to(t.fieldMask)};else{if(!(t instanceof Yi))return w(16599,{Vt:t.type});n={verify:Ps(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof ki)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ii)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ni)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Di)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw w(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ns(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:w(27497)}(e,t.precondition)),n}function qs(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Ri.updateTime(As(e.updateTime)):void 0!==e.exists?Ri.exists(e.exists):Ri.none()}(t.currentDocument):Ri.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)S("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),n=new ki;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Ii(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Ni(e)}else"increment"in t?n=new Di(e,t.increment):w(16584,{proto:t});const r=W.fromServerFormat(t.fieldPath);return new Pi(r,n)}(e,t)):[];if(t.update){t.update.name;const i=Ls(e,t.update.name),s=new or({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new pn(t.map(e=>W.fromServerFormat(e)))}(t.updateMask);return new Hi(i,s,e,n,r)}return new Gi(i,s,n,r)}if(t.delete){const r=Ls(e,t.delete);return new Xi(r,n)}if(t.verify){const r=Ls(e,t.verify);return new Yi(r,n)}return w(1463,{proto:t})}function Gs(e,t){return{documents:[Rs(e,t.path)]}}function Hs(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Rs(e,i);const s=function(e){if(0!==e.length)return eo(gr.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:$s(e.field),direction:Xs(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ks(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Ks(e,t,n,r){const{ft:i,parent:s}=Hs(e,t),o={},a=[];let l=0;return n.forEach(e=>{const t=r?e.alias:"aggregate_"+l++;o[t]=e.alias,"count"===e.aggregateType?a.push({alias:t,count:{}}):"avg"===e.aggregateType?a.push({alias:t,avg:{field:$s(e.fieldPath)}}):"sum"===e.aggregateType&&a.push({alias:t,sum:{field:$s(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function Qs(e){let t=js(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){S(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ws(e);return t instanceof gr&&br(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new dr(Zs(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Be(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new cr(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new cr(n,t)}(n.endAt)),Br(t,i,o,s,a,"F",l,c)}function Ws(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Zs(e.unaryFilter.field);return mr.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Zs(e.unaryFilter.field);return mr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Zs(e.unaryFilter.field);return mr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Zs(e.unaryFilter.field);return mr.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return w(61313);default:return w(60726)}}(e):void 0!==e.fieldFilter?function(e){return mr.create(Zs(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return w(58110);default:return w(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return gr.create(e.compositeFilter.filters.map(e=>Ws(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return w(1026)}}(e.compositeFilter.op))}(e):w(30097,{filter:e})}function Xs(e){return Ss[e]}function Ys(e){return _s[e]}function Js(e){return Es[e]}function $s(e){return{fieldPath:e.canonicalString()}}function Zs(e){return W.fromServerFormat(e.fieldPath)}function eo(e){return e instanceof mr?function(e){if("=="===e.op){if(Yn(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NAN"}};if(Xn(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Yn(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NOT_NAN"}};if(Xn(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$s(e.field),op:Ys(e.op),value:e.value}}}(e):e instanceof gr?function(e){const t=e.getFilters().map(e=>eo(e));return 1===t.length?t[0]:{compositeFilter:{op:Js(e.op),filters:t}}}(e):w(54877,{filter:e})}function to(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function no(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class ro{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ce.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ce.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:gn.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new ro(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class io{constructor(e){this.yt=e}}function so(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:oo(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Ps(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Is(e,t.version.toTimestamp()),createTime:Is(e,t.createTime.toTimestamp())}}(e.yt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ao(t.version)};else{if(!t.isUnknownDocument())return w(57904,{document:t});r.unknownDocument={path:n.path.toArray(),version:ao(t.version)}}return r}function oo(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ao(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function lo(e){const t=new le(e.seconds,e.nanoseconds);return ce.fromTimestamp(t)}function co(e,t){const n=(t.baseMutations||[]).map(t=>qs(e.yt,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>qs(e.yt,t)),i=le.fromMillis(t.localWriteTimeMs);return new Ji(t.batchId,i,n,r)}function uo(e){const t=lo(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?lo(e.lastLimboFreeSnapshotVersion):ce.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){const t=e.documents.length;return S(1===t,1966,{count:t}),Qr(qr(js(e.documents[0])))}(e.query):function(e){return Qr(Qs(e))}(e.query),new ro(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,gn.fromBase64String(e.resumeToken))}function ho(e,t){const n=ao(t.snapshotVersion),r=ao(t.lastLimboFreeSnapshotVersion);let i;i=jr(t.target)?Gs(e.yt,t.target):Hs(e.yt,t.target).ft;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Lr(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fo(e){const t=Qs({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Jr(t,t.limit,"L"):t}function po(e,t){return new Zi(t.largestBatchId,qs(e.yt,t.overlayMutation))}function mo(e,t){const n=t.path.lastSegment();return[e,Ke(t.path.popLast()),n]}function go(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:ao(r.readTime),documentKey:Ke(r.documentKey.path),largestBatchId:r.largestBatchId}}class yo{getBundleMetadata(e,t){return vo(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:lo(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return vo(e).put(function(e){return{bundleId:e.id,createTime:ao(As(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return bo(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:fo(e.bundledQuery),readTime:lo(e.readTime)}}(e)})}saveNamedQuery(e,t){return bo(e).put(function(e){return{name:e.name,readTime:ao(As(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function vo(e){return nn(e,Ct)}function bo(e){return nn(e,Nt)}class wo{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new wo(e,n)}getOverlay(e,t){return xo(e).get(mo(this.userId,t)).next(e=>e?po(this.serializer,e):null)}getOverlays(e,t){const n=hi();return Te.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,i)=>{const s=new Zi(t,i);r.push(this.St(e,s))}),Te.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(Ke(e.getCollectionPath())));const i=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(xo(e).Z(Bt,r))}),Te.waitFor(i)}getOverlaysForCollection(e,t,n){const r=hi(),i=Ke(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return xo(e).J(Bt,s).next(e=>{for(const t of e){const e=po(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const i=hi();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xo(e).ee({index:Gt,range:o},(e,t,n)=>{const o=po(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()}).next(()=>i)}St(e,t){return xo(e).put(function(e,t,n){const[r,i,s]=mo(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Bs(e.yt,n.mutation)}}(this.serializer,this.userId,t))}}function xo(e){return nn(e,zt)}class So{bt(e){return nn(e,Kt)}getSessionToken(e){return this.bt(e).get("sessionToken").next(e=>{const t=null===e||void 0===e?void 0:e.value;return t?gn.fromUint8Array(t):gn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class _o{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(bn(e.integerValue));else if("doubleValue"in e){const n=bn(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),qe(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=vn(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wn(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?er(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):$n(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):w(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const i=Ln,s=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(bn(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),X.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}_o.Kt=new _o;const Eo=255;function To(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function ko(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=To(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class Io{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{const e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Zt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Jt(e);else if(e<2048)this.Jt(960|e>>>6),this.Jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Jt(480|e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e);else{const e=t.codePointAt(0);this.Jt(240|e>>>18),this.Jt(128|63&e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e)}}this.Ht()}Xt(e){const t=this.en(e),n=ko(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),n=ko(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Eo),this.sn(255)}_n(){this.an(Eo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Gt(e){const t=255&e;0===t?(this.sn(0),this.sn(255)):t===Eo?(this.sn(Eo),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;0===t?(this.an(0),this.an(255)):t===Eo?(this.an(Eo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Co{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class No{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ao{constructor(){this.cn=new Io,this.ln=new Co(this.cn),this.hn=new No(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return 0===e?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Do{constructor(e,t,n,r){this.Tn=e,this.In=t,this.En=n,this.dn=r}An(){const e=this.dn.length,t=0===e||255===this.dn[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new Do(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:Po(this.En),directionalValue:Po(this.dn),orderedDocumentKey:Po(t),documentKey:n.path.toArray()}}Vn(e,t,n){const r=this.Rn(e,t,n);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Mo(e,t){let n=e.Tn-t.Tn;return 0!==n?n:(n=Oo(e.En,t.En),0!==n?n:(n=Oo(e.dn,t.dn),0!==n?n:X.comparator(e.In,t.In)))}function Oo(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}function Po(e){return a.isSafariOrWebkit()?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):e}function Lo(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)}class Ro{constructor(e){this.mn=new hn((e,t)=>W.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const e=t;e.isInequality()?this.mn=this.mn.add(e):this.gn.push(e)}}get pn(){return this.mn.size>1}yn(e){if(S(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=de(e);if(void 0!==t&&!this.wn(t))return!1;const n=fe(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.wn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.mn.size>0){const e=this.mn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.Sn(e,t)||!this.bn(this.fn[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.fn.length||!this.bn(this.fn[s++],e))return!1}return!0}Dn(){if(this.pn)return null;let e=new hn(W.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new me(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new me(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new me(n.field,"asc"===n.dir?0:1)));return new he(he.UNKNOWN_ID,this.collectionId,t,ye.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function jo(e){if(S(e instanceof mr||e instanceof gr,20012),e instanceof mr){if(e instanceof Ar){var t;const n=(null===(t=e.value.arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(t=>mr.create(e.field,"==",t)))||[];return gr.create(n,"or")}return e}const n=e.filters.map(e=>jo(e));return gr.create(n,e.op)}function Fo(e){if(0===e.getFilters().length)return[];const t=Bo(jo(e));return S(Uo(t),7391),Vo(t)||zo(t)?[t]:t.getFilters()}function Vo(e){return e instanceof mr}function zo(e){return e instanceof gr&&br(e)}function Uo(e){return Vo(e)||zo(e)||function(e){if(e instanceof gr&&vr(e)){for(const t of e.getFilters())if(!Vo(t)&&!zo(t))return!1;return!0}return!1}(e)}function Bo(e){if(S(e instanceof mr||e instanceof gr,34018),e instanceof mr)return e;if(1===e.filters.length)return Bo(e.filters[0]);const t=e.filters.map(e=>Bo(e));let n=gr.create(t,e.op);return n=Ho(n),Uo(n)?n:(S(n instanceof gr,64498),S(yr(n),40251),S(n.filters.length>1,57927),n.filters.reduce((e,t)=>qo(e,t)))}function qo(e,t){let n;return S(e instanceof mr||e instanceof gr,38388),S(t instanceof mr||t instanceof gr,25473),n=e instanceof mr?t instanceof mr?function(e,t){return gr.create([e,t],"and")}(e,t):Go(e,t):t instanceof mr?Go(t,e):function(e,t){if(S(e.filters.length>0&&t.filters.length>0,48005),yr(e)&&yr(t))return _r(e,t.getFilters());const n=vr(e)?e:t,r=vr(e)?t:e,i=n.filters.map(e=>qo(e,r));return gr.create(i,"or")}(e,t),Ho(n)}function Go(e,t){if(yr(t))return _r(t,e.getFilters());{const n=t.filters.map(t=>qo(e,t));return gr.create(n,"or")}}function Ho(e){if(S(e instanceof mr||e instanceof gr,11850),e instanceof mr)return e;const t=e.getFilters();if(1===t.length)return Ho(t[0]);if(wr(e))return e;const n=t.map(e=>Ho(e)),r=[];return n.forEach(t=>{t instanceof mr?r.push(t):t instanceof gr&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:gr.create(r,e.op)}class Ko{constructor(){this.Cn=new Qo}addToCollectionParentIndex(e,t){return this.Cn.add(t),Te.resolve()}getCollectionParents(e,t){return Te.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Te.resolve()}deleteFieldIndex(e,t){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,t){return Te.resolve()}getDocumentsMatchingTarget(e,t){return Te.resolve(null)}getIndexType(e,t){return Te.resolve(0)}getFieldIndexes(e,t){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,t){return Te.resolve(we.min())}getMinOffsetFromCollectionGroup(e,t){return Te.resolve(we.min())}updateCollectionGroup(e,t,n){return Te.resolve()}updateIndexEntries(e,t){return Te.resolve()}}class Qo{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new hn(K.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new hn(K.comparator)).toArray()}}const Wo="IndexedDbIndexManager",Xo=new Uint8Array(0);class Yo{constructor(e,t){this.databaseId=t,this.vn=new Qo,this.Fn=new si(e=>Lr(e),(e,t)=>Rr(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:n,parent:Ke(r)};return Jo(e).put(i)}return Te.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[q(t),""],!1,!0);return Jo(e).J(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Xe(r.parent))}return n})}addFieldIndex(e,t){const n=Zo(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=ea(e);return i.next(e=>{n.put(go(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const n=Zo(e),r=ea(e),i=$o(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Zo(e),n=$o(e),r=ea(e);return t.Z().next(()=>n.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return Te.forEach(this.Mn(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){const n=new Ro(t).Dn();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){const n=$o(e);let r=!0;const i=new Map;return Te.forEach(this.Mn(t),t=>this.xn(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=gi();const r=[];return Te.forEach(i,(i,s)=>{g(Wo,"Using index ".concat(function(e){return"id=".concat(e.indexId,"|cg=").concat(e.collectionGroup,"|f=").concat(e.fields.map(e=>"".concat(e.fieldPath,":").concat(e.kind)).join(","))}(i)," to execute ").concat(Lr(t)));const o=function(e,t){const n=de(t);if(void 0===n)return null;for(const r of Fr(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of fe(t))for(const t of Fr(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of fe(t)){const t=0===i.kind?Vr(e,i.fieldPath,e.startAt):zr(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new cr(n,r)}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of fe(t)){const t=0===i.kind?zr(e,i.fieldPath,e.endAt):Vr(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new cr(n,r)}(s,i),u=this.On(i,s,l),h=this.On(i,s,c),d=this.Nn(i,s,a),f=this.Bn(i.indexId,o,u,l.inclusive,h,c.inclusive,d);return Te.forEach(f,i=>n.Y(i,t.limit).next(t=>{t.forEach(t=>{const n=X.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return Te.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(t=0===e.filters.length?[e]:Fo(gr.create(e.filters,"and")).map(t=>Pr(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.Ln(t[u/l]):Xo,h=this.kn(e,a,n[u%l],r),d=this.qn(e,a,i[u%l],s),f=o.map(t=>this.kn(e,a,t,!0));c.push(...this.createRange(h,d,f))}return c}kn(e,t,n,r){const i=new Do(e,X.empty(),t,n);return r?i:i.An()}qn(e,t,n,r){const i=new Do(e,X.empty(),t,n);return r?i.An():i}xn(e,t){const n=new Ro(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.yn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.Mn(t);return Te.forEach(r,t=>this.xn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new hn(W.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n)}Qn(e,t){const n=new Ao;for(const r of fe(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Pn(r.kind);_o.Kt.Dt(e,i)}return n.un()}Ln(e){const t=new Ao;return _o.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new Ao;return _o.Kt.Dt(Kn(this.databaseId,t),n.Pn(function(e){const t=fe(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.un()}Nn(e,t,n){if(null===n)return[];let r=[];r.push(new Ao);let i=0;for(const s of fe(e)){const e=n[i++];for(const n of r)if(this.Un(t,s.fieldPath)&&Wn(e))r=this.Kn(r,s,e);else{const t=n.Pn(s.kind);_o.Kt.Dt(e,t)}}return this.Wn(r)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new Ao;n.seed(e.un()),_o.Kt.Dt(s,n.Pn(t.kind)),i.push(n)}return i}Un(e,t){return!!e.filters.find(e=>e instanceof mr&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=Zo(e),r=ea(e);return(t?n.J(Dt,IDBKeyRange.bound(t,t)):n.J()).next(e=>{const t=[];return Te.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new ye(t.sequenceNumber,new we(lo(t.readTime),new X(Xe(t.documentKey)),t.largestBatchId)):ye.empty(),r=e.fields.map(e=>{let[t,n]=e;return new me(W.fromServerFormat(t),n)});return new he(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:j(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=Zo(e),i=ea(e);return this.Gn(e).next(e=>r.J(Dt,IDBKeyRange.bound(t,t)).next(t=>Te.forEach(t,t=>i.put(go(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){const n=new Map;return Te.forEach(t,(t,r)=>{const i=n.get(t.collectionGroup);return(i?Te.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),Te.forEach(i,n=>this.zn(e,t,n).next(t=>{const i=this.jn(r,n);return t.isEqual(i)?Te.resolve():this.Jn(e,r,n,t,i)}))))})}Hn(e,t,n,r){return $o(e).put(r.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,r){return $o(e).delete(r.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const r=$o(e);let i=new hn(Mo);return r.ee({index:Ft,range:IDBKeyRange.only([n.indexId,this.uid,Po(this.$n(n,t))])},(e,r)=>{i=i.add(new Do(n.indexId,t,Lo(r.arrayValue),Lo(r.directionalValue)))}).next(()=>i)}jn(e,t){let n=new hn(Mo);const r=this.Qn(t,e);if(null==r)return n;const i=de(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Wn(s))for(const i of s.arrayValue.values||[])n=n.add(new Do(t.indexId,e.key,this.Ln(i),r))}else n=n.add(new Do(t.indexId,e.key,Xo,r));return n}Jn(e,t,n,r,i){g(Wo,"Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=fn(s),l=fn(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=fn(o)):t?(i(a),a=fn(s)):(a=fn(s),l=fn(o))}}(r,i,Mo,r=>{s.push(this.Hn(e,t,n,r))},r=>{s.push(this.Yn(e,t,n,r))}),Te.waitFor(s)}Gn(e){let t=1;return ea(e).ee({index:Pt,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>Mo(e,t)).filter((e,t,n)=>!t||0!==Mo(e,n[t-1]));const r=[];r.push(e);for(const s of n){const n=Mo(s,e),i=Mo(s,t);if(0===n)r[0]=e.An();else if(n>0&&i<0)r.push(s),r.push(s.An());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Zn(r[s],r[s+1]))return[];const e=r[s].Vn(this.uid,Xo,X.empty()),t=r[s+1].Vn(this.uid,Xo,X.empty());i.push(IDBKeyRange.bound(e,t))}return i}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ta)}getMinOffset(e,t){return Te.mapArray(this.Mn(t),t=>this.xn(e,t).next(e=>e||w(44426))).next(ta)}}function Jo(e){return nn(e,Tt)}function $o(e){return nn(e,Rt)}function Zo(e){return nn(e,At)}function ea(e){return nn(e,Mt)}function ta(e){S(0!==e.length,28825);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;xe(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new we(t.readTime,t.documentKey,n)}const na={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ra=41943040;class ia{static withCacheSize(e){return new ia(e,ia.DEFAULT_COLLECTION_PERCENTILE,ia.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function sa(e,t,n){const r=e.store(et),i=e.store(at),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(e,t,n)=>(a++,n.delete()));s.push(l.next(()=>{S(1===a,47070,{batchId:n.batchId})}));const c=[];for(const u of n.mutations){const e=st(t,u.key.path,n.batchId);s.push(i.delete(e)),c.push(u.key)}return Te.waitFor(s).next(()=>c)}function oa(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw w(14731);t=e.noDocument}return JSON.stringify(t).length}ia.DEFAULT_COLLECTION_PERCENTILE=10,ia.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ia.DEFAULT=new ia(ra,ia.DEFAULT_COLLECTION_PERCENTILE,ia.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ia.DISABLED=new ia(-1,0,0);class aa{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Xn={}}static wt(e,t,n,r){S(""!==e.uid,64387);const i=e.isAuthenticated()?e.uid:"";return new aa(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ca(e).ee({index:nt,range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=ua(e),s=ca(e);return s.add({}).next(o=>{S("number"==typeof o,49019);const a=new Ji(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map(t=>Bs(e.yt,t)),i=n.mutations.map(t=>Bs(e.yt,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),c=[];let u=new hn((e,t)=>j(e.canonicalString(),t.canonicalString()));for(const e of r){const t=st(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,ot))}return u.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Xn[o]=a.keys()}),Te.waitFor(c).next(()=>a)})}lookupMutationBatch(e,t){return ca(e).get(t).next(e=>e?(S(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),co(this.serializer,e)):null)}er(e,t){return this.Xn[t]?Te.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Xn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return ca(e).ee({index:nt,range:r},(e,t,r)=>{t.userId===this.userId&&(S(t.batchId>=n,47524,{tr:n}),i=co(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Ue;return ca(e).ee({index:nt,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ue],[this.userId,Number.POSITIVE_INFINITY]);return ca(e).J(nt,t).next(e=>e.map(e=>co(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=it(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return ua(e).ee({range:r},(n,r,s)=>{const[o,a,l]=n,c=Xe(a);if(o===this.userId&&t.path.isEqual(c))return ca(e).get(l).next(e=>{if(!e)throw w(61480,{nr:n,batchId:l});S(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(co(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hn(j);const r=[];return t.forEach(t=>{const i=it(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=ua(e).ee({range:s},(e,r,i)=>{const[s,o,a]=e,l=Xe(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()});r.push(o)}),Te.waitFor(r).next(()=>this.rr(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=it(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new hn(j);return ua(e).ee({range:s},(e,t,i)=>{const[s,a,l]=e,c=Xe(a);s===this.userId&&n.isPrefixOf(c)?c.length===r&&(o=o.add(l)):i.done()}).next(()=>this.rr(e,o))}rr(e,t){const n=[],r=[];return t.forEach(t=>{r.push(ca(e).get(t).next(e=>{if(null===e)throw w(35274,{batchId:t});S(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),n.push(co(this.serializer,e))}))}),Te.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return sa(e.le,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),Te.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Te.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return ua(e).ee({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Xe(e[1]);r.push(t)}else n.done()}).next(()=>{S(0===r.length,56720,{sr:r.map(e=>e.canonicalString())})})})}containsKey(e,t){return la(e,this.userId,t)}_r(e){return ha(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:Ue,lastStreamToken:""})}}function la(e,t,n){const r=it(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return ua(e).ee({range:s,X:!0},(e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()}).next(()=>o)}function ca(e){return nn(e,et)}function ua(e){return nn(e,at)}function ha(e){return nn(e,Ze)}class da{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new da(0)}static cr(){return new da(-1)}}class fa{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const n=new da(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(e=>ce.fromTimestamp(new le(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>pa(e).delete(t.targetId)).next(()=>this.lr(e)).next(t=>(S(t.targetCount>0,8065),t.targetCount-=1,this.hr(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return pa(e).ee((s,o)=>{const a=uo(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))}).next(()=>Te.waitFor(i)).next(()=>r)}forEachTarget(e,t){return pa(e).ee((e,n)=>{const r=uo(n);t(r)})}lr(e){return ma(e).get(_t).next(e=>(S(null!==e,2888),e))}hr(e,t){return ma(e).put(_t,t)}Pr(e,t){return pa(e).put(ho(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next(e=>e.targetCount)}getTargetData(e,t){const n=Lr(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return pa(e).ee({range:r,index:yt},(e,n,r)=>{const s=uo(n);Rr(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=ga(e);return t.forEach(t=>{const s=Ke(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),Te.waitFor(r)}removeMatchingKeys(e,t,n){const r=ga(e);return Te.forEach(t,t=>{const i=Ke(t.path);return Te.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=ga(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ga(e);let i=gi();return r.ee({range:n,X:!0},(e,t,n)=>{const r=Xe(e[1]),s=new X(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=Ke(t.path),r=IDBKeyRange.bound([n],[q(n)],!1,!0);let i=0;return ga(e).ee({index:xt,X:!0,range:r},(e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())}).next(()=>i>0)}At(e,t){return pa(e).get(t).next(e=>e?uo(e):null)}}function pa(e){return nn(e,gt)}function ma(e){return nn(e,Et)}function ga(e){return nn(e,bt)}const ya="LruGarbageCollector",va=1048576;function ba(e,t){let[n,r]=e,[i,s]=t;const o=j(n,i);return 0===o?j(r,s):o}class wa{constructor(e){this.Ir=e,this.buffer=new hn(ba),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ba(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xa{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){g(ya,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Me(e)?g(ya,"Ignoring IndexedDB error during garbage collection: ",e):await Ee(e)}await this.Vr(3e5)})}}class Sa{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Te.resolve(ze.ce);const n=new wa(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(g("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(na)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(g("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),na):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,s,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(g("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),m()<=o.LogLevel.DEBUG&&g("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(a-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(l-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-l)+"ms\n"+"Total Duration: ".concat(c-u,"ms")),Te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function _a(e,t){return new Sa(e,t)}class Ea{constructor(e,t){this.db=e,this.garbageCollector=_a(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(e,n)=>t(n))}addReference(e,t,n){return Ta(e,n)}removeReference(e,t,n){return Ta(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Ta(e,t)}br(e,t){return function(e,t){let n=!1;return ha(e).te(r=>la(e,r,t).next(e=>(e&&(n=!0),Te.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,(s,o)=>{if(o<=t){const t=this.br(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,ce.min()),ga(e).delete(function(e){return[0,Ke(e.path)]}(s))))});r.push(t)}}).next(()=>Te.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Ta(e,t)}Sr(e,t){const n=ga(e);let r,i=ze.ce;return n.ee({index:xt},(e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==ze.ce&&t(new X(Xe(r)),i),i=l,r=a):i=ze.ce}).next(()=>{i!==ze.ce&&t(new X(Xe(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ta(e,t){return ga(e).put(function(e,t){return{targetId:0,path:Ke(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class ka{constructor(){this.changes=new si(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Te.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ia{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Da(e).put(n)}removeEntry(e,t,n){return Da(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],oo(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Dr(e,n)))}getEntry(e,t){let n=lr.newInvalidDocument(t);return Da(e).ee({index:ut,range:IDBKeyRange.only(Ma(t))},(e,r)=>{n=this.Cr(t,r)}).next(()=>n)}vr(e,t){let n={size:0,document:lr.newInvalidDocument(t)};return Da(e).ee({index:ut,range:IDBKeyRange.only(Ma(t))},(e,r)=>{n={document:this.Cr(t,r),size:oa(r)}}).next(()=>n)}getEntries(e,t){let n=ai();return this.Fr(e,t,(e,t)=>{const r=this.Cr(e,t);n=n.insert(e,r)}).next(()=>n)}Mr(e,t){let n=ai(),r=new ln(X.comparator);return this.Fr(e,t,(e,t)=>{const i=this.Cr(e,t);n=n.insert(e,i),r=r.insert(e,oa(t))}).next(()=>({documents:n,Or:r}))}Fr(e,t,n){if(t.isEmpty())return Te.resolve();let r=new hn(Pa);t.forEach(e=>r=r.add(e));const i=IDBKeyRange.bound(Ma(r.first()),Ma(r.last())),s=r.getIterator();let o=s.getNext();return Da(e).ee({index:ut,range:i},(e,t,r)=>{const i=X.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&Pa(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.j(Ma(o)):r.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),oo(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Da(e).J(IDBKeyRange.bound(o,a,!0)).next(e=>{null===i||void 0===i||i.incrementDocumentReadCount(e.length);let n=ai();for(const i of e){const e=this.Cr(X.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(ti(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=ai();const s=Oa(t,n),o=Oa(t,we.max());return Da(e).ee({index:dt,range:IDBKeyRange.bound(s,o,!0)},(e,t,n)=>{const s=this.Cr(X.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new Na(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return Aa(e).get(mt).next(e=>(S(!!e,20021),e))}Dr(e,t){return Aa(e).put(mt,t)}Cr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Us(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=X.fromSegments(t.noDocument.path),r=lo(t.noDocument.readTime);n=lr.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return w(56709);{const e=X.fromSegments(t.unknownDocument.path),r=lo(t.unknownDocument.version);n=lr.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new le(e[0],e[1]);return ce.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(ce.min()))return e}return lr.newInvalidDocument(e)}}function Ca(e){return new Ia(e)}class Na extends ka{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new si(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new hn((e,t)=>j(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const o=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=so(this.Nr.serializer,s);r=r.add(i.path.popLast());const l=oa(a);n+=l-o.size,t.push(this.Nr.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=so(this.Nr.serializer,s.convertToNoDocument(ce.min()));t.push(this.Nr.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.Nr.updateMetadata(e,n)),Te.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(e=>(this.Br.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(e=>{let{documents:t,Or:n}=e;return n.forEach((e,n)=>{this.Br.set(e,{size:n,readTime:t.get(e).readTime})}),t})}}function Aa(e){return nn(e,pt)}function Da(e){return nn(e,lt)}function Ma(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Oa(e,t){const n=t.documentKey.path.toArray();return[e,oo(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Pa(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=j(n[s],r[s]),i)return i;return i=j(n.length,r.length),i||(i=j(n[n.length-2],r[r.length-2]),i||j(n[n.length-1],r[r.length-1]))}class La{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ra{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Ui(n.mutation,e,pn.empty(),le.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,gi()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gi();const r=hi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ci();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=hi();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,gi()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=ai();const s=fi(),o=fi();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Hi)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Ui(o.mutation,t,o.mutation.getFieldMask(),le.now())):s.set(t.key,pn.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new La(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=fi();let r=new ln((e,t)=>e-t),i=gi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||pn.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||gi()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=di();l.forEach(e=>{if(!i.has(e)){const r=Vi(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Te.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return X.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Hr(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Te.resolve(hi());let o=ue,a=i;return s.next(t=>Te.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Te.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,gi())).next(e=>({batchId:o,changes:ui(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new X(t)).next(e=>{let t=ci();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=ci();return this.indexManager.getCollectionParents(e,i).next(o=>Te.forEach(o,o=>{const a=function(e,t){return new Ur(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,lr.newInvalidDocument(r)))});let n=ci();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&Ui(s.mutation,r,pn.empty(),le.now()),ti(t,r)&&(n=n.insert(e,r))}),n})}}class ja{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Te.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:As(e.createTime)}}(t)),Te.resolve()}getNamedQuery(e,t){return Te.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:fo(e.bundledQuery),readTime:As(e.readTime)}}(t)),Te.resolve()}}class Fa{constructor(){this.overlays=new ln(X.comparator),this.qr=new Map}getOverlay(e,t){return Te.resolve(this.overlays.get(t))}getOverlays(e,t){const n=hi();return Te.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Te.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Te.resolve()}getOverlaysForCollection(e,t,n){const r=hi(),i=t.length+1,s=new X(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Te.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new ln((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=hi(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=hi(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Te.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Zi(t,n));let i=this.qr.get(t);void 0===i&&(i=gi(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class Va{constructor(){this.sessionToken=gn.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Te.resolve()}}class za{constructor(){this.Qr=new hn(Ua.$r),this.Ur=new hn(Ua.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Ua(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Ua(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new X(new K([])),n=new Ua(t,e),r=new Ua(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new X(new K([])),n=new Ua(t,e),r=new Ua(t,e+1);let i=gi();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Ua(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ua{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return X.comparator(e.key,t.key)||j(e.Yr,t.Yr)}static Kr(e,t){return j(e.Yr,t.Yr)||X.comparator(e.key,t.key)}}class Ba{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new hn(Ua.$r)}checkEmpty(e){return Te.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Ji(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Zr=this.Zr.add(new Ua(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Te.resolve(s)}lookupMutationBatch(e,t){return Te.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return Te.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(0===this.mutationQueue.length?Ue:this.tr-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ua(t,0),r=new Ua(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),Te.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hn(j);return t.forEach(e=>{const t=new Ua(e,0),r=new Ua(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Te.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;X.isDocumentKey(i)||(i=i.child(""));const s=new Ua(new X(i),0);let o=new hn(j);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},s),Te.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){S(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Te.forEach(t.mutations,r=>{const i=new Ua(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Ua(t,0),r=this.Zr.firstAfterOrEqual(n);return Te.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class qa{constructor(e){this.ri=e,this.docs=new ln(X.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Te.resolve(n?n.document.mutableCopy():lr.newInvalidDocument(t))}getEntries(e,t){let n=ai();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():lr.newInvalidDocument(e))}),Te.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ai();const s=t.path,o=new X(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||xe(be(o),n)<=0||(r.has(o.key)||ti(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Te.resolve(i)}getAllFromCollectionGroup(e,t,n,r){w(9500)}ii(e,t){return Te.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Ga(this)}getSize(e){return Te.resolve(this.size)}}class Ga extends ka{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Te.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Ha{constructor(e){this.persistence=e,this.si=new si(e=>Lr(e),Rr),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.oi=0,this._i=new za,this.targetCount=0,this.ai=da.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Te.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new da(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Te.resolve()}updateTargetData(e,t){return this.Pr(t),Te.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Te.waitFor(i).next(()=>r)}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Te.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Te.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Te.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Te.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Te.resolve(n)}containsKey(e,t){return Te.resolve(this._i.containsKey(t))}}class Ka{constructor(e,t){this.ui={},this.overlays={},this.ci=new ze(0),this.li=!1,this.li=!0,this.hi=new Va,this.referenceDelegate=e(this),this.Pi=new Ha(this),this.indexManager=new Ko,this.remoteDocumentCache=function(e){return new qa(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new io(t),this.Ii=new ja(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Ba(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){g("MemoryPersistence","Starting transaction:",e);const r=new Qa(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Te.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Qa extends _e{constructor(e){super(),this.currentSequenceNumber=e}}class Wa{constructor(e){this.persistence=e,this.Ri=new za,this.Vi=null}static mi(e){return new Wa(e)}get fi(){if(this.Vi)return this.Vi;throw w(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Te.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Te.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Te.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.fi,n=>{const r=X.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,ce.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Te.or([()=>Te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Xa{constructor(e,t){this.persistence=e,this.pi=new si(e=>Ke(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=_a(this,t)}static mi(e,t){return new Xa(e,t)}Ei(){}di(e){return Te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Te.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Te.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,ce.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Te.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Te.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Te.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Hn(e.data.value)),t}br(e,t,n){return Te.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Te.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ya{constructor(e){this.serializer=e}k(e,t,n,r){const i=new Ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Je)}(e),function(e){e.createObjectStore(Ze,{keyPath:"userId"});e.createObjectStore(et,{keyPath:tt,autoIncrement:!0}).createIndex(nt,rt,{unique:!0}),e.createObjectStore(at)}(e),Ja(e),function(e){e.createObjectStore(Ye)}(e));let s=Te.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(bt),e.deleteObjectStore(gt),e.deleteObjectStore(Et)}(e),Ja(e)),s=s.next(()=>function(e){const t=e.store(Et),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ce.min().toTimestamp(),targetCount:0};return t.put(_t,n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store(et).J().next(n=>{e.deleteObjectStore(et),e.createObjectStore(et,{keyPath:tt,autoIncrement:!0}).createIndex(nt,rt,{unique:!0});const r=t.store(et),i=n.map(e=>r.put(e));return Te.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore(It,{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.yi(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore(pt)}(e),this.wi(i)))),n<7&&r>=7&&(s=s.next(()=>this.Si(i))),n<8&&r>=8&&(s=s.next(()=>this.bi(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(s=s.next(()=>this.Di(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore(Ct,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(Nt,{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore(zt,{keyPath:Ut});t.createIndex(Bt,qt,{unique:!1}),t.createIndex(Gt,Ht,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore(lt,{keyPath:ct});t.createIndex(ut,ht),t.createIndex(dt,ft)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(Ye))),n<14&&r>=14&&(s=s.next(()=>this.Fi(e,i))),n<15&&r>=15&&(s=s.next(()=>function(e){e.createObjectStore(At,{keyPath:"indexId",autoIncrement:!0}).createIndex(Dt,"collectionGroup",{unique:!1});e.createObjectStore(Mt,{keyPath:Ot}).createIndex(Pt,Lt,{unique:!1});e.createObjectStore(Rt,{keyPath:jt}).createIndex(Ft,Vt,{unique:!1})}(e))),n<16&&r>=16&&(s=s.next(()=>{t.objectStore(Mt).clear()}).next(()=>{t.objectStore(Rt).clear()})),n<17&&r>=17&&(s=s.next(()=>{!function(e){e.createObjectStore(Kt,{keyPath:"name"})}(e)})),n<18&&r>=18&&a.isSafariOrWebkit()&&(s=s.next(()=>{t.objectStore(Mt).clear()}).next(()=>{t.objectStore(Rt).clear()})),s}wi(e){let t=0;return e.store(Ye).ee((e,n)=>{t+=oa(n)}).next(()=>{const n={byteSize:t};return e.store(pt).put(mt,n)})}yi(e){const t=e.store(Ze),n=e.store(et);return t.J().next(t=>Te.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,Ue],[t.userId,t.lastAcknowledgedBatchId]);return n.J(nt,r).next(n=>Te.forEach(n,n=>{S(n.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});const r=co(this.serializer,n);return sa(e,t.userId,r).next(()=>{})}))}))}Si(e){const t=e.store(bt),n=e.store(Ye);return e.store(Et).get(_t).next(e=>{const r=[];return n.ee((n,i)=>{const s=new K(n),o=function(e){return[0,Ke(e)]}(s);r.push(t.get(o).next(n=>n?Te.resolve():(n=>t.put({targetId:0,path:Ke(n),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>Te.waitFor(r))})}bi(e,t){e.createObjectStore(Tt,{keyPath:kt});const n=t.store(Tt),r=new Qo,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Ke(r)})}};return t.store(Ye).ee({X:!0},(e,t)=>{const n=new K(e);return i(n.popLast())}).next(()=>t.store(at).ee({X:!0},(e,t)=>{let[n,r,s]=e;const o=Xe(r);return i(o.popLast())}))}Di(e){const t=e.store(gt);return t.ee((e,n)=>{const r=uo(n),i=ho(this.serializer,r);return t.put(i)})}Ci(e,t){const n=t.store(Ye),r=[];return n.ee((e,n)=>{const i=t.store(lt),s=function(e){return e.document?new X(K.fromString(e.document.name).popFirst(5)):e.noDocument?X.fromSegments(e.noDocument.path):e.unknownDocument?X.fromSegments(e.unknownDocument.path):w(36783)}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))}).next(()=>Te.waitFor(r))}Fi(e,t){const n=t.store(et),r=Ca(this.serializer),i=new Ka(Wa.mi,this.serializer.yt);return n.J().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:gi();co(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),Te.forEach(n,(e,n)=>{const s=new d(n),o=wo.wt(this.serializer,s),a=i.getIndexManager(s),l=aa.wt(s,this.serializer,a,i.referenceDelegate);return new Ra(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new tn(t,ze.ce),e).next()})})}}function Ja(e){e.createObjectStore(bt,{keyPath:wt}).createIndex(xt,St,{unique:!0}),e.createObjectStore(gt,{keyPath:"targetId"}).createIndex(yt,vt,{unique:!0}),e.createObjectStore(Et)}const $a="IndexedDbPersistence",Za=18e5,el=5e3,tl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nl="main";class rl{constructor(e,t,n,r,i,s,o,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:18;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=i,this.window=s,this.document=o,this.xi=l,this.Oi=c,this.Ni=u,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=e=>Promise.resolve(),!rl.v())throw new T(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ea(this,r),this.$i=t+nl,this.serializer=new io(a),this.Ui=new Ce(this.$i,this.Ni,new Ya(this.serializer)),this.hi=new So,this.Pi=new fa(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ca(this.serializer),this.Ii=new yo,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,!1===c&&y($a,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new T(E.FAILED_PRECONDITION,tl);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new ze(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(e=>{e||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(Me(e))return g($a,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return g($a,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return il(e).get($e).next(e=>Te.resolve(this.es(e)))}ts(e){return sl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Za)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=nn(e,It);return t.J().next(e=>{const n=this.ss(e,Za),r=e.filter(e=>-1===n.indexOf(e));return Te.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Te.resolve(!0):il(e).get($e).next(t=>{if(null!==t&&this.rs(t.leaseTimestampMs,el)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new T(E.FAILED_PRECONDITION,tl);return!1}}return!(!this.networkEnabled||!this.inForeground)||sl(e).J().next(e=>void 0===this.ss(e,el).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&g($a,"Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Je,It],e=>{const t=new tn(e,ze.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(e=>this.rs(e.updateTimeMs,t)&&!this.us(e.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>sl(e).J().next(e=>this.ss(e,Za).map(e=>e.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return aa.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Yo(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return wo.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){g($a,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 18===e?en:17===e?Zt:16===e?$t:15===e?Jt:14===e?Yt:13===e?Xt:12===e?Wt:11===e?Qt:void w(60245)}(this.Ni);let s;return this.Ui.runTransaction(e,r,i,r=>(s=new tn(r,this.ci?this.ci.next():ze.ce),"readwrite-primary"===t?this.Hi(s).next(e=>!!e||this.Yi(s)).next(t=>{if(!t)throw y("Failed to obtain primary lease for action '".concat(e,"'.")),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new T(E.FAILED_PRECONDITION,Se);return n(s)}).next(e=>this.Xi(s).next(()=>e)):this.Is(s).next(()=>n(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Is(e){return il(e).get($e).next(e=>{if(null!==e&&this.rs(e.leaseTimestampMs,el)&&!this.us(e.ownerId)&&!this.es(e)&&!(this.Oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new T(E.FAILED_PRECONDITION,tl)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return il(e).put($e,t)}static v(){return Ce.v()}Zi(e){const t=il(e);return t.get($e).next(e=>this.es(e)?(g($a,"Releasing primary lease."),t.delete($e)):Te.resolve())}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(y("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}Gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground="visible"===this.document.visibilityState)}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;a.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{var t;const n=null!==(null===(t=this.Ki)||void 0===t?void 0:t.getItem(this._s(e)));return g($a,"Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return y($a,"Failed to get zombied client id.",e),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){y("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch(e){}}_s(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}function il(e){return nn(e,Je)}function sl(e){return nn(e,It)}function ol(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class al{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=gi(),r=gi();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new al(e,t.fromCache,n,r)}}class ll{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class cl{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=a.isSafari()?8:Ne(a.getUA())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new ll;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(m()<=o.LogLevel.DEBUG&&g("QueryEngine","SDK will not create cache indexes for query:",ei(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Te.resolve()):(m()<=o.LogLevel.DEBUG&&g("QueryEngine","Query:",ei(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(m()<=o.LogLevel.DEBUG&&g("QueryEngine","The SDK decides to create cache indexes for query:",ei(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qr(t))):Te.resolve())}ys(e,t){if(Gr(t))return Te.resolve(null);let n=Qr(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Jr(t,null,"F"),n=Qr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=gi(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,i,n.readTime)?this.ys(e,Jr(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return Gr(t)||r.isEqual(ce.min())?Te.resolve(null):this.ps.getDocuments(e,n).next(i=>{const s=this.Ds(t,i);return this.Cs(t,s,n,r)?Te.resolve(null):(m()<=o.LogLevel.DEBUG&&g("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ei(t)),this.vs(e,s,t,ve(r,ue)).next(e=>e))})}Ds(e,t){let n=new hn(ri(e));return t.forEach((t,r)=>{ti(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return m()<=o.LogLevel.DEBUG&&g("QueryEngine","Using full collection scan to execute query:",ei(t)),this.ps.getDocumentsMatchingQuery(e,t,we.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const ul="LocalStore";class hl{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ln(j),this.xs=new si(e=>Lr(e),Rr),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ra(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function dl(e,t,n,r){return new hl(e,t,n,r)}async function fl(e,t){const n=_(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=gi();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:s}))})})}function pl(e){const t=_(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function ml(e,t,n){let r=gi(),i=gi();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=ai();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(ce.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):g(ul,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{ks:r,qs:i}})}function gl(e,t){const n=_(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Ue),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function yl(e,t){const n=_(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,Te.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new ro(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function vl(e,t,n){const r=_(e),i=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Me(e))throw e;g(ul,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function bl(e,t,n){const r=_(e);let i=ce.min(),s=gi();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=_(e),i=r.xs.get(n);return void 0!==i?Te.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,Qr(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:ce.min(),n?s:gi())).next(e=>(Sl(r,ni(t),e),{documents:e,Qs:s})))}function wl(e,t){const n=_(e),r=_(n.Pi),i=n.Ms.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.At(e,t).next(e=>e?e.target:null))}function xl(e,t){const n=_(e),r=n.Os.get(t)||ce.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.Ns.getAllFromCollectionGroup(e,t,ve(r,ue),Number.MAX_SAFE_INTEGER)).then(e=>(Sl(n,t,e),e))}function Sl(e,t,n){let r=e.Os.get(t)||ce.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}async function _l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gi();const r=await yl(e,Qr(fo(t.bundledQuery))),i=_(e);return i.persistence.runTransaction("Save named query","readwrite",e=>{const s=As(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Ii.saveNamedQuery(e,t);const o=r.withResumeToken(gn.EMPTY_BYTE_STRING,s);return i.Ms=i.Ms.insert(o.targetId,o),i.Pi.updateTargetData(e,o).next(()=>i.Pi.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>i.Pi.addMatchingKeys(e,n,r.targetId)).next(()=>i.Ii.saveNamedQuery(e,t))})}const El="firestore_clients";function Tl(e,t){return"".concat(El,"_").concat(e,"_").concat(t)}const kl="firestore_mutations";function Il(e,t,n){let r="".concat(kl,"_").concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}const Cl="firestore_targets";function Nl(e,t){return"".concat(Cl,"_").concat(e,"_").concat(t)}const Al="SharedClientState";class Dl{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ws(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new T(r.error.code,r.error.message))),s?new Dl(e,t,r.state,i):(y(Al,"Failed to parse mutation state for ID '".concat(t,"': ").concat(n)),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ml{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ws(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new T(n.error.code,n.error.message))),i?new Ml(e,n.state,r):(y(Al,"Failed to parse target state for ID '".concat(e,"': ").concat(t)),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ol{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=vi();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=Ge(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new Ol(e,i):(y(Al,"Failed to parse client data for instance '".concat(e,"': ").concat(t)),null)}}class Pl{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Pl(t.clientId,t.onlineState):(y(Al,"Failed to parse online state: ".concat(e)),null)}}class Ll{constructor(){this.activeTargetIds=vi()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rl{constructor(e,t,n,r,i){this.window=e,this.Mi=t,this.persistenceKey=n,this.Js=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new ln(j),this.started=!1,this.Xs=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.eo=Tl(this.persistenceKey,this.Js),this.no=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Ll),this.ro=new RegExp("^".concat(El,"_").concat(s,"_([^_]*)$")),this.io=new RegExp("^".concat(kl,"_").concat(s,"_(\\d+)(?:_(.*))?$")),this.so=new RegExp("^".concat(Cl,"_").concat(s,"_(\\d+)$")),this.oo=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this._o=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const n of e){if(n===this.Js)continue;const e=this.getItem(Tl(this.persistenceKey,n));if(e){const t=Ol.Ws(n,e);t&&(this.Zs=this.Zs.insert(t.clientId,t))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const e=this.uo(t);e&&this.co(e)}for(const n of this.Xs)this.Ys(n);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,n){this.ho(e,t,n),this.Po(e)}addLocalQueryTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(Nl(this.persistenceKey,e));if(t){const r=Ml.Ws(e,t);r&&(n=r.state)}}return t&&this.To.zs(e),this.ao(),n}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Nl(this.persistenceKey,e))}updateQueryState(e,t,n){this.Io(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.Po(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return g(Al,"READ",e,t),t}setItem(e,t){g(Al,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){g(Al,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(g(Al,"EVENT",t.key,t.newValue),t.key===this.eo)return void y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.ro.test(t.key)){if(null==t.newValue){const e=this.Ro(t.key);return this.Vo(e,null)}{const e=this.mo(t.key,t.newValue);if(e)return this.Vo(e.clientId,e)}}else if(this.io.test(t.key)){if(null!==t.newValue){const e=this.fo(t.key,t.newValue);if(e)return this.po(e)}}else if(this.so.test(t.key)){if(null!==t.newValue){const e=this.yo(t.key,t.newValue);if(e)return this.wo(e)}}else if(t.key===this.oo){if(null!==t.newValue){const e=this.uo(t.newValue);if(e)return this.co(e)}}else if(t.key===this.no){const e=function(e){let t=ze.ce;if(null!=e)try{const n=JSON.parse(e);S("number"==typeof n,30636,{So:e}),t=n}catch(e){y(Al,"Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==ze.ce&&this.sequenceNumberHandler(e)}else if(t.key===this._o){const e=this.bo(t.newValue);await Promise.all(e.map(e=>this.syncEngine.Do(e)))}}else this.Xs.push(t)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,n){const r=new Dl(this.currentUser,e,t,n),i=Il(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Gs())}Po(e){const t=Il(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,n){const r=Nl(this.persistenceKey,e),i=new Ml(e,t,n);this.setItem(r,i.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const n=this.Ro(e);return Ol.Ws(n,t)}fo(e,t){const n=this.io.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Dl.Ws(new d(i),r,t)}yo(e,t){const n=this.so.exec(e),r=Number(n[1]);return Ml.Ws(r,t)}uo(e){return Pl.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);g(Al,"Ignoring mutation for non-active user ".concat(e.user.uid))}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const n=t?this.Zs.insert(e,t):this.Zs.remove(e),r=this.lo(this.Zs),i=this.lo(n),s=[],o=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||o.push(e)}),this.syncEngine.Fo(s,o).then(()=>{this.Zs=n})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=vi();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class jl{constructor(){this.Mo=new Ll,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ll,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Fl{Oo(e){}shutdown(){}}const Vl="ConnectivityMonitor";class zl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){g(Vl,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){g(Vl,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ul=null;function Bl(){return null===Ul?Ul=268435456+Math.round(2147483648*Math.random()):Ul++,"0x"+Ul.toString(16)}const ql="RestConnection",Gl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Hl{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Nn?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,i){const s=Bl(),o=this.zo(e,t.toUriEncodedString());g(ql,"Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,r,i);const{host:c}=new URL(o),u=a.isCloudWorkstation(c);return this.Jo(e,o,l,n,u).then(t=>(g(ql,"Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw v(ql,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t})}Ho(e,t,n,r,i,s){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+f,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Gl[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class Kl{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ql="WebChannelConnection";class Wl extends Hl{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=Bl();return new Promise((i,o)=>{const a=new c.XhrIo;a.setWithCredentials(!0),a.listenOnce(c.EventType.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case c.ErrorCode.NO_ERROR:const n=a.getResponseJson();g(Ql,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(n)),i(n);break;case c.ErrorCode.TIMEOUT:g(Ql,"RPC '".concat(e,"' ").concat(s," timed out")),o(new T(E.DEADLINE_EXCEEDED,"Request time out"));break;case c.ErrorCode.HTTP_ERROR:const r=a.getStatus();if(g(Ql,"RPC '".concat(e,"' ").concat(s," failed with status:"),r,"response text:",a.getResponseText()),r>0){var t;let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(t)>=0?t:E.UNKNOWN}(n.status);o(new T(e,n.message))}else o(new T(E.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new T(E.UNAVAILABLE,"Connection failed."));break;default:w(9055,{l_:e,streamId:s,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{g(Ql,"RPC '".concat(e,"' ").concat(s," completed."))}});const l=JSON.stringify(r);g(Ql,"RPC '".concat(e,"' ").concat(s," sending request:"),r),a.send(t,"POST",l,n,15)})}T_(e,t,n){const r=Bl(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=c.createWebChannelTransport(),o=c.getStatEventTarget(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");g(Ql,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(u),a);const h=s.createWebChannel(u,a);this.I_(h);let d=!1,f=!1;const p=new Kl({Yo:t=>{f?g(Ql,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(g(Ql,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),h.open(),d=!0),g(Ql,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),h.send(t))},Zo:()=>h.close()}),m=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return m(h,c.WebChannel.EventType.OPEN,()=>{f||(g(Ql,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.o_())}),m(h,c.WebChannel.EventType.CLOSE,()=>{f||(f=!0,g(Ql,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.a_(),this.E_(h))}),m(h,c.WebChannel.EventType.ERROR,t=>{f||(f=!0,v(Ql,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),p.a_(new T(E.UNAVAILABLE,"The operation could not be completed")))}),m(h,c.WebChannel.EventType.MESSAGE,t=>{if(!f){var n;const i=t.data[0];S(!!i,16349);const s=i,o=(null===s||void 0===s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){g(Ql,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=ns[e];if(void 0!==t)return ss(t)}(t),i=o.message;void 0===n&&(n=E.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),f=!0,p.a_(new T(n,i)),h.close()}else g(Ql,"RPC '".concat(e,"' stream ").concat(r," received:"),i),p.u_(i)}}),m(o,c.Event.STAT_EVENT,t=>{t.stat===c.Stat.PROXY?g(Ql,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===c.Stat.NOPROXY&&g(Ql,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Xl(){return"undefined"!=typeof window?window:null}function Yl(){return"undefined"!=typeof document?document:null}function Jl(e){return new Ts(e,!0)}class $l{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&g("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Zl="PersistentStream";class ec{constructor(e,t,n,r,i,s,o,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new $l(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===E.RESOURCE_EXHAUSTED?(y(t.toString()),y("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===E.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new T(E.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return g(Zl,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(g(Zl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tc extends ec{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:w(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(S(void 0===t||"string"==typeof t,58123),gn.fromBase64String(t||"")):(S(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),gn.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?E.UNKNOWN:ss(e.code);return new T(t,e.message||"")}(o);n=new ys(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ls(e,r.document.name),s=As(r.document.updateTime),o=r.document.createTime?As(r.document.createTime):ce.min(),a=new or({mapValue:{fields:r.document.fields}}),l=lr.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new ms(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ls(e,r.document),s=r.readTime?As(r.readTime):ce.min(),o=lr.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ms([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ls(e,r.document),s=r.removedTargetIds||[];n=new ms([],s,i,null)}else{if(!("filter"in t))return w(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new ts(r,i),o=e.targetId;n=new gs(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ce.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ce.min():t.readTime?As(t.readTime):ce.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Fs(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=jr(r)?{documents:Gs(e,r)}:{query:Hs(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Cs(e,t.resumeToken);const r=ks(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(ce.min())>0){n.readTime=Is(e,t.snapshotVersion.toTimestamp());const r=ks(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return w(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Fs(this.serializer),t.removeTarget=e,this.q_(t)}}class nc extends ec{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return S(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,S(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){S(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(S(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?As(e.updateTime):As(t);return n.isEqual(ce.min())&&(n=As(t)),new Li(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=As(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Fs(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Bs(this.serializer,e))};this.q_(t)}}class rc{}class ic extends rc{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new T(E.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Go(e,Ms(t,n),r,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new T(E.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Ho(e,Ms(t,n),r,o,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new T(E.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class sc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(y(t),this.aa=!1):g("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const oc="RemoteStore";class ac{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{gc(this)&&(g(oc,"Restarting streams for network reachability change."),await async function(e){const t=_(e);t.Ea.add(4),await cc(t),t.Ra.set("Unknown"),t.Ea.delete(4),await lc(t)}(this))})}),this.Ra=new sc(n,r)}}async function lc(e){if(gc(e))for(const t of e.da)await t(!0)}async function cc(e){for(const t of e.da)await t(!1)}function uc(e,t){const n=_(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),mc(n)?pc(n):Lc(n).O_()&&dc(n,t))}function hc(e,t){const n=_(e),r=Lc(n);n.Ia.delete(t),r.O_()&&fc(n,t),0===n.Ia.size&&(r.O_()?r.L_():gc(n)&&n.Ra.set("Unknown"))}function dc(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ce.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Lc(e).Y_(t)}function fc(e,t){e.Va.Ue(t),Lc(e).Z_(t)}function pc(e){e.Va=new bs({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Lc(e).start(),e.Ra.ua()}function mc(e){return gc(e)&&!Lc(e).x_()&&e.Ia.size>0}function gc(e){return 0===_(e).Ea.size}function yc(e){e.Va=void 0}async function vc(e){e.Ra.set("Online")}async function bc(e){e.Ia.forEach((t,n)=>{dc(e,t)})}async function wc(e,t){yc(e),mc(e)?(e.Ra.ha(t),pc(e)):e.Ra.set("Unknown")}async function xc(e,t,n){if(e.Ra.set("Online"),t instanceof ys&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){g(oc,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Sc(e,n)}else if(t instanceof ms?e.Va.Ze(t):t instanceof gs?e.Va.st(t):e.Va.tt(t),!n.isEqual(ce.min()))try{const t=await pl(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(gn.EMPTY_BYTE_STRING,r.snapshotVersion)),fc(e,t);const i=new ro(r.target,t,n,r.sequenceNumber);dc(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){g(oc,"Failed to raise snapshot:",t),await Sc(e,t)}}async function Sc(e,t,n){if(!Me(t))throw t;e.Ea.add(1),await cc(e),e.Ra.set("Offline"),n||(n=()=>pl(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{g(oc,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await lc(e)})}function _c(e,t){return t().catch(n=>Sc(e,n,t))}async function Ec(e){const t=_(e),n=Rc(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Ue;for(;Tc(t);)try{const e=await gl(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,kc(t,e)}catch(e){await Sc(t,e)}Ic(t)&&Cc(t)}function Tc(e){return gc(e)&&e.Ta.length<10}function kc(e,t){e.Ta.push(t);const n=Rc(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Ic(e){return gc(e)&&!Rc(e).x_()&&e.Ta.length>0}function Cc(e){Rc(e).start()}async function Nc(e){Rc(e).ra()}async function Ac(e){const t=Rc(e);for(const n of e.Ta)t.ea(n.mutations)}async function Dc(e,t,n){const r=e.Ta.shift(),i=$i.from(r,t,n);await _c(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Ec(e)}async function Mc(e,t){t&&Rc(e).X_&&await async function(e,t){if(function(e){return is(e)&&e!==E.ABORTED}(t.code)){const n=e.Ta.shift();Rc(e).B_(),await _c(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ec(e)}}(e,t),Ic(e)&&Cc(e)}async function Oc(e,t){const n=_(e);n.asyncQueue.verifyOperationInProgress(),g(oc,"RemoteStore received new credentials");const r=gc(n);n.Ea.add(3),await cc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await lc(n)}async function Pc(e,t){const n=_(e);t?(n.Ea.delete(2),await lc(n)):t||(n.Ea.add(2),await cc(n),n.Ra.set("Unknown"))}function Lc(e){return e.ma||(e.ma=function(e,t,n){const r=_(e);return r.sa(),new tc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:vc.bind(null,e),t_:bc.bind(null,e),r_:wc.bind(null,e),H_:xc.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),mc(e)?pc(e):e.Ra.set("Unknown")):(await e.ma.stop(),yc(e))})),e.ma}function Rc(e){return e.fa||(e.fa=function(e,t,n){const r=_(e);return r.sa(),new nc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Nc.bind(null,e),r_:Mc.bind(null,e),ta:Ac.bind(null,e),na:Dc.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Ec(e)):(await e.fa.stop(),e.Ta.length>0&&(g(oc,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class jc{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new k,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new jc(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new T(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fc(e,t){if(y("AsyncQueue","".concat(t,": ").concat(e)),Me(e))return new T(E.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Vc{static emptySet(e){return new Vc(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||X.comparator(t.key,n.key):(e,t)=>X.comparator(e.key,t.key),this.keyedMap=ci(),this.sortedSet=new ln(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Vc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Vc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class zc{constructor(){this.ga=new ln(X.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):w(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Uc{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Uc(e,t,Vc.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$r(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Bc{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class qc{constructor(){this.queries=Gc(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=_(e),r=n.queries;n.queries=Gc(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new T(E.ABORTED,"Firestore shutting down"))}}function Gc(){return new si(e=>Zr(e),$r)}async function Hc(e,t){const n=_(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.ba()&&t.Da()&&(r=2):(s=new Bc,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Fc(e,"Initialization of query '".concat(ei(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&Xc(n)}async function Kc(e,t){const n=_(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.Da()?0:1:!s.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Qc(e,t){const n=_(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&Xc(n)}function Wc(e,t,n){const r=_(e),i=r.queries.get(t);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(t)}function Xc(e){e.Ca.forEach(e=>{e.next()})}var Yc,Jc;(Jc=Yc||(Yc={})).Ma="default",Jc.Cache="cache";class $c{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Uc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Uc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Yc.Cache}}class Zc{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}class eu{constructor(e){this.serializer=e}$s(e){return Ls(this.serializer,e)}Us(e){return e.metadata.exists?Us(this.serializer,e.document,!1):lr.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return As(e)}}class tu{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=nu(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const n=K.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,r({},this.progress)):null}za(e){const t=new Map,n=new eu(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.$s(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||gi()).add(e);t.set(n,r)}}return t}async ja(e){const t=await async function(e,t,n,r){const i=_(e);let s=gi(),o=ai();for(const c of n){const e=t.$s(c.metadata.name);c.document&&(s=s.add(e));const n=t.Us(c);n.setReadTime(t.Ks(c.metadata.readTime)),o=o.insert(e,n)}const a=i.Ns.newChangeBuffer({trackRemovals:!0}),l=await yl(i,function(e){return Qr(qr(K.fromString("__bundle__/docs/".concat(e))))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",e=>ml(e,a,o).next(t=>(a.apply(e),t)).next(t=>i.Pi.removeMatchingKeysForTargetId(e,l.targetId).next(()=>i.Pi.addMatchingKeys(e,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(e,t.ks,t.qs)).next(()=>t.ks)))}(e,new eu(this.serializer),this.Wa,this.Ua.id),n=this.za(this.documents);for(const r of this.Ka)await _l(e,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function nu(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ru{constructor(e){this.key=e}}class iu{constructor(e){this.key=e}}class su{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gi(),this.mutatedKeys=gi(),this.eu=ri(e),this.tu=new Vc(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new zc,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=ti(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.eu(u,a)>0||l&&this.eu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return w(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const o=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,l=a!==this.Za;return this.Za=a,0!==s.length||l?{snapshot:new Uc(this.query,e.tu,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zc,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gi(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new iu(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new ru(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=gi();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Uc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const ou="SyncEngine";class au{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class lu{constructor(e){this.key=e,this.hu=!1}}class cu{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new si(e=>Zr(e),$r),this.Iu=new Map,this.Eu=new Set,this.du=new ln(X.comparator),this.Au=new Map,this.Ru=new za,this.Vu={},this.mu=new Map,this.fu=da.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function uu(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Vu(e);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await du(r,t,n,!0),i}async function hu(e,t){const n=Vu(e);await du(n,t,!0,!1)}async function du(e,t,n,r){const i=await yl(e.localStore,Qr(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await fu(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&uc(e.remoteStore,i),a}async function fu(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await bl(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Tu(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const s=await bl(e.localStore,t,!0),o=new su(t,s.Qs),a=o.ru(s.documents),l=ps.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);Tu(e,n,c.au);const u=new au(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function pu(e,t,n){const r=_(e),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(e=>!$r(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await vl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&hc(r.remoteStore,i.targetId),_u(r,i.targetId)}).catch(Ee)):(_u(r,i.targetId),await vl(r.localStore,i.targetId,!0))}async function mu(e,t){const n=_(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),hc(n.remoteStore,r.targetId))}async function gu(e,t){const n=_(e);try{const e=await function(e,t){const n=_(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(gn.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&o.push(n.Pi.updateTargetData(e,c))});let a=ai(),l=gi();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(ml(e,s,t.documentUpdates).next(e=>{a=e.ks,l=e.qs})),!r.isEqual(ce.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Te.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(S(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?S(r.hu,14607):e.removedDocuments.size>0&&(S(r.hu,42227),r.hu=!1))}),await Cu(n,e,t)}catch(e){await Ee(e)}}function yu(e,t,n){const r=_(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=_(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&Xc(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function vu(e,t,n){const r=_(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),s=i&&i.key;if(s){let e=new ln(X.comparator);e=e.insert(s,lr.newNoDocument(s,ce.min()));const n=gi().add(s),i=new fs(ce.min(),new Map,new ln(j),e,n);await gu(r,i),r.du=r.du.remove(s),r.Au.delete(t),Iu(r)}else await vl(r.localStore,t,!1).then(()=>_u(r,t,n)).catch(Ee)}async function bu(e,t){const n=_(e),r=t.batch.batchId;try{const e=await function(e,t){const n=_(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Te.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);S(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=gi();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Su(n,r,null),xu(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Cu(n,e)}catch(e){await Ee(e)}}async function wu(e,t,n){const r=_(e);try{const e=await function(e,t){const n=_(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(S(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Su(r,t,n),xu(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Cu(r,e)}catch(n){await Ee(n)}}function xu(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Su(e,t,n){const r=_(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function _u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Eu(e,t)})}function Eu(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(hc(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Iu(e))}function Tu(e,t,n){for(const r of n)r instanceof ru?(e.Ru.addReference(r.key,t),ku(e,r)):r instanceof iu?(g(ou,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Eu(e,r.key)):w(19791,{wu:r})}function ku(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(g(ou,"New document in limbo: "+n),e.Eu.add(r),Iu(e))}function Iu(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new X(K.fromString(t)),r=e.fu.next();e.Au.set(r,new lu(n)),e.du=e.du.insert(n,r),uc(e.remoteStore,new ro(Qr(qr(n.path)),r,"TargetPurposeLimboResolution",ze.ce))}}async function Cu(e,t,n){const r=_(e),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{o.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const i=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=al.As(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(e,t){const n=_(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Te.forEach(t,t=>Te.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Te.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Me(e))throw e;g(ul,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,s))}async function Nu(e,t){const n=_(e);if(!n.currentUser.isEqual(t)){g(ou,"User change. New user:",t.toKey());const e=await fl(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new T(E.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Cu(n,e.Ls)}}function Au(e,t){const n=_(e),r=n.Au.get(t);if(r&&r.hu)return gi().add(r.key);{let e=gi();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}async function Du(e,t){const n=_(e),r=await bl(n.localStore,t.query,!0),i=t.view.cu(r);return n.isPrimaryClient&&Tu(n,t.targetId,i.au),i}async function Mu(e,t){const n=_(e);return xl(n.localStore,t).then(e=>Cu(n,e))}async function Ou(e,t,n,r){const i=_(e),s=await function(e,t){const n=_(e),r=_(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.er(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):Te.resolve(null)))}(i.localStore,t);null!==s?("pending"===n?await Ec(i.remoteStore):"acknowledged"===n||"rejected"===n?(Su(i,t,r||null),xu(i,t),function(e,t){_(_(e).mutationQueue).ir(t)}(i.localStore,t)):w(6720,"Unknown batchState",{Su:n}),await Cu(i,s)):g(ou,"Cannot apply mutation batch with id: "+t)}async function Pu(e,t,n){const r=_(e),i=[],s=[];for(const o of t){let e;const t=r.Iu.get(o);if(t&&0!==t.length){e=await yl(r.localStore,Qr(t[0]));for(const e of t){const t=r.Tu.get(e),n=await Du(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await wl(r.localStore,o);e=await yl(r.localStore,t),await fu(r,Lu(t),o,!1,e.resumeToken)}i.push(e)}return r.Pu.H_(s),i}function Lu(e){return Br(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Ru(e){return function(e){return _(_(e).persistence).Ts()}(_(e).localStore)}async function ju(e,t,n,r){const i=_(e);if(i.gu)return void g(ou,"Ignoring unexpected query state notification.");const s=i.Iu.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await xl(i.localStore,ni(s[0])),r=fs.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,gn.EMPTY_BYTE_STRING);await Cu(i,e,r);break}case"rejected":await vl(i.localStore,t,!0),_u(i,t,r);break;default:w(64155,n)}}async function Fu(e,t,n){const r=Vu(e);if(r.gu){for(const e of t){if(r.Iu.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){g(ou,"Adding an already active target "+e);continue}const t=await wl(r.localStore,e),n=await yl(r.localStore,t);await fu(r,Lu(t),n.targetId,!1,n.resumeToken),uc(r.remoteStore,n)}for(const e of n)r.Iu.has(e)&&await vl(r.localStore,e,!1).then(()=>{hc(r.remoteStore,e),_u(r,e)}).catch(Ee)}}function Vu(e){const t=_(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=gu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Au.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=vu.bind(null,t),t.Pu.H_=Qc.bind(null,t.eventManager),t.Pu.yu=Wc.bind(null,t.eventManager),t}function zu(e){const t=_(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=bu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=wu.bind(null,t),t}class Uu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return dl(this.persistence,new cl,e.initialUser,this.serializer)}Cu(e){return new Ka(Wa.mi,this.serializer)}Du(e){return new jl}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uu.provider={build:()=>new Uu};class Bu extends Uu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){S(this.persistence.referenceDelegate instanceof Xa,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xa(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?ia.withCacheSize(this.cacheSizeBytes):ia.DEFAULT;return new Ka(e=>Xa.mi(e,t),this.serializer)}}class qu extends Uu{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await zu(this.xu.syncEngine),await Ec(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return dl(this.persistence,new cl,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new xa(n,e.asyncQueue,t)}Mu(e,t){const n=new Ve(t,this.persistence);return new Fe(e.asyncQueue,n)}Cu(e){const t=ol(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ia.withCacheSize(this.cacheSizeBytes):ia.DEFAULT;return new rl(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Xl(),Yl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new jl}}class Gu extends qu{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Rl&&(this.sharedClientState.syncEngine={Co:Ou.bind(null,t),vo:ju.bind(null,t),Fo:Fu.bind(null,t),Ts:Ru.bind(null,t),Do:Mu.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async e=>{await async function(e,t){const n=_(e);if(Vu(n),zu(n),!0===t&&!0!==n.gu){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Pu(n,e.toArray());n.gu=!0,await Pc(n.remoteStore,!0);for(const r of t)uc(n.remoteStore,r)}else if(!1===t&&!1!==n.gu){const e=[];let t=Promise.resolve();n.Iu.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(_u(n,i),vl(n.localStore,i,!0))),hc(n.remoteStore,i)}),await t,await Pu(n,e),function(e){const t=_(e);t.Au.forEach((e,n)=>{hc(t.remoteStore,n)}),t.Ru.Jr(),t.Au=new Map,t.du=new ln(X.comparator)}(n),n.gu=!1,await Pc(n.remoteStore,!1)}}(this.xu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Du(e){const t=Xl();if(!Rl.v(t))throw new T(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=ol(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Rl(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Hu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>yu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Nu.bind(null,this.syncEngine),await Pc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new qc}createDatastore(e){const t=Jl(e.databaseInfo.databaseId),n=function(e){return new Wl(e)}(e.databaseInfo);return function(e,t,n,r){return new ic(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ac(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>yu(this.syncEngine,e,0),zl.v()?new zl:new Fl)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new cu(e,t,n,r,i,s);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=_(e);g(oc,"RemoteStore shutting down."),t.Ea.add(5),await cc(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}function Ku(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}Hu.provider={build:()=>new Hu};class Qu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):y("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Wu{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new k,this.buffer=new Uint8Array,this.Lu=new TextDecoder("utf-8"),this.ku().then(e=>{e&&e.$a()?this.metadata.resolve(e.Qa.metadata):this.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null===e||void 0===e?void 0:e.Qa))))},e=>this.metadata.reject(e))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(null===e)return null;const t=this.Lu.decode(e),n=Number(t);isNaN(n)&&this.Qu("length string (".concat(t,") is not valid number"));const r=await this.$u(n);return new Zc(JSON.parse(r),e.length+n)}Uu(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(0===this.buffer.length)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error("Invalid bundle format: ".concat(e))}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Xu{constructor(e,t){var n;this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.bu();if(!r||!r.$a())throw new Error("The first element of the bundle is not a metadata object, it is\n         ".concat(JSON.stringify(null===(n=r)||void 0===n?void 0:n.Qa)));this.metadata=r;do{r=this.bu(),null!==r&&this.elements.push(r)}while(null!==r)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),t=this.$u(e);return new Zc(JSON.parse(t),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new T(E.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}class Yu{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new T(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=_(e),r={documents:t.map(e=>Ps(n.serializer,e))},i=await n.Ho("BatchGetDocuments",n.serializer.databaseId,K.emptyPath(),r,t.length),s=new Map;i.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){S(!!t.found,43571),t.found.name,t.found.updateTime;const n=Ls(e,t.found.name),r=As(t.found.updateTime),i=t.found.createTime?As(t.found.createTime):ce.min(),s=new or({mapValue:{fields:t.found.fields}});return lr.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){S(!!t.missing,3894),S(!!t.readTime,22933);const n=Ls(e,t.missing),r=As(t.readTime);return lr.newNoDocument(n,r)}(e,t):w(7234,{result:t})}(n.serializer,e);s.set(t.key.toString(),t)});const o=[];return t.forEach(e=>{const t=s.get(e.toString());S(!!t,55234,{key:e}),o.push(t)}),o}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=X.fromPath(t);this.mutations.push(new Yi(n,this.precondition(n)))}),await async function(e,t){const n=_(e),r={writes:t.map(e=>Bs(n.serializer,e))};await n.Go("Commit",n.serializer.databaseId,K.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw w(50498,{Gu:e.constructor.name});t=ce.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new T(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ce.min())?Ri.exists(!1):Ri.updateTime(t):Ri.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ce.min()))throw new T(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ri.updateTime(t)}return Ri.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Ju{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.zu=n.maxAttempts,this.M_=new $l(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new Yu(this.datastore),t=this.Hu(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Yu(e)}))}).catch(e=>{this.Yu(e)})})}Hu(e){try{const t=this.updateFunction(e);return!Be(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if("FirebaseError"===(null===e||void 0===e?void 0:e.name)){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!is(t)}return!1}}const $u="FirestoreClient";class Zu{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=d.UNAUTHENTICATED,this.clientId=R.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{g($u,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(g($u,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new k;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Fc(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function eh(e,t){e.asyncQueue.verifyOperationInProgress(),g($u,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await fl(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function th(e,t){e.asyncQueue.verifyOperationInProgress();const n=await nh(e);g($u,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Oc(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Oc(t.remoteStore,n)),e._onlineComponents=t}async function nh(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){g($u,"Using user provided OfflineComponentProvider");try{await eh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===E.FAILED_PRECONDITION||e.code===E.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;v("Error using user provided cache. Falling back to memory cache: "+n),await eh(e,new Uu)}}else g($u,"Using default OfflineComponentProvider"),await eh(e,new Bu(void 0));return e._offlineComponents}async function rh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(g($u,"Using user provided OnlineComponentProvider"),await th(e,e._uninitializedComponentsProvider._online)):(g($u,"Using default OnlineComponentProvider"),await th(e,new Hu))),e._onlineComponents}function ih(e){return nh(e).then(e=>e.persistence)}function sh(e){return nh(e).then(e=>e.localStore)}function oh(e){return rh(e).then(e=>e.remoteStore)}function ah(e){return rh(e).then(e=>e.syncEngine)}function lh(e){return rh(e).then(e=>e.datastore)}async function ch(e){const t=await rh(e),n=t.eventManager;return n.onListen=uu.bind(null,t.syncEngine),n.onUnlisten=pu.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=hu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=mu.bind(null,t.syncEngine),n}function uh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new k;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Qu({next:a=>{s.Nu(),t.enqueueAndForget(()=>Kc(e,o));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new T(E.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new T(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new $c(qr(n.path),s,{includeMetadataChanges:!0,qa:!0});return Hc(e,o)}(await ch(e),e.asyncQueue,t,n,r)),r.promise}function hh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new k;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Qu({next:n=>{s.Nu(),t.enqueueAndForget(()=>Kc(e,o)),n.fromCache&&"server"===r.source?i.reject(new T(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new $c(n,s,{includeMetadataChanges:!0,qa:!0});return Hc(e,o)}(await ch(e),e.asyncQueue,t,n,r)),r.promise}function dh(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?as().encode(e):e,function(e,t){return new Wu(e,t)}(function(e,t){if(e instanceof Uint8Array)return Ku(e,t);if(e instanceof ArrayBuffer)return Ku(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,Jl(t));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){const r=_(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=_(e),r=As(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Ii.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(nu(r));const i=new tu(r,t.serializer);let s=await t.bu();for(;s;){const e=await i.Ga(s);e&&n._updateProgress(e),s=await t.bu()}const o=await i.ja(e.localStore);return await Cu(e,o.Ha,void 0),await function(e,t){const n=_(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.Ii.saveBundleMetadata(e,t))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.Ja)}catch(e){return v(ou,"Loading bundle failed with ".concat(e)),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then(e=>{r.sharedClientState.notifyBundleLoaded(e)})}(await ah(e),i,r)})}function fh(e,t){return function(e,t){return new Xu(e,t)}(e,t)}function ph(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const mh=new Map,gh="firestore.googleapis.com",yh=!0;class vh{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new T(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gh,this.ssl=yh}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:yh;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=ra;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<va)throw new T(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}J("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ph(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new T(E.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new T(E.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new T(E.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bh{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new T(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new T(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vh(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new C;switch(e.type){case"firstParty":return new M(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new T(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=mh.get(e);t&&(g("ComponentProvider","Removing Datastore"),mh.delete(e),t.terminate())}(this),Promise.resolve()}}function wh(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=ne(e,bh);const s=a.isCloudWorkstation(t),o=e._getSettings(),l=r(r({},o),{},{emulatorOptions:e._getEmulatorOptions()}),c="".concat(t,":").concat(n);s&&(a.pingServer("https://".concat(c)),a.updateEmulatorBanner("Firestore",!0)),o.host!==gh&&o.host!==c&&v("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=r(r({},o),{},{host:c,ssl:s,emulatorOptions:i});if(!a.deepEqual(u,l)&&(e._setSettings(u),i.mockUserToken)){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=d.MOCK_USER;else{var h;t=a.createMockUserToken(i.mockUserToken,null===(h=e._app)||void 0===h?void 0:h.options.projectId);const r=i.mockUserToken.sub||i.mockUserToken.user_id;if(!r)throw new T(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new d(r)}e._authCredentials=new N(new I(t,n))}}class xh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new xh(this.firestore,e,this._query)}}class Sh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _h(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sh(this.firestore,e,this._key)}toJSON(){return{type:Sh._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(se(t,Sh._jsonSchema))return new Sh(e,n||null,new X(K.fromString(t.referencePath)))}}Sh._jsonSchemaVersion="firestore/documentReference/1.0",Sh._jsonSchema={type:ie("string",Sh._jsonSchemaVersion),referencePath:ie("string")};class _h extends xh{constructor(e,t,n){super(e,t,qr(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sh(this.firestore,null,new X(e))}withConverter(e){return new _h(this.firestore,e,this._path)}}function Eh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=a.getModularInstance(e),1===arguments.length&&(t=R.newId()),Y("doc","path",t),e instanceof bh){const n=K.fromString(t,...r);return $(n),new Sh(e,null,new X(n))}{if(!(e instanceof Sh||e instanceof _h))throw new T(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(K.fromString(t,...r));return $(n),new Sh(e.firestore,e instanceof _h?e.converter:null,new X(n))}}function Th(e,t){return e=a.getModularInstance(e),t=a.getModularInstance(t),e instanceof xh&&t instanceof xh&&e.firestore===t.firestore&&$r(e._query,t._query)&&e.converter===t.converter}const kh="AsyncQueue";class Ih{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new $l(this,"async_queue_retry"),this._c=()=>{const e=Yl();e&&g(kh,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Yl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Yl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new k;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Me(e))throw e;g(kh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,y("INTERNAL UNHANDLED ERROR: ",Ch(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=jc.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&w(47125,{Pc:Ch(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Ch(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Nh(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Ah{constructor(){this._progressObserver={},this._taskCompletionResolver=new k,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Dh extends bh{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Ih,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ih(e),this._firestoreClient=void 0,await e}}}function Mh(e){if(e._terminated)throw new T(E.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Oh(e),e._firestoreClient}function Oh(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Cn(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,ph(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Zu(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Ph(e,t,n){if((e=ne(e,Dh))._firestoreClient||e._terminated)throw new T(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new T(E.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Oh(e)}function Lh(e,t){const n=Mh(e=ne(e,Dh)),r=new Ah;return dh(n,e._databaseId,t,r),r}function Rh(e,t){return function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){const n=_(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.Ii.getNamedQuery(e,t))}(await sh(e),t))}(Mh(e=ne(e,Dh)),t).then(t=>t?new xh(e,null,t.query):null)}class jh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",t=arguments.length>1?arguments[1]:void 0;this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class Fh{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Vh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vh(gn.fromBase64String(e))}catch(e){throw new T(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Vh(gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vh._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(se(e,Vh._jsonSchema))return Vh.fromBase64String(e.bytes)}}Vh._jsonSchemaVersion="firestore/bytes/1.0",Vh._jsonSchema={type:ie("string",Vh._jsonSchemaVersion),bytes:ie("string")};class zh{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new T(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new W(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uh{constructor(e){this._methodName=e}}class Bh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new T(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new T(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return j(this._lat,e._lat)||j(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bh._jsonSchemaVersion}}static fromJSON(e){if(se(e,Bh._jsonSchema))return new Bh(e.latitude,e.longitude)}}Bh._jsonSchemaVersion="firestore/geoPoint/1.0",Bh._jsonSchema={type:ie("string",Bh._jsonSchemaVersion),latitude:ie("number"),longitude:ie("number")};class qh{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qh._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(se(e,qh._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new qh(e.vectorValues);throw new T(E.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qh._jsonSchemaVersion="firestore/vectorValue/1.0",qh._jsonSchema={type:ie("string",qh._jsonSchemaVersion),vectorValues:ie("object")};const Gh=/^__.*__$/;class Hh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Hi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gi(e,this.data,t,this.fieldTransforms)}}class Kh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Hi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw w(40011,{Ac:e})}}class Wh{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wh(r(r({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return pd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Qh(this.Ac)&&Gh.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Xh{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Jl(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Wh({Ac:e,methodName:t,Dc:n,path:W.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yh(e){const t=e._freezeSettings(),n=Jl(e._databaseId);return new Xh(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Jh(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Cc(s.merge||s.mergeFields?2:0,t,n,i);ud("Data must be an object, but it was:",o,r);const a=ld(r,o);let l,c;if(s.merge)l=new pn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=hd(t,r,n);if(!o.contains(i))throw new T(E.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));md(e,i)||e.push(i)}l=new pn(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new Hh(new or(a),l,c)}class $h extends Uh{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $h}}function Zh(e,t,n){return new Wh({Ac:3,Dc:t.settings.Dc,methodName:e._methodName,fc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class ed extends Uh{_toFieldTransform(e){return new Pi(e.path,new ki)}isEqual(e){return e instanceof ed}}class td extends Uh{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Zh(this,e,!0),n=this.vc.map(e=>ad(e,t)),r=new Ii(n);return new Pi(e.path,r)}isEqual(e){return e instanceof td&&a.deepEqual(this.vc,e.vc)}}class nd extends Uh{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Zh(this,e,!0),n=this.vc.map(e=>ad(e,t)),r=new Ni(n);return new Pi(e.path,r)}isEqual(e){return e instanceof nd&&a.deepEqual(this.vc,e.vc)}}class rd extends Uh{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Di(e.serializer,xi(e.serializer,this.Fc));return new Pi(e.path,t)}isEqual(e){return e instanceof rd&&this.Fc===e.Fc}}function id(e,t,n,r){const i=e.Cc(1,t,n);ud("Data must be an object, but it was:",i,r);const s=[],o=or.empty();sn(r,(e,r)=>{const l=fd(t,e,n);r=a.getModularInstance(r);const c=i.yc(l);if(r instanceof $h)s.push(l);else{const e=ad(r,c);null!=e&&(s.push(l),o.set(l,e))}});const l=new pn(s);return new Kh(o,l,i.fieldTransforms)}function sd(e,t,n,r,i,s){const o=e.Cc(1,t,n),l=[hd(t,r,n)],c=[i];if(s.length%2!=0)throw new T(E.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let a=0;a<s.length;a+=2)l.push(hd(t,s[a])),c.push(s[a+1]);const u=[],h=or.empty();for(let f=l.length-1;f>=0;--f)if(!md(u,l[f])){const e=l[f];let t=c[f];t=a.getModularInstance(t);const n=o.yc(e);if(t instanceof $h)u.push(e);else{const r=ad(t,n);null!=r&&(u.push(e),h.set(e,r))}}const d=new pn(u);return new Kh(h,d,o.fieldTransforms)}function od(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ad(n,e.Cc(r?4:3,t))}function ad(e,t){if(cd(e=a.getModularInstance(e)))return ud("Unsupported field value:",t,e),ld(e,t);if(e instanceof Uh)return function(e,t){if(!Qh(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=ad(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=a.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return xi(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=le.fromDate(e);return{timestampValue:Is(t.serializer,n)}}if(e instanceof le){const n=new le(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Is(t.serializer,n)}}if(e instanceof Bh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Vh)return{bytesValue:Cs(t.serializer,e._byteString)};if(e instanceof Sh){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Ds(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof qh)return function(e,t){return{mapValue:{fields:{[Dn]:{stringValue:Pn},[Ln]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return bi(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(te(e)))}(e,t)}function ld(e,t){const n={};return an(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):sn(e,(e,r)=>{const i=ad(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function cd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof le||e instanceof Bh||e instanceof Vh||e instanceof Sh||e instanceof Uh||e instanceof qh)}function ud(e,t,n){if(!cd(n)||!ee(n)){const r=te(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function hd(e,t,n){if((t=a.getModularInstance(t))instanceof zh)return t._internalPath;if("string"==typeof t)return fd(e,t);throw pd("Field path arguments must be of type string or ",e,!1,void 0,n)}const dd=new RegExp("[~\\*/\\[\\]]");function fd(e,t,n){if(t.search(dd)>=0)throw pd("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new zh(...t.split("."))._internalPath}catch(r){throw pd("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function pd(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(r)),o&&(l+=" in document ".concat(i)),l+=")"),new T(E.INVALID_ARGUMENT,a+e+l)}function md(e,t){return e.some(e=>e.isEqual(t))}class gd{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Sh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new yd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(vd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class yd extends gd{data(){return super.data()}}function vd(e,t){return"string"==typeof t?fd(e,t):t instanceof zh?t._internalPath:t._delegate._internalPath}function bd(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new T(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wd{}class xd extends wd{}class Sd extends xd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Sd(e,t,n)}_apply(e){const t=this._parse(e);return Dd(e._query,t),new xh(e.firestore,e.converter,Yr(e._query,t))}_parse(e){const t=Yh(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new T(E.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Ad(o,s);const t=[];for(const n of o)t.push(Nd(r,e,n));a={arrayValue:{values:t}}}else a=Nd(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Ad(o,s),a=od(n,t,o,"in"===s||"not-in"===s);return mr.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class _d extends wd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _d(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:gr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Dd(n,i),n=Yr(n,i)}(e._query,t),new xh(e.firestore,e.converter,Yr(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ed extends xd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ed(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new T(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new T(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new dr(t,n)}(e._query,this._field,this._direction);return new xh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Ur(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Td extends xd{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Td(e,t,n)}_apply(e){return new xh(e.firestore,e.converter,Jr(e._query,this._limit,this._limitType))}}class kd extends xd{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new kd(e,t,n)}_apply(e){const t=Cd(e,this.type,this._docOrFields,this._inclusive);return new xh(e.firestore,e.converter,function(e,t){return new Ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class Id extends xd{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Id(e,t,n)}_apply(e){const t=Cd(e,this.type,this._docOrFields,this._inclusive);return new xh(e.firestore,e.converter,function(e,t){return new Ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Cd(e,t,n,r){if(n[0]=a.getModularInstance(n[0]),n[0]instanceof gd)return function(e,t,n,r,i){if(!r)throw new T(E.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const s=[];for(const o of Kr(e))if(o.field.isKeyField())s.push(Kn(t,r.key));else{const e=r.data.field(o.field);if(Tn(e))throw new T(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new T(E.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new cr(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Yh(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new T(E.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const a=[];for(let l=0;l<i.length;l++){const s=i[l];if(o[l].field.isKeyField()){if("string"!=typeof s)throw new T(E.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof s));if(!Hr(e)&&-1!==s.indexOf("/"))throw new T(E.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const n=e.path.child(K.fromString(s));if(!X.isDocumentKey(n))throw new T(E.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const i=new X(n);a.push(Kn(t,i))}else{const e=od(n,r,s);a.push(e)}}return new cr(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Nd(e,t,n){if("string"==typeof(n=a.getModularInstance(n))){if(""===n)throw new T(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hr(t)&&-1!==n.indexOf("/"))throw new T(E.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(K.fromString(n));if(!X.isDocumentKey(r))throw new T(E.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Kn(e,new X(r))}if(n instanceof Sh)return Kn(e,n._key);throw new T(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(te(n),"."))}function Ad(e,t){if(!Array.isArray(e)||0===e.length)throw new T(E.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Dd(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new T(E.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new T(E.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}function Md(e,t){if(!(t instanceof Sd||t instanceof _d))throw new T(E.INVALID_ARGUMENT,"Function ".concat(e,"() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'."))}class Od{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(jn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw w(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return sn(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[Ln].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>bn(e.doubleValue));return new qh(n)}convertGeoPoint(e){return new Bh(bn(e.latitude),bn(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=kn(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(In(e));default:return null}}convertTimestamp(e){const t=vn(e);return new le(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=K.fromString(e);S(no(n),9688,{name:e});const r=new An(n.get(1),n.get(3)),i=new X(n.popFirst(5));return r.isEqual(t)||y("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Pd(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Ld extends Od{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sh(this.firestore,null,t)}}function Rd(){return new jh("count")}const jd="NOT SUPPORTED";class Fd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vd extends gd{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new zd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(vd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new T(E.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Vd._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Vd._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vd._jsonSchema={type:ie("string",Vd._jsonSchemaVersion),bundleSource:ie("string","DocumentSnapshot"),bundleName:ie("string"),bundle:ie("string")};class zd extends Vd{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ud{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Fd(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new zd(this._firestore,this._userDataWriter,n.key,n,new Fd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new T(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new zd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Fd(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new zd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Fd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Bd(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new T(E.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ud._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=R.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Bd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return w(61501,{type:e})}}Ud._jsonSchemaVersion="firestore/querySnapshot/1.0",Ud._jsonSchema={type:ie("string",Ud._jsonSchemaVersion),bundleSource:ie("string","QuerySnapshot"),bundleName:ie("string"),bundle:ie("string")};class qd extends Od{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sh(this.firestore,null,t)}}function Gd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=a.getModularInstance(e);let i={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof n[s]||Nh(n[s])||(i=n[s++]);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Nh(n[s])){var l,c,u;const e=n[s];n[s]=null===(l=e.next)||void 0===l?void 0:l.bind(e),n[s+1]=null===(c=e.error)||void 0===c?void 0:c.bind(e),n[s+2]=null===(u=e.complete)||void 0===u?void 0:u.bind(e)}let h,d,f;if(e instanceof Sh)d=ne(e.firestore,Dh),f=qr(e._key.path),h={next:t=>{n[s]&&n[s](Kd(d,e,t))},error:n[s+1],complete:n[s+2]};else{const t=ne(e,xh);d=ne(t.firestore,Dh),f=t._query;const r=new qd(d);h={next:e=>{n[s]&&n[s](new Ud(d,r,t,e))},error:n[s+1],complete:n[s+2]},bd(e._query)}return function(e,t,n,r){const i=new Qu(r),s=new $c(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>Hc(await ch(e),s)),()=>{i.Nu(),e.asyncQueue.enqueueAndForget(async()=>Kc(await ch(e),s))}}(Mh(d),f,o,h)}function Hd(e,t){return function(e,t){const n=new k;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=zu(e);try{const e=await function(e,t){const n=_(e),r=le.now(),i=t.reduce((e,t)=>e.add(t.key),gi());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=ai(),l=gi();return n.Ns.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Bi(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Hi(e.key,t,ar(t.value.mapValue),Ri.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:ui(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new ln(j)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Cu(r,e.changes),await Ec(r.remoteStore)}catch(e){const t=Fc(e,"Failed to persist write");n.reject(t)}}(await ah(e),t,n)),n.promise}(Mh(e),t)}function Kd(e,t,n){const r=n.docs.get(t._key),i=new qd(e);return new Vd(e,i,t._key,r,new Fd(n.hasPendingWrites,n.fromCache),t.converter)}function Qd(e,t){const n=ne(e.firestore,Dh),r=Mh(n),i=on(t,(e,t)=>new es(t,e.aggregateType,e._internalFieldPath));return function(e,t,n){const r=new k;return e.asyncQueue.enqueueAndForget(async()=>{try{const i=await lh(e);r.resolve(async function(e,t,n){var r;const i=_(e),{request:s,gt:o,parent:a}=Ks(i.serializer,Wr(t),n);i.connection.$o||delete s.parent;const l=(await i.Ho("RunAggregationQuery",i.serializer.databaseId,a,s,1)).filter(e=>!!e.result);S(1===l.length,64727);const c=null===(r=l[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(c).reduce((e,t)=>(e[o[t]]=c[t],e),{})}(i,t,n))}catch(e){r.reject(e)}}),r.promise}(r,e._query,i).then(t=>function(e,t,n){const r=new qd(e);return new Fh(t,r,n)}(n,e,t))}class Wd{constructor(e){this.kind="memory",this._onlineComponentProvider=Hu.provider,this._offlineComponentProvider=null!==e&&void 0!==e&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new Bu(void 0)}}toJSON(){return{kind:this.kind}}}class Xd{constructor(e){let t;this.kind="persistent",null!==e&&void 0!==e&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=ef(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Yd{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Uu.provider}toJSON(){return{kind:this.kind}}}class Jd{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Bu(e)}}toJSON(){return{kind:this.kind}}}class $d{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Hu.provider,this._offlineComponentProvider={build:t=>new qu(t,null===e||void 0===e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Zd{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Hu.provider,this._offlineComponentProvider={build:t=>new Gu(t,null===e||void 0===e?void 0:e.cacheSizeBytes)}}}function ef(e){return new $d(null===e||void 0===e?void 0:e.forceOwnership)}const tf={maxAttempts:5};class nf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Yh(e)}set(e,t,n){this._verifyNotCommitted();const r=rf(e,this._firestore),i=Pd(r.converter,t,n),s=Jh(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Ri.none())),this}update(e,t,n){this._verifyNotCommitted();const r=rf(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return i="string"==typeof(t=a.getModularInstance(t))||t instanceof zh?sd(this._dataReader,"WriteBatch.update",r._key,t,n,o):id(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Ri.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=rf(e,this._firestore);return this._mutations=this._mutations.concat(new Xi(t._key,Ri.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new T(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function rf(e,t){if((e=a.getModularInstance(e)).firestore!==t)throw new T(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class sf{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Yh(e)}get(e){const t=rf(e,this._firestore),n=new Ld(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return w(24041);const r=e[0];if(r.isFoundDocument())return new gd(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new gd(this._firestore,n,t._key,null,t.converter);throw w(18433,{doc:r})})}set(e,t,n){const r=rf(e,this._firestore),i=Pd(r.converter,t,n),s=Jh(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=rf(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return i="string"==typeof(t=a.getModularInstance(t))||t instanceof zh?sd(this._dataReader,"Transaction.update",r._key,t,n,o):id(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=rf(e,this._firestore);return this._transaction.delete(t._key),this}}class of extends sf{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=rf(e,this._firestore),n=new qd(this._firestore);return super.get(e).then(e=>new Vd(this._firestore,n,t._key,e._document,new Fd(!1,!1),t.converter))}}function af(e,t){if("string"!=typeof e[t])throw new T(E.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class lf{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function cf(e,t){(function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){_(e).Fs.Vs=t}(await sh(e),t))})(Mh(e._firestore),t).then(e=>g("setting persistent cache index auto creation isEnabled=".concat(t," succeeded"))).catch(e=>v("setting persistent cache index auto creation isEnabled=".concat(t," failed"),e))}const uf=new WeakMap;class hf{constructor(){this.Mc=new Map}static get instance(){return df||(df=new hf,function(e){if(os)throw new Error("a TestingHooksSpi instance is already set");os=e}(df)),df}lt(e){this.Mc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Mc;return n.set(t,e),()=>n.delete(t)}}let df=null;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){f=e}(i.SDK_VERSION),i._registerComponent(new s.Component("firestore",(e,n)=>{let{instanceIdentifier:i,options:s}=n;const o=e.getProvider("app").getImmediate(),a=new Dh(new A(e.getProvider("auth-internal")),new P(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new T(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new An(e.options.projectId,t)}(o,i),o);return s=r({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),i.registerVersion(u,h,e),i.registerVersion(u,h,"cjs2020")}(),t.AbstractUserDataWriter=Od,t.AggregateField=jh,t.AggregateQuerySnapshot=Fh,t.Bytes=Vh,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=_h,t.DocumentReference=Sh,t.DocumentSnapshot=Vd,t.FieldPath=zh,t.FieldValue=Uh,t.Firestore=Dh,t.FirestoreError=T,t.GeoPoint=Bh,t.LoadBundleTask=Ah,t.PersistentCacheIndexManager=lf,t.Query=xh,t.QueryCompositeFilterConstraint=_d,t.QueryConstraint=xd,t.QueryDocumentSnapshot=zd,t.QueryEndAtConstraint=Id,t.QueryFieldFilterConstraint=Sd,t.QueryLimitConstraint=Td,t.QueryOrderByConstraint=Ed,t.QuerySnapshot=Ud,t.QueryStartAtConstraint=kd,t.SnapshotMetadata=Fd,t.Timestamp=le,t.Transaction=of,t.VectorValue=qh,t.WriteBatch=nf,t._AutoId=R,t._ByteString=gn,t._DatabaseId=An,t._DocumentKey=X,t._EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new O(""))}invalidateToken(){}start(e,t){}shutdown(){}},t._EmptyAuthCredentialsProvider=C,t._FieldPath=W,t._TestingHooks=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return hf.instance.onExistenceFilterMismatch(e)}},t._cast=ne,t._debugAssert=function(e,t){e||w(57014,t)},t._internalAggregationQueryToProtoRunAggregationQueryRequest=function(e,t){var n;const r=on(t,(e,t)=>new es(t,e.aggregateType,e._internalFieldPath)),i=null===(n=Mh(ne(e.firestore,Dh))._onlineComponents)||void 0===n?void 0:n.datastore.serializer;return void 0===i?null:Ks(i,Wr(e._query),r,!0).request},t._internalQueryToProtoQueryTarget=function(e){var t;const n=null===(t=Mh(ne(e.firestore,Dh))._onlineComponents)||void 0===t?void 0:t.datastore.serializer;return void 0===n?null:Hs(n,Qr(e._query)).ft},t._isBase64Available=function(){return"undefined"!=typeof atob},t._logWarn=v,t._validateIsNotUsedTogether=J,t.addDoc=function(e,t){const n=ne(e.firestore,Dh),r=Eh(e),i=Pd(e.converter,t);return Hd(n,[Jh(Yh(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Ri.exists(!1))]).then(()=>r)},t.aggregateFieldEqual=function(e,t){var n,r;return e instanceof jh&&t instanceof jh&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())},t.aggregateQuerySnapshotEqual=function(e,t){return Th(e.query,t.query)&&a.deepEqual(e.data(),t.data())},t.and=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(e=>Md("and",e)),_d._create("and",t)},t.arrayRemove=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new nd("arrayRemove",t)},t.arrayUnion=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new td("arrayUnion",t)},t.average=function(e){return new jh("avg",hd("average",e))},t.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new T(E.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new k;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!Ce.v())return Promise.resolve();const t=e+nl;await Ce.delete(t)}(ol(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise},t.collection=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=a.getModularInstance(e),Y("collection","path",t),e instanceof bh){const n=K.fromString(t,...r);return Z(n),new _h(e,null,n)}{if(!(e instanceof Sh||e instanceof _h))throw new T(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(K.fromString(t,...r));return Z(n),new _h(e.firestore,null,n)}},t.collectionGroup=function(e,t){if(e=ne(e,bh),Y("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new T(E.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new xh(e,null,function(e){return new Ur(K.emptyPath(),e)}(t))},t.connectFirestoreEmulator=wh,t.count=Rd,t.deleteAllPersistentCacheIndexes=function(e){(function(e){return e.asyncQueue.enqueue(async()=>function(e){const t=_(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",e=>n.deleteAllFieldIndexes(e))}(await sh(e)))})(Mh(e._firestore)).then(e=>g("deleting all persistent cache indexes succeeded")).catch(e=>v("deleting all persistent cache indexes failed",e))},t.deleteDoc=function(e){return Hd(ne(e.firestore,Dh),[new Xi(e._key,Ri.none())])},t.deleteField=function(){return new $h("deleteField")},t.disableNetwork=function(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await ih(e),n=await oh(e);return t.setNetworkEnabled(!1),async function(e){const t=_(e);t.Ea.add(0),await cc(t),t.Ra.set("Offline")}(n)})}(Mh(e=ne(e,Dh)))},t.disablePersistentCacheIndexAutoCreation=function(e){cf(e,!1)},t.doc=Eh,t.documentId=function(){return new zh(G)},t.documentSnapshotFromJSON=function(e,t,n){if(se(t,Vd._jsonSchema)){if(t.bundle===jd)throw new T(E.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Jl(e._databaseId),i=fh(t.bundle,r),s=i.Wu(),o=new tu(i.getMetadata(),r);for(const e of s)o.Ga(e);const a=o.documents;if(1!==a.length)throw new T(E.INVALID_ARGUMENT,"Expected bundle data to contain 1 document, but it contains ".concat(a.length," documents."));const l=Us(r,a[0].document),c=new X(K.fromString(t.bundleName));return new Vd(e,new Ld(e),c,l,new Fd(!1,!1),n||null)}},t.enableIndexedDbPersistence=function(e,t){v("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Ph(e,Hu.provider,{build:e=>new qu(e,n.cacheSizeBytes,null===t||void 0===t?void 0:t.forceOwnership)}),Promise.resolve()},t.enableMultiTabIndexedDbPersistence=async function(e){v("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();Ph(e,Hu.provider,{build:e=>new Gu(e,t.cacheSizeBytes)})},t.enableNetwork=function(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await ih(e),n=await oh(e);return t.setNetworkEnabled(!0),function(e){const t=_(e);return t.Ea.delete(0),lc(t)}(n)})}(Mh(e=ne(e,Dh)))},t.enablePersistentCacheIndexAutoCreation=function(e){cf(e,!0)},t.endAt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Id._create("endAt",t,!0)},t.endBefore=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Id._create("endBefore",t,!1)},t.ensureFirestoreConfigured=Mh,t.executeWrite=Hd,t.getAggregateFromServer=Qd,t.getCountFromServer=function(e){return Qd(e,{count:Rd()})},t.getDoc=function(e){e=ne(e,Sh);const t=ne(e.firestore,Dh);return uh(Mh(t),e._key).then(n=>Kd(t,e,n))},t.getDocFromCache=function(e){e=ne(e,Sh);const t=ne(e.firestore,Dh),n=Mh(t),r=new qd(t);return function(e,t){const n=new k;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await function(e,t){const n=_(e);return n.persistence.runTransaction("read document","readonly",e=>n.localDocuments.getDocument(e,t))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new T(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Fc(e,"Failed to get document '".concat(t," from cache"));n.reject(r)}}(await sh(e),t,n)),n.promise}(n,e._key).then(n=>new Vd(t,r,e._key,n,new Fd(null!==n&&n.hasLocalMutations,!0),e.converter))},t.getDocFromServer=function(e){e=ne(e,Sh);const t=ne(e.firestore,Dh);return uh(Mh(t),e._key,{source:"server"}).then(n=>Kd(t,e,n))},t.getDocs=function(e){e=ne(e,xh);const t=ne(e.firestore,Dh),n=Mh(t),r=new qd(t);return bd(e._query),hh(n,e._query).then(n=>new Ud(t,r,e,n))},t.getDocsFromCache=function(e){e=ne(e,xh);const t=ne(e.firestore,Dh),n=Mh(t),r=new qd(t);return function(e,t){const n=new k;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await bl(e,t,!0),i=new su(t,r.Qs),s=i.ru(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=Fc(e,"Failed to execute query '".concat(t," against cache"));n.reject(r)}}(await sh(e),t,n)),n.promise}(n,e._query).then(n=>new Ud(t,r,e,n))},t.getDocsFromServer=function(e){e=ne(e,xh);const t=ne(e.firestore,Dh),n=Mh(t),r=new qd(t);return hh(n,e._query,{source:"server"}).then(n=>new Ud(t,r,e,n))},t.getFirestore=function(e,t){const n="object"==typeof e?e:i.getApp(),r="string"==typeof e?e:t||Nn,s=i._getProvider(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const e=a.getDefaultEmulatorHostnameAndPort("firestore");e&&wh(s,...e)}return s},t.getPersistentCacheIndexManager=function(e){var t;e=ne(e,Dh);const n=uf.get(e);if(n)return n;if("persistent"!==(null===(t=Mh(e)._uninitializedComponentsProvider)||void 0===t?void 0:t._offline.kind))return null;const r=new lf(e);return uf.set(e,r),r},t.increment=function(e){return new rd("increment",e)},t.initializeFirestore=function(e,t,n){n||(n=Nn);const r=i._getProvider(e,"firestore");if(r.isInitialized(n)){const e=r.getImmediate({identifier:n}),i=r.getOptions(n);if(a.deepEqual(i,t))return e;throw new T(E.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new T(E.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<va)throw new T(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&a.isCloudWorkstation(t.host)&&a.pingServer(t.host),r.initialize({options:t,instanceIdentifier:n})},t.limit=function(e){return re("limit",e),Td._create("limit",e,"F")},t.limitToLast=function(e){return re("limitToLast",e),Td._create("limitToLast",e,"L")},t.loadBundle=Lh,t.memoryEagerGarbageCollector=function(){return new Yd},t.memoryLocalCache=function(e){return new Wd(e)},t.memoryLruGarbageCollector=function(e){return new Jd(null===e||void 0===e?void 0:e.cacheSizeBytes)},t.namedQuery=Rh,t.onSnapshot=Gd,t.onSnapshotResume=function(e,t){const n=a.getModularInstance(e),r=function(e){const t={bundle:"",bundleName:"",bundleSource:""},n=["bundle","bundleName","bundleSource"];for(const r of n){if(!(r in e)){t.error="snapshotJson missing required field: ".concat(r);break}const n=e[r];if("string"!=typeof n){t.error="snapshotJson field '".concat(r,"' must be a string.");break}if(0===n.length){t.error="snapshotJson field '".concat(r,"' cannot be an empty string.");break}"bundle"===r?t.bundle=n:"bundleName"===r?t.bundleName=n:"bundleSource"===r&&(t.bundleSource=n)}return t}(t);if(r.error)throw new T(E.INVALID_ARGUMENT,r.error);let i,s=0;for(var o=arguments.length,l=new Array(o>2?o-2:0),c=2;c<o;c++)l[c-2]=arguments[c];if("object"!=typeof l[s]||Nh(l[s])||(i=l[s++]),"QuerySnapshot"===r.bundleSource){let e=null;if("object"==typeof l[s]&&Nh(l[s])){const t=l[s++];e={next:t.next,error:t.error,complete:t.complete}}else e={next:l[s++],error:l[s++],complete:l[s++]};return function(e,t,n,r,i){let s,o=!1;return Lh(e,t.bundle).then(()=>Rh(e,t.bundleName)).then(e=>{e&&!o&&(i&&e.withConverter(i),s=Gd(e,n||{},r))}).catch(e=>(r.error&&r.error(e),()=>{})),()=>{o||(o=!0,s&&s())}}(n,r,i,e,l[s])}if("DocumentSnapshot"===r.bundleSource){let e=null;if("object"==typeof l[s]&&Nh(l[s])){const t=l[s++];e={next:t.next,error:t.error,complete:t.complete}}else e={next:l[s++],error:l[s++],complete:l[s++]};return function(e,t,n,r,i){let s,o=!1;return Lh(e,t.bundle).then(()=>{if(!o){const o=new Sh(e,i||null,X.fromPath(t.bundleName));s=Gd(o,n||{},r)}}).catch(e=>(r.error&&r.error(e),()=>{})),()=>{o||(o=!0,s&&s())}}(n,r,i,e,l[s])}throw new T(E.INVALID_ARGUMENT,"unsupported bundle source: ".concat(r.bundleSource))},t.onSnapshotsInSync=function(e,t){return function(e,t){const n=new Qu(t);return e.asyncQueue.enqueueAndForget(async()=>function(e,t){_(e).Ca.add(t),t.next()}(await ch(e),n)),()=>{n.Nu(),e.asyncQueue.enqueueAndForget(async()=>function(e,t){_(e).Ca.delete(t)}(await ch(e),n))}}(Mh(e=ne(e,Dh)),Nh(t)?t:{next:t})},t.or=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(e=>Md("or",e)),_d._create("or",t)},t.orderBy=function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=vd("orderBy",e);return Ed._create(n,t)},t.persistentLocalCache=function(e){return new Xd(e)},t.persistentMultipleTabManager=function(){return new Zd},t.persistentSingleTabManager=ef,t.query=function(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof wd&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof _d).length,n=e.filter(e=>e instanceof Sd).length;if(t>1||t>0&&n>0)throw new T(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e},t.queryEqual=Th,t.querySnapshotFromJSON=function(e,t,n){if(se(t,Ud._jsonSchema)){if(t.bundle===jd)throw new T(E.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Jl(e._databaseId),i=fh(t.bundle,r),s=i.Wu(),o=new tu(i.getMetadata(),r);for(const e of s)o.Ga(e);if(1!==o.queries.length)throw new T(E.INVALID_ARGUMENT,"Snapshot data expected 1 query but found ".concat(o.queries.length," queries."));const a=fo(o.queries[0].bundledQuery),l=o.documents;let c=new Vc;l.map(e=>{const t=Us(r,e.document);c=c.add(t)});const u=Uc.fromInitialDocuments(a,c,gi(),!1,!1),h=new xh(e,n||null,a);return new Ud(e,new Ld(e),h,u)}},t.refEqual=function(e,t){return e=a.getModularInstance(e),t=a.getModularInstance(t),(e instanceof Sh||e instanceof _h)&&(t instanceof Sh||t instanceof _h)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},t.runTransaction=function(e,t,n){e=ne(e,Dh);const i=r(r({},tf),n);return function(e){if(e.maxAttempts<1)throw new T(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(e,t,n){const r=new k;return e.asyncQueue.enqueueAndForget(async()=>{const i=await lh(e);new Ju(e.asyncQueue,i,n,t,r).ju()}),r.promise}(Mh(e),n=>t(new of(e,n)),i)},t.serverTimestamp=function(){return new ed("serverTimestamp")},t.setDoc=function(e,t,n){e=ne(e,Sh);const r=ne(e.firestore,Dh),i=Pd(e.converter,t,n);return Hd(r,[Jh(Yh(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Ri.none())])},t.setIndexConfiguration=function(e,t){const n=Mh(e=ne(e,Dh));if(!n._uninitializedComponentsProvider||"memory"===n._uninitializedComponentsProvider._offline.kind)return v("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new T(E.INVALID_ARGUMENT,"Failed to parse JSON: "+(null===e||void 0===e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const r of t.indexes){const e=af(r,"collectionGroup"),t=[];if(Array.isArray(r.fields))for(const n of r.fields){const e=fd("setIndexConfiguration",af(n,"fieldPath"));"CONTAINS"===n.arrayConfig?t.push(new me(e,2)):"ASCENDING"===n.order?t.push(new me(e,0)):"DESCENDING"===n.order&&t.push(new me(e,1))}n.push(new he(he.UNKNOWN_ID,e,t,ye.empty()))}return n}(t);return function(e,t){return e.asyncQueue.enqueue(async()=>async function(e,t){const n=_(e),r=n.indexManager,i=[];return n.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(n=>function(e,t,n,r,i){e=[...e],t=[...t],e.sort(n),t.sort(n);const s=e.length,o=t.length;let a=0,l=0;for(;a<o&&l<s;){const s=n(e[l],t[a]);s<0?i(e[l++]):s>0?r(t[a++]):(a++,l++)}for(;a<o;)r(t[a++]);for(;l<s;)i(e[l++])}(n,t,pe,t=>{i.push(r.addFieldIndex(e,t))},t=>{i.push(r.deleteFieldIndex(e,t))})).next(()=>Te.waitFor(i)))}(await sh(e),t))}(n,r)},t.setLogLevel=function(e){p.setLogLevel(e)},t.snapshotEqual=function(e,t){return e instanceof Vd&&t instanceof Vd?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Ud&&t instanceof Ud&&e._firestore===t._firestore&&Th(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},t.startAfter=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kd._create("startAfter",t,!1)},t.startAt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kd._create("startAt",t,!0)},t.sum=function(e){return new jh("sum",hd("sum",e))},t.terminate=function(e){return i._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},t.updateDoc=function(e,t,n){e=ne(e,Sh);const r=ne(e.firestore,Dh),i=Yh(r);let s;for(var o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return s="string"==typeof(t=a.getModularInstance(t))||t instanceof zh?sd(i,"updateDoc",e._key,t,n,l):id(i,"updateDoc",e._key,t),Hd(r,[s.toMutation(e._key,Ri.exists(!0))])},t.vector=function(e){return new qh(e)},t.waitForPendingWrites=function(e){return function(e){const t=new k;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t){const n=_(e);gc(n.remoteStore)||g(ou,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=_(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}(n.localStore);if(e===Ue)return void t.resolve();const r=n.mu.get(e)||[];r.push(t),n.mu.set(e,r)}catch(e){const n=Fc(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await ah(e),t)),t.promise}(Mh(e=ne(e,Dh)))},t.where=function(e,t,n){const r=t,i=vd("where",e);return Sd._create(i,r,n)},t.writeBatch=function(e){return Mh(e=ne(e,Dh)),new nf(e,t=>Hd(e,t))}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".fd8ba581.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="team-accounting:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach(e=>e(n)),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/team-accounting/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,s,[o,a,l]=r,c=0;if(o.some(t=>0!==e[t])){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkteam_accounting=self.webpackChunkteam_accounting||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e=n(43),t=n(391),r=n(555);function i(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const s=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const l=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],c=(0,e.forwardRef)((t,n)=>{let{color:s="currentColor",size:c=24,strokeWidth:u=2,absoluteStrokeWidth:h,className:d="",children:f,iconNode:p}=t,m=i(t,l);return(0,e.createElement)("svg",(0,r.A)((0,r.A)((0,r.A)({ref:n},a),{},{width:c,height:c,stroke:s,strokeWidth:h?24*Number(u)/Number(c):u,className:o("lucide",d)},!f&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"}),m),[...p.map(t=>{let[n,r]=t;return(0,e.createElement)(n,r)}),...Array.isArray(f)?f:[f]])}),u=["className"],h=(t,n)=>{const a=(0,e.forwardRef)((a,l)=>{let{className:h}=a,d=i(a,u);return(0,e.createElement)(c,(0,r.A)({ref:l,iconNode:n,className:o("lucide-".concat((f=s(t),f.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(t),h)},d));var f});return a.displayName=s(t),a},d=h("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),f=h("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),p=h("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),m=h("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),g=h("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),y=h("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),v=h("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),b=h("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),w=h("repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),x=h("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),S=h("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),_=h("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),E=h("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),T=h("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),k=h("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),I=h("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),C=h("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),N=h("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),A=h("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),D=h("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),M=h("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),O=h("skull",[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]]),P=h("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),L=h("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),R=h("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),j=h("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),F=h("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),V=h("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),z=h("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),U=h("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),B=h("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),q=h("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),G=h("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),H=h("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),K=h("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Q=h("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),W=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},X={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(W(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new Y;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Y extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const J=function(e){return function(e){const t=W(e);return X.encodeByteArray(t,!0)}(e).replace(/\./g,"")},$=function(e){try{return X.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Z(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const ee=()=>{try{return Z().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/team-accounting",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&$(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},te=e=>{const t=(e=>{var t;return null===(t=ee())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},ne=()=>{var e;return null===(e=ee())||void 0===e?void 0:e.config};class re{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function ie(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}const se={};let oe=!1;function ae(e,t){if("undefined"===typeof window||"undefined"===typeof document||!ie(window.location.host)||se[e]===t||se[e]||oe)return;function n(e){return"__firebase__banner__".concat(e)}se[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(se))se[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{oe=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),l=document.getElementById(a)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,o,l,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function le(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ce(){var e;const t=null===(e=ee())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function ue(){return!ce()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function he(){try{return"object"===typeof indexedDB}catch(e){return!1}}class de extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,de.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fe.prototype.create)}}class fe{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(pe,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new de(n,s,t)}}const pe=/\{\$([^}]+)}/g;function me(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(ge(n)&&ge(s)){if(!me(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function ge(e){return null!==e&&"object"===typeof e}function ye(e){return e&&e._delegate?e._delegate:e}class ve{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const be="[DEFAULT]";class we{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new re;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:be})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===be?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.component?this.component.multipleInstances?e:be:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class xe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new we(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Se=[];var _e;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(_e||(_e={}));const Ee={debug:_e.DEBUG,verbose:_e.VERBOSE,info:_e.INFO,warn:_e.WARN,error:_e.ERROR,silent:_e.SILENT},Te=_e.INFO,ke={[_e.DEBUG]:"log",[_e.VERBOSE]:"log",[_e.INFO]:"info",[_e.WARN]:"warn",[_e.ERROR]:"error"},Ie=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=ke[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class Ce{constructor(e){this.name=e,this._logLevel=Te,this._logHandler=Ie,this._userLogHandler=null,Se.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _e))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Ee[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.DEBUG,...t),this._logHandler(this,_e.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.VERBOSE,...t),this._logHandler(this,_e.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.INFO,...t),this._logHandler(this,_e.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.WARN,...t),this._logHandler(this,_e.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.ERROR,...t),this._logHandler(this,_e.ERROR,...t)}}var Ne=n(799);class Ae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const De="@firebase/app",Me="0.14.6",Oe=new Ce("@firebase/app"),Pe="@firebase/app-compat",Le="@firebase/analytics-compat",Re="@firebase/analytics",je="@firebase/app-check-compat",Fe="@firebase/app-check",Ve="@firebase/auth",ze="@firebase/auth-compat",Ue="@firebase/database",Be="@firebase/data-connect",qe="@firebase/database-compat",Ge="@firebase/functions",He="@firebase/functions-compat",Ke="@firebase/installations",Qe="@firebase/installations-compat",We="@firebase/messaging",Xe="@firebase/messaging-compat",Ye="@firebase/performance",Je="@firebase/performance-compat",$e="@firebase/remote-config",Ze="@firebase/remote-config-compat",et="@firebase/storage",tt="@firebase/storage-compat",nt="@firebase/firestore",rt="@firebase/ai",it="@firebase/firestore-compat",st="firebase",ot="[DEFAULT]",at={[De]:"fire-core",[Pe]:"fire-core-compat",[Re]:"fire-analytics",[Le]:"fire-analytics-compat",[Fe]:"fire-app-check",[je]:"fire-app-check-compat",[Ve]:"fire-auth",[ze]:"fire-auth-compat",[Ue]:"fire-rtdb",[Be]:"fire-data-connect",[qe]:"fire-rtdb-compat",[Ge]:"fire-fn",[He]:"fire-fn-compat",[Ke]:"fire-iid",[Qe]:"fire-iid-compat",[We]:"fire-fcm",[Xe]:"fire-fcm-compat",[Ye]:"fire-perf",[Je]:"fire-perf-compat",[$e]:"fire-rc",[Ze]:"fire-rc-compat",[et]:"fire-gcs",[tt]:"fire-gcs-compat",[nt]:"fire-fst",[it]:"fire-fst-compat",[rt]:"fire-vertex","fire-js":"fire-js",[st]:"fire-js-all"},lt=new Map,ct=new Map,ut=new Map;function ht(e,t){try{e.container.addComponent(t)}catch(n){Oe.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function dt(e){const t=e.name;if(ut.has(t))return Oe.debug("There were multiple attempts to register component ".concat(t,".")),!1;ut.set(t,e);for(const n of lt.values())ht(n,e);for(const n of ct.values())ht(n,e);return!0}function ft(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const pt=new fe("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class mt{constructor(e,t,n){this._isDeleted=!1,this._options=(0,r.A)({},e),this._config=(0,r.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ve("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pt.create("app-deleted",{appName:this._name})}}function gt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=(0,r.A)({name:ot,automaticDataCollectionEnabled:!0},t),s=i.name;if("string"!==typeof s||!s)throw pt.create("bad-app-name",{appName:String(s)});if(n||(n=ne()),!n)throw pt.create("no-options");const o=lt.get(s);if(o){if(me(n,o.options)&&me(i,o.config))return o;throw pt.create("duplicate-app",{appName:s})}const a=new xe(s);for(const r of ut.values())a.addComponent(r);const l=new mt(n,i,a);return lt.set(s,l),l}function yt(e,t,n){var r;let i=null!==(r=at[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Oe.warn(e.join(" "))}dt(new ve("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const vt="firebase-heartbeat-store";let bt=null;function wt(){return bt||(bt=(0,Ne.openDB)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(vt)}catch(n){console.warn(n)}}}).catch(e=>{throw pt.create("idb-open",{originalErrorMessage:e.message})})),bt}async function xt(e,t){try{const n=(await wt()).transaction(vt,"readwrite"),r=n.objectStore(vt);await r.put(t,St(e)),await n.done}catch(n){if(n instanceof de)Oe.warn(n.message);else{const e=pt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Oe.warn(e.message)}}}function St(e){return"".concat(e.name,"!").concat(e.options.appId)}class _t{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Tt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Et();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Oe.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Et(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),kt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),kt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=J(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Oe.warn(t),""}}}function Et(){return(new Date).toISOString().substring(0,10)}class Tt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!he()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await wt()).transaction(vt),n=await t.objectStore(vt).get(St(e));return await t.done,n}catch(t){if(t instanceof de)Oe.warn(t.message);else{const e=pt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Oe.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return xt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return xt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function kt(e){return J(JSON.stringify({version:2,heartbeats:e})).length}var It;It="",dt(new ve("platform-logger",e=>new Ae(e),"PRIVATE")),dt(new ve("heartbeat",e=>new _t(e),"PRIVATE")),yt(De,Me,It),yt(De,Me,"esm2020"),yt("fire-js","");yt("firebase","12.6.0","app");var Ct,Nt,At="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Dt={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let s,o=e.g[3];s=t+(o^n&(i^o))+r[0]+3614090360&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[2]+606105819&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[3]+3250441966&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[4]+4118548399&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[7]+4249261313&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[8]+1770035416&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[11]+2304563134&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[12]+1804603682&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[15]+1236535329&4294967295,s=t+(i^o&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[11]+643717713&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[0]+3921069994&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[15]+3634488961&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[4]+3889429448&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[3]+4107603335&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[8]+1163531501&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[7]+1735328473&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[12]+2368359562&4294967295,s=t+((n=i+(s<<20&4294967295|s>>>12))^i^o)+r[5]+4294588738&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[11]+1839030562&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[14]+4259657740&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[1]+2763975236&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[7]+4139469664&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[10]+3200236656&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[13]+681279174&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[3]+3572445317&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[6]+76029189&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[9]+3654602809&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[15]+530742520&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[2]+3299628645&4294967295,s=t+(i^((n=i+(s<<23&4294967295|s>>>9))|~o))+r[0]+4096336452&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[14]+2878612391&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[12]+1700485571&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[10]+4293915773&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[8]+1873313359&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[6]+2734768916&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[4]+4149444226&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[2]+718787259&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let s=this.h,o=0;for(;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function s(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(e<0)return d(o(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=s.add(r);c.l(e)<=0&&(i=i.add(n),s=c),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),c=(s=o(n)).j(t);h(c)||c.l(e)>0;)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function v(e,t){const n=t>>5;t%=32;const i=e.g.length-n,s=[];for(let r=0;r<i;r++)s[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);const t=o(Math.pow(e,6));var n=this;let r="";for(;;){const i=g(n,t).g;let s=(((n=f(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),s=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=s>>>16,t&=65535,s&=65535,n[r]=s<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(this.l(c)<0&&e.l(c)<0)return o(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,s=65535&this.i(i),o=e.i(t)>>>16,a=65535&e.i(t);n[2*i+2*t]+=s*a,p(n,2*i+2*t),n[2*i+2*t+1]+=r*a,p(n,2*i+2*t+1),n[2*i+2*t+1]+=s*o,p(n,2*i+2*t+1),n[2*i+2*t+2]+=r*o,p(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,Nt=Dt.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=o(Math.pow(n,8));let i=a;for(let a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a);const e=parseInt(t.substring(a,a+s),n);s<8?(s=o(Math.pow(n,s)),i=i.j(s).add(o(e))):(i=i.j(r),i=i.add(o(e)))}return i},Ct=Dt.Integer=r}).apply("undefined"!==typeof At?At:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Mt,Ot,Pt,Lt,Rt,jt,Ft,Vt,zt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Ut={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof zt&&zt];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},s=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=a).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}var h="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function d(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){s.setTimeout(()=>{throw e},0)}function m(){var e=w;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,b=!1,w=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},x=()=>{const e=Promise.resolve(void 0);v=()=>{e.then(S)}};function S(){for(var e;e=m();){try{e.h.call(e.g)}catch(n){p(n)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}b=!1}function _(){this.u=this.u,this.C=this.C}function E(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}_.prototype.u=!1,_.prototype.dispose=function(){this.u||(this.u=!0,this.N())},_.prototype[Symbol.dispose]=function(){this.dispose()},_.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},E.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function k(e){return/^[\s\xa0]*$/.test(e)}function I(e,t){E.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(I,E),I.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&I.Z.h.call(this)},I.prototype.h=function(){I.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var C="closure_listenable_"+(1e6*Math.random()|0),N=0;function A(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++N,this.da=this.fa=!1}function D(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function M(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function O(e){const t={};for(const n in e)t[n]=e[n];return t}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<P.length;t++)n=P[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function R(e){this.src=e,this.g={},this.h=0}function j(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(D(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function F(e,t,n,r){for(let i=0;i<e.length;++i){const s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}R.prototype.add=function(e,t,n,r,i){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const o=F(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new A(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var V="closure_lm_"+(1e6*Math.random()|0),z={};function U(e,t,n,r,i){if(r&&r.once)return q(e,t,n,r,i);if(Array.isArray(t)){for(let s=0;s<t.length;s++)U(e,t[s],n,r,i);return null}return n=Y(n),e&&e[C]?e.J(t,n,o(r)?!!r.capture:!!r,i):B(e,t,n,!1,r,i)}function B(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");const a=o(i)?!!i.capture:!!i;let l=W(e);if(l||(e[V]=l=new R(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Q;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)T||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(K(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function q(e,t,n,r,i){if(Array.isArray(t)){for(let s=0;s<t.length;s++)q(e,t[s],n,r,i);return null}return n=Y(n),e&&e[C]?e.K(t,n,o(r)?!!r.capture:!!r,i):B(e,t,n,!0,r,i)}function G(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=Y(n),e&&e[C]?(e=e.i,(s=String(t).toString())in e.g&&((n=F(t=e.g[s],n,r,i))>-1&&(D(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--)))):e&&(e=W(e))&&(t=e.g[t.toString()],e=-1,t&&(e=F(t,n,r,i)),(n=e>-1?t[e]:null)&&H(n))}function H(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[C])j(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(K(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=W(t))?(j(n,e),0==n.h&&(n.src=null,t[V]=null)):D(e)}}}function K(e){return e in z?z[e]:z[e]="on"+e}function Q(e,t){if(e.da)e=!0;else{t=new I(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&H(e),e=n.call(r,t)}return e}function W(e){return(e=e[V])instanceof R?e:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function Y(e){return"function"===typeof e?e:(e[X]||(e[X]=function(t){return e.handleEvent(t)}),e[X])}function J(){_.call(this),this.i=new R(this),this.M=this,this.G=null}function $(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new E(t,e);else if(t instanceof E)t.target=t.target||e;else{var i=t;L(t=new E(r,e),i)}let s,o;if(i=!0,n)for(o=n.length-1;o>=0;o--)s=t.g=n[o],i=Z(s,r,!0,t)&&i;if(s=t.g=e,i=Z(s,r,!0,t)&&i,i=Z(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.g=n[o],i=Z(s,r,!1,t)&&i}function Z(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){const o=t[s];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&j(e.i,o),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:s.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(J,_),J.prototype[C]=!0,J.prototype.removeEventListener=function(e,t,n,r){G(this,e,t,n,r)},J.prototype.N=function(){if(J.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)D(n[e]);delete e.g[t],e.h--}}this.G=null},J.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},J.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends _{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){_.call(this),this.h=e,this.g={}}u(ne,_);var re=[];function ie(e){M(e.g,function(e,t){this.g.hasOwnProperty(t)&&H(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var se=s.JSON.stringify,oe=s.JSON.parse,ae=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function le(){}function ce(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function he(){E.call(this,"d")}function de(){E.call(this,"c")}u(he,E),u(de,E);var fe={},pe=null;function me(){return pe=pe||new J}function ge(e){E.call(this,fe.Ia,e)}function ye(e){const t=me();$(t,new ge(t))}function ve(e,t){E.call(this,fe.STAT_EVENT,e),this.stat=t}function be(e){const t=me();$(t,new ve(t,e))}function we(e,t){E.call(this,fe.Ja,e),this.size=t}function xe(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function Se(){this.g=!0}function _e(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return se(s)}catch(s){return t}}(e,n)+(r?" "+r:"")})}fe.Ia="serverreachability",u(ge,E),fe.STAT_EVENT="statevent",u(ve,E),fe.Ja="timingevent",u(we,E),Se.prototype.ua=function(){this.g=!1},Se.prototype.info=function(){};var Ee,Te={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ke={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ie(){}function Ce(e){return encodeURIComponent(String(e))}function Ne(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ae(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new De}function De(){this.i=null,this.g="",this.h=!1}u(Ie,le),Ie.prototype.g=function(){return new XMLHttpRequest},Ee=new Ie;var Me={},Oe={};function Pe(e,t,n){e.M=1,e.A=st(et(t)),e.u=n,e.R=!0,Le(e,null)}function Le(e,t){e.F=Date.now(),Fe(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),bt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new De,e.g=yn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let s=0;s<i.length;s++){const e=U(n,i[s],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?O(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ye(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s){var o="",a=s.split("&");for(let e=0;e<a.length;e++){var l=a[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+l+"&":o+(e+"=redacted&")}}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Re(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function je(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Oe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Oe:(t=t.slice(r,r+n),e.C=r+n,t))}function Fe(e){e.T=Date.now()+e.H,Ve(e,e.H)}function Ve(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=xe(l(e.aa,e),t)}function ze(e){e.D&&(s.clearTimeout(e.D),e.D=null)}function Ue(e){0==e.j.I||e.K||dn(e.j,e)}function Be(e){ze(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function qe(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||We(n.h,e)))if(!e.L&&We(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;hn(n),en(n)}ln(n),be(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=xe(l(n.Va,n),6e3));Qe(n.h)<=1&&n.ta&&(n.ta=void 0)}else pn(n,11)}else if((e.L||n.g==e)&&hn(n),!k(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=l[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Xe(s,s.h),s.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=gn(r,r.L?r.ba:null,r.W),o.L){Ye(r.h,o);var a=o,c=r.O;c&&(a.H=c),a.D&&(ze(a),Fe(a)),r.g=o}else an(r);n.i.length>0&&nn(n)}else"stop"!=l[0]&&"close"!=l[0]||pn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?pn(n,7):Zt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ye()}catch(u){}}Ae.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Xt(e)?t.j():this.Y(e)},Ae.prototype.Y=function(e){try{if(e==this.g)e:{const l=Xt(this.g),c=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||Yt(this.g)))){this.K||4!=l||7==c||ye(),ze(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Re(e))return e.g.la();const t=Yt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Xt(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return Be(e),Ue(e),"";e.h.i=new s.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(i&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(r)){var o=r;break t}}o=null}if(!(e=o)){this.o=!1,this.m=3,be(12),Be(this),Ue(this);break e}_e(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qe(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=je(this,n),t==Oe){4==l&&(this.m=4,be(14),e=!1),_e(this.i,this.l,null,"[Incomplete Response]");break}if(t==Me){this.m=4,be(15),_e(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}_e(this.i,this.l,t,null),qe(this,t)}if(Re(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,be(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),cn(a),a.P=!0,be(11))}}else _e(this.i,this.l,n,"[Invalid Chunked Response]"),Be(this),Ue(this)}else _e(this.i,this.l,n,null),qe(this,n);4==l&&Be(this),this.o&&!this.K&&(4==l?dn(this.j,this):(this.o=!1,Fe(this)))}else(function(e){const t={};e=(e.g&&Xt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(k(e[r]))continue;var n=Ne(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,be(12)):(this.m=0,be(13)),Be(this),Ue(this)}}}catch(Sn){}},Ae.prototype.cancel=function(){this.K=!0,Be(this)},Ae.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ye(),be(17)),Be(this),this.m=2,Ue(this)):Ve(this,this.T-e)};var Ge=class{constructor(e,t){this.g=e,this.map=t}};function He(e){this.l=e||10,s.PerformanceNavigationTiming?e=(e=s.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ke(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Qe(e){return e.h?1:e.g?e.g.size:0}function We(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Xe(e,t){e.g?e.g.add(t):e.h=t}function Ye(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Je(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return d(e.i)}He.prototype.cancel=function(){if(this.i=Je(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var $e=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ze(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Ze?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,wt(e.i)),this.m=e.m):e&&(t=String(e).match($e))?(this.l=!1,tt(this,t[1]||"",!0),this.o=ot(t[2]||""),this.g=ot(t[3]||"",!0),nt(this,t[4]),this.h=ot(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=ot(t[7]||"")):(this.l=!1,this.i=new pt(null,this.l))}function et(e){return new Ze(e)}function tt(e,t,n){e.j=n?ot(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof pt?(e.i=t,function(e,t){t&&!e.j&&(mt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(gt(this,t),bt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=at(t,dt)),e.i=new pt(t,e.l))}function it(e,t,n){e.i.set(t,n)}function st(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ot(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function at(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ze.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(at(t,ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(at(t,ct,!0),"@"),e.push(Ce(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(at(n,"/"==n.charAt(0)?ht:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",at(n,ft)),e.join("")},Ze.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,wt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ct=/[#\/\?@]/g,ut=/[#\?:]/g,ht=/[#\?]/g,dt=/[#\?@]/g,ft=/#/g;function pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function mt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,s=null;r>=0?(i=e[n].substring(0,r),s=e[n].substring(r+1)):i=e[n],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function gt(e,t){mt(e),t=xt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function yt(e,t){return mt(e),t=xt(e,t),e.g.has(t)}function vt(e,t){mt(e);let n=[];if("string"===typeof t)yt(e,t)&&(n=n.concat(e.g.get(xt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function bt(e,t,n){gt(e,t),n.length>0&&(e.i=null,e.g.set(xt(e,t),d(n)),e.h+=n.length)}function wt(e){const t=new pt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function xt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function St(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function _t(){this.g=new ae}function Et(e){this.i=e.Sb||null,this.h=e.ab||!1}function Tt(e,t){J.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function kt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function It(e){e.readyState=4,e.l=null,e.j=null,e.B=null,Ct(e)}function Ct(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Nt(e){let t="";return M(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function At(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Nt(n),"string"===typeof e?null!=n&&Ce(n):it(e,t,n))}function Dt(e){J.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=pt.prototype).add=function(e,t){mt(this),this.i=null,e=xt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){mt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return mt(this),this.i=null,yt(this,e=xt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=vt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ce(n);n=vt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ce(n[t])),e.push(r)}}return this.i=e.join("&")},u(Et,le),Et.prototype.g=function(){return new Tt(this.i,this.h)},u(Tt,J),(e=Tt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,Ct(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||s).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,It(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ct(this)),this.g&&(this.readyState=3,Ct(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?It(this):Ct(this),3==this.readyState&&kt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,It(this))},e.Na=function(e){this.g&&(this.response=e,It(this))},e.ga=function(){this.g&&It(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Tt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Dt,J);var Bt=/^https?$/i,Gt=["POST","PUT"];function Ht(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Kt(e),Wt(e)}function Kt(e){e.A||(e.A=!0,$(e,"complete"),$(e,"error"))}function Qt(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==Xt(e))setTimeout(e.Ca.bind(e),0);else if($(e,"readystatechange"),4==Xt(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match($e)[1]||null;!t&&s.self&&s.self.location&&(t=s.self.location.protocol.slice(0,-1)),r=!Bt.test(t?t.toLowerCase():"")}n=r}if(n)$(e,"complete"),$(e,"success");else{e.o=6;try{var o=Xt(e)>2?e.g.statusText:""}catch(a){o=""}e.l=o+" ["+e.ca()+"]",Kt(e)}}finally{Wt(e)}}}function Wt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||$(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Xt(e){return e.g?e.g.readyState:0}function Yt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Jt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function $t(e){this.za=0,this.i=[],this.j=new Se,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jt("baseRetryDelayMs",5e3,e),this.Za=Jt("retryDelaySeedMs",1e4,e),this.Ta=Jt("forwardChannelMaxRetries",2,e),this.va=Jt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new He(e&&e.concurrentRequestLimit),this.Ba=new _t,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Zt(e){if(tn(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),sn(e,n),(t=new Ae(e,e.j,t)).M=2,t.A=st(et(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.A,n=!0),n||(t.g=yn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Fe(t)}mn(e)}function en(e){e.g&&(cn(e),e.g.cancel(),e.g=null)}function tn(e){en(e),e.v&&(s.clearTimeout(e.v),e.v=null),hn(e),e.h.cancel(),e.m&&("number"===typeof e.m&&s.clearTimeout(e.m),e.m=null)}function nn(e){if(!Ke(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||x(),b||(v(),b=!0),w.add(t,e),e.D=0}}function rn(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),sn(e,r),e.u&&e.o&&At(r,e.u,e.o),n=new Ae(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=on(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Xe(e.h,n),Pe(n,r,t)}function sn(e,t){e.H&&M(e.H,function(e,n){it(t,n,e)}),e.l&&M({},function(e,n){it(t,n,e)})}function on(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var s=i[c].g;const n=i[c].map;if((s-=t)<0)t=Math.max(0,i[c].g-100),l=!1;else try{s="req"+s+"_"||0;try{var a=n instanceof Map?n:Object.entries(n);for(const[t,n]of a){let r=n;o(n)&&(r=se(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(qt){throw e.push(s+"type="+encodeURIComponent("_badmap")),qt}}catch(qt){r&&r(n)}}if(l){a=e.join("&");break e}}a=void 0}return e=e.i.splice(0,n),t.G=e,a}function an(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||x(),b||(v(),b=!0),w.add(t,e),e.A=0}}function ln(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=xe(l(e.Da,e),fn(e,e.A)),e.A++,!0)}function cn(e){null!=e.B&&(s.clearTimeout(e.B),e.B=null)}function un(e){e.g=new Ae(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),sn(e,t),e.u&&e.o&&At(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=st(et(t)),n.u=null,n.R=!0,Le(n,e)}function hn(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function dn(e,t){var n=null;if(e.g==t){hn(e),cn(e),e.g=null;var r=2}else{if(!We(e.h,t))return;n=t.G,Ye(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;$(r=me(),new we(r,n)),nn(e)}else an(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Qe(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=xe(l(e.Ea,e,t),fn(e,e.D)),e.D++,!0))}(e,t)||2==r&&ln(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:pn(e,5);break;case 4:pn(e,10);break;case 3:pn(e,6);break;default:pn(e,2)}}function fn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function pn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new Ze(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||tt(r,"https"),st(r),t?function(e,t){const n=new Se;if(s.Image){const r=new Image;r.onload=c(St,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(St,n,"TestLoadImage: error",!1,t,r),r.onabort=c(St,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(St,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Se;const n=new AbortController,r=setTimeout(()=>{n.abort(),St(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?St(0,0,!0,t):St(0,0,!1,t)}).catch(()=>{clearTimeout(r),St(0,0,!1,t)})}(r.toString(),n)}else be(2);e.I=0,e.l&&e.l.pa(t),mn(e),tn(e)}function mn(e){if(e.I=0,e.ja=[],e.l){const t=Je(e.h);0==t.length&&0==e.i.length||(f(e.ja,t),f(e.ja,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.oa()}}function gn(e,t,n){var r=n instanceof Ze?et(n):new Ze(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new Ze(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),sn(e,r),r}function yn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Dt(new Et({ab:n})):new Dt(e.ma)).Fa(e.L),t}function vn(){}function bn(){}function wn(e,t){J.call(this),this.g=new $t(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!k(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!k(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new En(this)}function xn(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function _n(){de.call(this),this.status=1}function En(e){this.g=e}(e=Dt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ee.g(),this.g.onreadystatechange=h(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Ht(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=s.FormData&&e instanceof s.FormData,!(Array.prototype.indexOf.call(Gt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(o){Ht(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,$(this,"complete"),$(this,"abort"),Wt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wt(this,!0)),Dt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Qt(this):this.Xa())},e.Xa=function(){Qt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Xt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),oe(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=$t.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){be(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=gn(this,null,this.W),nn(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new Ae(this,this.j,e);let s=this.o;if(this.U&&(s?(s=O(s),L(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=on(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),sn(this,n),s&&(this.R?t="headers="+Ce(Nt(s))+"&"+t:this.u&&At(n,this.u,s)),Xe(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,Pe(i,n,null)):Pe(i,n,t),this.I=2}}else 3==this.I&&(e?rn(this,e):0==this.i.length||Ke(this.h)||rn(this))},e.Da=function(){if(this.v=null,un(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=xe(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,be(10),en(this),un(this))},e.Va=function(){null!=this.C&&(this.C=null,en(this),ln(this),be(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=vn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},bn.prototype.g=function(e,t){return new wn(e,t)},u(wn,J),wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){Zt(this.g)},wn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=se(e),e=n);t.i.push(new Ge(t.Ya++,e)),3==t.I&&nn(t)},wn.prototype.N=function(){this.g.l=null,delete this.j,Zt(this.g),delete this.g,wn.Z.N.call(this)},u(xn,he),u(_n,de),u(En,vn),En.prototype.ra=function(){$(this.g,"a")},En.prototype.qa=function(e){$(this.g,new xn(e))},En.prototype.pa=function(e){$(this.g,new _n)},En.prototype.oa=function(){$(this.g,"b")},bn.prototype.createWebChannel=bn.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,Vt=Ut.createWebChannelTransport=function(){return new bn},Ft=Ut.getStatEventTarget=function(){return me()},jt=Ut.Event=fe,Rt=Ut.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Lt=Ut.ErrorCode=Te,ke.COMPLETE="complete",Pt=Ut.EventType=ke,ce.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",J.prototype.listen=J.prototype.J,Ot=Ut.WebChannel=ce,Ut.FetchXmlHttpFactory=Et,Dt.prototype.listenOnce=Dt.prototype.K,Dt.prototype.getLastError=Dt.prototype.Ha,Dt.prototype.getLastErrorCode=Dt.prototype.ya,Dt.prototype.getStatus=Dt.prototype.ca,Dt.prototype.getResponseJson=Dt.prototype.La,Dt.prototype.getResponseText=Dt.prototype.la,Dt.prototype.send=Dt.prototype.ea,Dt.prototype.setWithCredentials=Dt.prototype.Fa,Mt=Ut.XhrIo=Dt}).apply("undefined"!==typeof zt?zt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Bt="@firebase/firestore",qt="4.9.2";class Gt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");let Ht="12.3.0";const Kt=new Ce("@firebase/firestore");function Qt(){return Kt.logLevel}function Wt(e){if(Kt.logLevel<=_e.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Jt);Kt.debug("Firestore (".concat(Ht,"): ").concat(e),...i)}}function Xt(e){if(Kt.logLevel<=_e.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Jt);Kt.error("Firestore (".concat(Ht,"): ").concat(e),...i)}}function Yt(e){if(Kt.logLevel<=_e.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Jt);Kt.warn("Firestore (".concat(Ht,"): ").concat(e),...i)}}function Jt(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function $t(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Zt(e,r,n)}function Zt(e,t,n){let r="FIRESTORE (".concat(Ht,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Xt(r),new Error(r)}function en(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Zt(t,i,r)}function tn(e,t){return e}const nn={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rn extends de{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class sn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class on{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class an{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Gt.UNAUTHENTICATED))}shutdown(){}}class ln{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class cn{constructor(e){this.t=e,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){en(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new sn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new sn,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{Wt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Wt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new sn)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Wt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(en("string"==typeof t.accessToken,31837,{l:t}),new on(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return en(null===e||"string"==typeof e,2055,{h:e}),new Gt(e)}}class un{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hn{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new un(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dn{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fn{constructor(e,t){var n;this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,null!==(n=e)&&void 0!==n&&void 0!==n.settings&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){en(void 0===this.o,3512);const n=e=>{null!=e.error&&Wt("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,Wt("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Wt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Wt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new dn(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(en("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new dn(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function pn(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class mn{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=pn(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function gn(e,t){return e<t?-1:e>t?1:0}function yn(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return wn(n)===wn(i)?gn(n,i):wn(n)?1:-1}return gn(e.length,t.length)}const vn=55296,bn=57343;function wn(e){const t=e.charCodeAt(0);return t>=vn&&t<=bn}function xn(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Sn="__name__";class _n{constructor(e,t,n){void 0===t?t=0:t>e.length&&$t(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&$t(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===_n.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _n?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=_n.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return gn(e.length,t.length)}static compareSegments(e,t){const n=_n.isNumericId(e),r=_n.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?_n.extractNumericId(e).compare(_n.extractNumericId(t)):yn(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ct.fromString(e.substring(4,e.length-2))}}class En extends _n{construct(e,t,n){return new En(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new rn(nn.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new En(e)}static emptyPath(){return new En([])}}const Tn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends _n{construct(e,t,n){return new kn(e,t,n)}static isValidIdentifier(e){return Tn.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Sn}static keyField(){return new kn([Sn])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new rn(nn.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new rn(nn.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new rn(nn.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new rn(nn.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kn(t)}static emptyPath(){return new kn([])}}class In{constructor(e){this.path=e}static fromPath(e){return new In(En.fromString(e))}static fromName(e){return new In(En.fromString(e).popFirst(5))}static empty(){return new In(En.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===En.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return En.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new In(new En(e.slice()))}}function Cn(e,t,n){if(!n)throw new rn(nn.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Nn(e){if(!In.isDocumentKey(e))throw new rn(nn.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function An(e){if(In.isDocumentKey(e))throw new rn(nn.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Dn(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Mn(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":$t(12329,{type:typeof e})}function On(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new rn(nn.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Mn(e);throw new rn(nn.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Pn(e,t){const n={typeString:e};return t&&(n.value=t),n}function Ln(e,t){if(!Dn(e))throw new rn(nn.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const o=e[r];if(i&&typeof o!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==s&&o!==s.value){n="Expected '".concat(r,"' field to equal '").concat(s.value,"'");break}}if(n)throw new rn(nn.INVALID_ARGUMENT,n);return!0}const Rn=-62135596800,jn=1e6;class Fn{static now(){return Fn.fromMillis(Date.now())}static fromDate(e){return Fn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*jn);return new Fn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new rn(nn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new rn(nn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Rn)throw new rn(nn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rn(nn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jn}_compareTo(e){return this.seconds===e.seconds?gn(this.nanoseconds,e.nanoseconds):gn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Fn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ln(e,Fn._jsonSchema))return new Fn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Rn;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Fn._jsonSchemaVersion="firestore/timestamp/1.0",Fn._jsonSchema={type:Pn("string",Fn._jsonSchemaVersion),seconds:Pn("number"),nanoseconds:Pn("number")};class Vn{static fromTimestamp(e){return new Vn(e)}static min(){return new Vn(new Fn(0,0))}static max(){return new Vn(new Fn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const zn=-1;class Un{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Un.UNKNOWN_ID=-1;function Bn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Vn.fromTimestamp(1e9===r?new Fn(n+1,0):new Fn(n,r));return new Gn(i,In.empty(),t)}function qn(e){return new Gn(e.readTime,e.key,zn)}class Gn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Gn(Vn.min(),In.empty(),zn)}static max(){return new Gn(Vn.max(),In.empty(),zn)}}function Hn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=In.comparator(e.documentKey,t.documentKey),0!==n?n:gn(e.largestBatchId,t.largestBatchId))}const Kn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Wn(e){if(e.code!==nn.FAILED_PRECONDITION||e.message!==Kn)throw e;Wt("LocalStore","Unexpectedly lost primary lease")}class Xn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$t(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Xn((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Xn?t:Xn.resolve(t)}catch(e){return Xn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Xn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Xn.reject(t)}static resolve(e){return new Xn((t,n)=>{t(e)})}static reject(e){return new Xn((t,n)=>{n(e)})}static waitFor(e){return new Xn((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Xn.resolve(!1);for(const n of e)t=t.next(e=>e?Xn.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Xn((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Xn((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Yn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Jn(e){return"IndexedDbTransactionError"===e.name}class $n{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}$n.ce=-1;const Zn=-1;function er(e){return null==e}function tr(e){return 0===e&&1/e==-1/0}function nr(e){return"number"==typeof e&&Number.isInteger(e)&&!tr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const rr="\x01";function ir(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=or(t)),t=sr(e.get(n),t);return or(t)}function sr(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case rr:n+="\x01\x11";break;default:n+=t}}return n}function or(e){return e+rr+"\x01"}const ar="remoteDocuments",lr="owner",cr="mutationQueues",ur="mutations";const hr="documentMutations",dr="remoteDocumentsV14",fr="remoteDocumentGlobal",pr="targets",mr="targetDocuments",gr="targetGlobal",yr="collectionParents",vr="clientMetadata",br="bundles",wr="namedQueries",xr="indexConfiguration",Sr="indexState",_r="indexEntries",Er="documentOverlays",Tr="globals",kr=[cr,ur,hr,ar,pr,lr,gr,mr,vr,fr,yr,br,wr],Ir=[cr,ur,hr,dr,pr,lr,gr,mr,vr,fr,yr,br,wr,Er],Cr=Ir,Nr=[...Cr,xr,Sr,_r];function Ar(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Dr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Mr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Or{constructor(e,t){this.comparator=e,this.root=t||Lr.EMPTY}insert(e,t){return new Or(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Lr.BLACK,null,null))}remove(e){return new Or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pr(this.root,e,this.comparator,!0)}}class Pr{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Lr{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Lr.RED,this.left=null!=r?r:Lr.EMPTY,this.right=null!=i?i:Lr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Lr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Lr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Lr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $t(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $t(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $t(27949);return e+(this.isRed()?0:1)}}Lr.EMPTY=null,Lr.RED=!0,Lr.BLACK=!1,Lr.EMPTY=new class{constructor(){this.size=0}get key(){throw $t(57766)}get value(){throw $t(16141)}get color(){throw $t(16727)}get left(){throw $t(29726)}get right(){throw $t(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Lr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Rr{constructor(e){this.comparator=e,this.data=new Or(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jr(this.data.getIterator())}getIteratorFrom(e){return new jr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Rr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Rr(this.comparator);return t.data=e,t}}class jr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Fr{constructor(e){this.fields=e,e.sort(kn.comparator)}static empty(){return new Fr([])}unionWith(e){let t=new Rr(kn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Fr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xn(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Vr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class zr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Vr("Invalid base64 string: "+e):e}}(e);return new zr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new zr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return gn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zr.EMPTY_BYTE_STRING=new zr("");const Ur=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Br(e){if(en(!!e,39018),"string"==typeof e){let t=0;const n=Ur.exec(e);if(en(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:qr(e.seconds),nanos:qr(e.nanos)}}function qr(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Gr(e){return"string"==typeof e?zr.fromBase64String(e):zr.fromUint8Array(e)}const Hr="server_timestamp",Kr="__type__",Qr="__previous_value__",Wr="__local_write_time__";function Xr(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Kr])||void 0===t?void 0:t.stringValue)===Hr}function Yr(e){const t=e.mapValue.fields[Qr];return Xr(t)?Yr(t):t}function Jr(e){const t=Br(e.mapValue.fields[Wr].timestampValue);return new Fn(t.seconds,t.nanos)}class $r{constructor(e,t,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const Zr="(default)";class ei{constructor(e,t){this.projectId=e,this.database=t||Zr}static empty(){return new ei("","")}get isDefaultDatabase(){return this.database===Zr}isEqual(e){return e instanceof ei&&e.projectId===this.projectId&&e.database===this.database}}const ti="__type__",ni="__max__",ri={mapValue:{fields:{__type__:{stringValue:ni}}}},ii="__vector__",si="value";function oi(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Xr(e)?4:_i(e)?9007199254740991:xi(e)?10:11:$t(28295,{value:e})}function ai(e,t){if(e===t)return!0;const n=oi(e);if(n!==oi(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Jr(e).isEqual(Jr(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Br(e.timestampValue),r=Br(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Gr(e.bytesValue).isEqual(Gr(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return qr(e.geoPointValue.latitude)===qr(t.geoPointValue.latitude)&&qr(e.geoPointValue.longitude)===qr(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return qr(e.integerValue)===qr(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=qr(e.doubleValue),r=qr(t.doubleValue);return n===r?tr(n)===tr(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return xn(e.arrayValue.values||[],t.arrayValue.values||[],ai);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Ar(n)!==Ar(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ai(n[i],r[i])))return!1;return!0}(e,t);default:return $t(52216,{left:e})}}function li(e,t){return void 0!==(e.values||[]).find(e=>ai(e,t))}function ci(e,t){if(e===t)return 0;const n=oi(e),r=oi(t);if(n!==r)return gn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return gn(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=qr(e.integerValue||e.doubleValue),r=qr(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ui(e.timestampValue,t.timestampValue);case 4:return ui(Jr(e),Jr(t));case 5:return yn(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Gr(e),r=Gr(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=gn(n[i],r[i]);if(0!==e)return e}return gn(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=gn(qr(e.latitude),qr(t.latitude));return 0!==n?n:gn(qr(e.longitude),qr(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return hi(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o[si])||void 0===n?void 0:n.arrayValue,c=null===(r=a[si])||void 0===r?void 0:r.arrayValue,u=gn((null===l||void 0===l||null===(i=l.values)||void 0===i?void 0:i.length)||0,(null===c||void 0===c||null===(s=c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:hi(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ri.mapValue&&t===ri.mapValue)return 0;if(e===ri.mapValue)return 1;if(t===ri.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=yn(r[o],s[o]);if(0!==e)return e;const t=ci(n[r[o]],i[s[o]]);if(0!==t)return t}return gn(r.length,s.length)}(e.mapValue,t.mapValue);default:throw $t(23264,{he:n})}}function ui(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return gn(e,t);const n=Br(e),r=Br(t),i=gn(n.seconds,r.seconds);return 0!==i?i:gn(n.nanos,r.nanos)}function hi(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=ci(n[i],r[i]);if(e)return e}return gn(n.length,r.length)}function di(e){return fi(e)}function fi(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Br(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Gr(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return In.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=fi(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(fi(e.fields[i]));return n+"}"}(e.mapValue):$t(61005,{value:e})}function pi(e){switch(oi(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Yr(e);return t?16+pi(t):16;case 5:return 2*e.stringValue.length;case 6:return Gr(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+pi(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Dr(e.fields,(e,n)=>{t+=e.length+pi(n)}),t}(e.mapValue);default:throw $t(13486,{value:e})}}function mi(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function gi(e){return!!e&&"integerValue"in e}function yi(e){return!!e&&"arrayValue"in e}function vi(e){return!!e&&"nullValue"in e}function bi(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function wi(e){return!!e&&"mapValue"in e}function xi(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[ti])||void 0===t?void 0:t.stringValue)===ii}function Si(e){if(e.geoPointValue)return{geoPointValue:(0,r.A)({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:(0,r.A)({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Dr(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Si(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Si(e.arrayValue.values[n]);return t}return(0,r.A)({},e)}function _i(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ni}class Ei{constructor(e){this.value=e}static empty(){return new Ei({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!wi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Si(t)}setAll(e){let t=kn.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Si(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());wi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ai(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];wi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Dr(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Ei(Si(this.value))}}function Ti(e){const t=[];return Dr(e.fields,(e,n)=>{const r=new kn([e]);if(wi(n)){const e=Ti(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Fr(t)}class ki{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new ki(e,0,Vn.min(),Vn.min(),Vn.min(),Ei.empty(),0)}static newFoundDocument(e,t,n,r){return new ki(e,1,t,Vn.min(),n,r,0)}static newNoDocument(e,t){return new ki(e,2,t,Vn.min(),Vn.min(),Ei.empty(),0)}static newUnknownDocument(e,t){return new ki(e,3,t,Vn.min(),Vn.min(),Ei.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Vn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ei.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ei.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ki&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ki(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Ii{constructor(e,t){this.position=e,this.inclusive=t}}function Ci(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?In.comparator(In.fromName(o.referenceValue),n.key):ci(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Ni(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ai(e.position[n],t.position[n]))return!1;return!0}class Ai{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Di(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Mi{}class Oi extends Mi{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ui(e,t,n):"array-contains"===t?new Hi(e,n):"in"===t?new Ki(e,n):"not-in"===t?new Qi(e,n):"array-contains-any"===t?new Wi(e,n):new Oi(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Bi(e,n):new qi(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(ci(t,this.value)):null!==t&&oi(this.value)===oi(t)&&this.matchesComparison(ci(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return $t(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pi extends Mi{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Pi(e,t)}matches(e){return Li(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Li(e){return"and"===e.op}function Ri(e){return ji(e)&&Li(e)}function ji(e){for(const t of e.filters)if(t instanceof Pi)return!1;return!0}function Fi(e){if(e instanceof Oi)return e.field.canonicalString()+e.op.toString()+di(e.value);if(Ri(e))return e.filters.map(e=>Fi(e)).join(",");{const t=e.filters.map(e=>Fi(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Vi(e,t){return e instanceof Oi?function(e,t){return t instanceof Oi&&e.op===t.op&&e.field.isEqual(t.field)&&ai(e.value,t.value)}(e,t):e instanceof Pi?function(e,t){return t instanceof Pi&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Vi(n,t.filters[r]),!0)}(e,t):void $t(19439)}function zi(e){return e instanceof Oi?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(di(e.value))}(e):e instanceof Pi?function(e){return e.op.toString()+" {"+e.getFilters().map(zi).join(" ,")+"}"}(e):"Filter"}class Ui extends Oi{constructor(e,t,n){super(e,t,n),this.key=In.fromName(n.referenceValue)}matches(e){const t=In.comparator(e.key,this.key);return this.matchesComparison(t)}}class Bi extends Oi{constructor(e,t){super(e,"in",t),this.keys=Gi("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class qi extends Oi{constructor(e,t){super(e,"not-in",t),this.keys=Gi("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Gi(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>In.fromName(e.referenceValue))}class Hi extends Oi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return yi(t)&&li(t.arrayValue,this.value)}}class Ki extends Oi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&li(this.value.arrayValue,t)}}class Qi extends Oi{constructor(e,t){super(e,"not-in",t)}matches(e){if(li(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!li(this.value.arrayValue,t)}}class Wi extends Oi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!yi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>li(this.value.arrayValue,e))}}class Xi{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Te=null}}function Yi(e){return new Xi(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ji(e){const t=tn(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Fi(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),er(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>di(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>di(e)).join(",")),t.Te=e}return t.Te}function $i(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Di(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Vi(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ni(e.startAt,t.startAt)&&Ni(e.endAt,t.endAt)}function Zi(e){return In.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class es{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ts(e,t,n,r,i,s,o,a){return new es(e,t,n,r,i,s,o,a)}function ns(e){return new es(e)}function rs(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function is(e){return null!==e.collectionGroup}function ss(e){const t=tn(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Rr(kn.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Ai(r,n))}),e.has(kn.keyField().canonicalString())||t.Ie.push(new Ai(kn.keyField(),n))}return t.Ie}function os(e){const t=tn(e);return t.Ee||(t.Ee=as(t,ss(e))),t.Ee}function as(e,t){if("F"===e.limitType)return Yi(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Ai(e.field,t)});const n=e.endAt?new Ii(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ii(e.startAt.position,e.startAt.inclusive):null;return Yi(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function ls(e,t){const n=e.filters.concat([t]);return new es(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function cs(e,t,n){return new es(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function us(e,t){return $i(os(e),os(t))&&e.limitType===t.limitType}function hs(e){return"".concat(Ji(os(e)),"|lt:").concat(e.limitType)}function ds(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>zi(e)).join(", "),"]")),er(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>di(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>di(e)).join(",")),"Target(".concat(t,")")}(os(e)),"; limitType=").concat(e.limitType,")")}function fs(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):In.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ss(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ci(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,ss(e),t))&&!(e.endAt&&!function(e,t,n){const r=Ci(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,ss(e),t))}(e,t)}function ps(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ms(e){return(t,n)=>{let r=!1;for(const i of ss(e)){const e=gs(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function gs(e,t,n){const r=e.field.isKeyField()?In.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ci(r,i):$t(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return $t(19790,{direction:e.dir})}}class ys{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Dr(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Mr(this.inner)}size(){return this.innerSize}}const vs=new Or(In.comparator);function bs(){return vs}const ws=new Or(In.comparator);function xs(){let e=ws;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Ss(e){let t=ws;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function _s(){return Ts()}function Es(){return Ts()}function Ts(){return new ys(e=>e.toString(),(e,t)=>e.isEqual(t))}const ks=new Or(In.comparator),Is=new Rr(In.comparator);function Cs(){let e=Is;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Ns=new Rr(gn);function As(){return Ns}function Ds(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tr(t)?"-0":t}}function Ms(e){return{integerValue:""+e}}function Os(e,t){return nr(t)?Ms(t):Ds(e,t)}class Ps{constructor(){this._=void 0}}function Ls(e,t,n){return e instanceof Fs?function(e,t){const n={fields:{[Kr]:{stringValue:Hr},[Wr]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Xr(t)&&(t=Yr(t)),t&&(n.fields[Qr]=t),{mapValue:n}}(n,t):e instanceof Vs?zs(e,t):e instanceof Us?Bs(e,t):function(e,t){const n=js(e,t),r=Gs(n)+Gs(e.Ae);return gi(n)&&gi(e.Ae)?Ms(r):Ds(e.serializer,r)}(e,t)}function Rs(e,t,n){return e instanceof Vs?zs(e,t):e instanceof Us?Bs(e,t):n}function js(e,t){return e instanceof qs?function(e){return gi(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Fs extends Ps{}class Vs extends Ps{constructor(e){super(),this.elements=e}}function zs(e,t){const n=Hs(t);for(const r of e.elements)n.some(e=>ai(e,r))||n.push(r);return{arrayValue:{values:n}}}class Us extends Ps{constructor(e){super(),this.elements=e}}function Bs(e,t){let n=Hs(t);for(const r of e.elements)n=n.filter(e=>!ai(e,r));return{arrayValue:{values:n}}}class qs extends Ps{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Gs(e){return qr(e.integerValue||e.doubleValue)}function Hs(e){return yi(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Ks{constructor(e,t){this.version=e,this.transformResults=t}}class Qs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qs}static exists(e){return new Qs(void 0,e)}static updateTime(e){return new Qs(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ws(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Xs{}function Ys(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new oo(e.key,Qs.none()):new to(e.key,e.data,Qs.none());{const n=e.data,r=Ei.empty();let i=new Rr(kn.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new no(e.key,r,new Fr(i.toArray()),Qs.none())}}function Js(e,t,n){e instanceof to?function(e,t,n){const r=e.value.clone(),i=io(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof no?function(e,t,n){if(!Ws(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=io(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ro(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function $s(e,t,n,r){return e instanceof to?function(e,t,n,r){if(!Ws(e.precondition,t))return n;const i=e.value.clone(),s=so(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof no?function(e,t,n,r){if(!Ws(e.precondition,t))return n;const i=so(e.fieldTransforms,r,t),s=t.data;return s.setAll(ro(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Ws(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Zs(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=js(r.transform,e||null);null!=i&&(null===n&&(n=Ei.empty()),n.set(r.field,i))}return n||null}function eo(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&xn(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Vs&&t instanceof Vs||e instanceof Us&&t instanceof Us?xn(e.elements,t.elements,ai):e instanceof qs&&t instanceof qs?ai(e.Ae,t.Ae):e instanceof Fs&&t instanceof Fs}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class to extends Xs{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class no extends Xs{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ro(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function io(e,t,n){const r=new Map;en(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Rs(o,a,n[i]))}return r}function so(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Ls(e,s,t))}return r}class oo extends Xs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ao extends Xs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lo{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Js(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=$s(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=$s(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Es();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Ys(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Vn.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Cs())}isEqual(e){return this.batchId===e.batchId&&xn(this.mutations,e.mutations,(e,t)=>eo(e,t))&&xn(this.baseMutations,e.baseMutations,(e,t)=>eo(e,t))}}class co{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){en(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=ks;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new co(e,t,n,r)}}class uo{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class ho{constructor(e,t){this.count=e,this.unchangedNames=t}}var fo,po;function mo(e){switch(e){case nn.OK:return $t(64938);case nn.CANCELLED:case nn.UNKNOWN:case nn.DEADLINE_EXCEEDED:case nn.RESOURCE_EXHAUSTED:case nn.INTERNAL:case nn.UNAVAILABLE:case nn.UNAUTHENTICATED:return!1;case nn.INVALID_ARGUMENT:case nn.NOT_FOUND:case nn.ALREADY_EXISTS:case nn.PERMISSION_DENIED:case nn.FAILED_PRECONDITION:case nn.ABORTED:case nn.OUT_OF_RANGE:case nn.UNIMPLEMENTED:case nn.DATA_LOSS:return!0;default:return $t(15467,{code:e})}}function go(e){if(void 0===e)return Xt("GRPC error has no .code"),nn.UNKNOWN;switch(e){case fo.OK:return nn.OK;case fo.CANCELLED:return nn.CANCELLED;case fo.UNKNOWN:return nn.UNKNOWN;case fo.DEADLINE_EXCEEDED:return nn.DEADLINE_EXCEEDED;case fo.RESOURCE_EXHAUSTED:return nn.RESOURCE_EXHAUSTED;case fo.INTERNAL:return nn.INTERNAL;case fo.UNAVAILABLE:return nn.UNAVAILABLE;case fo.UNAUTHENTICATED:return nn.UNAUTHENTICATED;case fo.INVALID_ARGUMENT:return nn.INVALID_ARGUMENT;case fo.NOT_FOUND:return nn.NOT_FOUND;case fo.ALREADY_EXISTS:return nn.ALREADY_EXISTS;case fo.PERMISSION_DENIED:return nn.PERMISSION_DENIED;case fo.FAILED_PRECONDITION:return nn.FAILED_PRECONDITION;case fo.ABORTED:return nn.ABORTED;case fo.OUT_OF_RANGE:return nn.OUT_OF_RANGE;case fo.UNIMPLEMENTED:return nn.UNIMPLEMENTED;case fo.DATA_LOSS:return nn.DATA_LOSS;default:return $t(39323,{code:e})}}(po=fo||(fo={}))[po.OK=0]="OK",po[po.CANCELLED=1]="CANCELLED",po[po.UNKNOWN=2]="UNKNOWN",po[po.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",po[po.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",po[po.NOT_FOUND=5]="NOT_FOUND",po[po.ALREADY_EXISTS=6]="ALREADY_EXISTS",po[po.PERMISSION_DENIED=7]="PERMISSION_DENIED",po[po.UNAUTHENTICATED=16]="UNAUTHENTICATED",po[po.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",po[po.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",po[po.ABORTED=10]="ABORTED",po[po.OUT_OF_RANGE=11]="OUT_OF_RANGE",po[po.UNIMPLEMENTED=12]="UNIMPLEMENTED",po[po.INTERNAL=13]="INTERNAL",po[po.UNAVAILABLE=14]="UNAVAILABLE",po[po.DATA_LOSS=15]="DATA_LOSS";let yo=null;function vo(){return new TextEncoder}const bo=new Ct([4294967295,4294967295],0);function wo(e){const t=vo().encode(e),n=new Nt;return n.update(t),new Uint8Array(n.digest())}function xo(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Ct([n,r],0),new Ct([i,s],0)]}class So{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new _o("Invalid padding: ".concat(t));if(n<0)throw new _o("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new _o("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new _o("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=Ct.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Ct.fromNumber(n)));return 1===r.compare(bo)&&(r=new Ct([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=wo(e),[n,r]=xo(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new So(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=wo(e),[n,r]=xo(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class _o extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Eo{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,To.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Eo(Vn.min(),r,new Or(gn),bs(),Cs())}}class To{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new To(n,t,Cs(),Cs(),Cs())}}class ko{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Io{constructor(e,t){this.targetId=e,this.Ce=t}}class Co{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zr.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class No{constructor(){this.ve=0,this.Fe=Mo(),this.Me=zr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Cs(),t=Cs(),n=Cs();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:$t(38017,{changeType:i})}}),new To(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Mo()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,en(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Ao{constructor(e){this.Ge=e,this.ze=new Map,this.je=bs(),this.Je=Do(),this.He=Do(),this.Ye=new Or(gn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:$t(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(Zi(s))if(0===n){const e=new In(s.path);this.et(t,e,ki.newNoDocument(e,Vn.min()))}else en(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var i;const n=this.ut(e),s=n?this.ct(n,e,r):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(i=yo)||void 0===i||i.lt(function(e,t,n,r,i){var s,o,a,l,c;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===i,hashCount:null!==(s=null===h||void 0===h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(o=null===h||void 0===h||null===(a=h.bits)||void 0===a||null===(a=a.bitmap)||void 0===a?void 0:a.length)&&void 0!==o?o:0,padding:null!==(l=null===h||void 0===h||null===(c=h.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Gr(n).toUint8Array()}catch(e){if(e instanceof Vr)return Yt("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new So(s,r,i)}catch(e){return Yt(e instanceof _o?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&Zi(i.target)){const t=new In(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,ki.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Cs();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Eo(e,t,this.Ye,this.je,n);return this.je=bs(),this.Je=Do(),this.He=Do(),this.Ye=new Or(gn),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new No,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Rr(gn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Rr(gn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||Wt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new No),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Do(){return new Or(In.comparator)}function Mo(){return new Or(In.comparator)}const Oo={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo={and:"AND",or:"OR"};class Ro{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function jo(e,t){return e.useProto3Json||er(t)?t:{value:t}}function Fo(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Vo(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function zo(e,t){return Fo(e,t.toTimestamp())}function Uo(e){return en(!!e,49232),Vn.fromTimestamp(function(e){const t=Br(e);return new Fn(t.seconds,t.nanos)}(e))}function Bo(e,t){return qo(e,t).canonicalString()}function qo(e,t){const n=function(e){return new En(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Go(e){const t=En.fromString(e);return en(ua(t),10190,{key:t.toString()}),t}function Ho(e,t){return Bo(e.databaseId,t.path)}function Ko(e,t){const n=Go(t);if(n.get(1)!==e.databaseId.projectId)throw new rn(nn.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new rn(nn.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new In(Yo(n))}function Qo(e,t){return Bo(e.databaseId,t)}function Wo(e){const t=Go(e);return 4===t.length?En.emptyPath():Yo(t)}function Xo(e){return new En(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Yo(e){return en(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Jo(e,t,n){return{name:Ho(e,t),fields:n.value.mapValue.fields}}function $o(e,t){let n;if(t instanceof to)n={update:Jo(e,t.key,t.value)};else if(t instanceof oo)n={delete:Ho(e,t.key)};else if(t instanceof no)n={update:Jo(e,t.key,t.data),updateMask:ca(t.fieldMask)};else{if(!(t instanceof ao))return $t(16599,{Vt:t.type});n={verify:Ho(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Fs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Vs)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Us)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof qs)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw $t(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:zo(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:$t(27497)}(e,t.precondition)),n}function Zo(e,t){return{documents:[Qo(e,t.path)]}}function ea(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Qo(e,i);const s=function(e){if(0!==e.length)return la(Pi.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:oa(e.field),direction:ra(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=jo(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function ta(e){let t=Wo(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){en(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=na(e);return t instanceof Pi&&Ri(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new Ai(aa(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,er(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Ii(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Ii(n,t)}(n.endAt)),ts(t,i,o,s,a,"F",l,c)}function na(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=aa(e.unaryFilter.field);return Oi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=aa(e.unaryFilter.field);return Oi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=aa(e.unaryFilter.field);return Oi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=aa(e.unaryFilter.field);return Oi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $t(61313);default:return $t(60726)}}(e):void 0!==e.fieldFilter?function(e){return Oi.create(aa(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $t(58110);default:return $t(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Pi.create(e.compositeFilter.filters.map(e=>na(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return $t(1026)}}(e.compositeFilter.op))}(e):$t(30097,{filter:e})}function ra(e){return Oo[e]}function ia(e){return Po[e]}function sa(e){return Lo[e]}function oa(e){return{fieldPath:e.canonicalString()}}function aa(e){return kn.fromServerFormat(e.fieldPath)}function la(e){return e instanceof Oi?function(e){if("=="===e.op){if(bi(e.value))return{unaryFilter:{field:oa(e.field),op:"IS_NAN"}};if(vi(e.value))return{unaryFilter:{field:oa(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(bi(e.value))return{unaryFilter:{field:oa(e.field),op:"IS_NOT_NAN"}};if(vi(e.value))return{unaryFilter:{field:oa(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oa(e.field),op:ia(e.op),value:e.value}}}(e):e instanceof Pi?function(e){const t=e.getFilters().map(e=>la(e));return 1===t.length?t[0]:{compositeFilter:{op:sa(e.op),filters:t}}}(e):$t(54877,{filter:e})}function ca(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function ua(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class ha{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vn.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Vn.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:zr.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new ha(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class da{constructor(e){this.yt=e}}function fa(e){const t=ta({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?cs(t,t.limit,"L"):t}class pa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(qr(e.integerValue));else if("doubleValue"in e){const n=qr(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),tr(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Br(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Gr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?_i(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):xi(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):$t(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const i=si,s=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(qr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),In.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}pa.Kt=new pa;class ma{constructor(){this.Cn=new ga}addToCollectionParentIndex(e,t){return this.Cn.add(t),Xn.resolve()}getCollectionParents(e,t){return Xn.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Xn.resolve()}deleteFieldIndex(e,t){return Xn.resolve()}deleteAllFieldIndexes(e){return Xn.resolve()}createTargetIndexes(e,t){return Xn.resolve()}getDocumentsMatchingTarget(e,t){return Xn.resolve(null)}getIndexType(e,t){return Xn.resolve(0)}getFieldIndexes(e,t){return Xn.resolve([])}getNextCollectionGroupToUpdate(e){return Xn.resolve(null)}getMinOffset(e,t){return Xn.resolve(Gn.min())}getMinOffsetFromCollectionGroup(e,t){return Xn.resolve(Gn.min())}updateCollectionGroup(e,t,n){return Xn.resolve()}updateIndexEntries(e,t){return Xn.resolve()}}class ga{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Rr(En.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Rr(En.comparator)).toArray()}}new Uint8Array(0);const ya={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},va=41943040;class ba{static withCacheSize(e){return new ba(e,ba.DEFAULT_COLLECTION_PERCENTILE,ba.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}ba.DEFAULT_COLLECTION_PERCENTILE=10,ba.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ba.DEFAULT=new ba(va,ba.DEFAULT_COLLECTION_PERCENTILE,ba.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ba.DISABLED=new ba(-1,0,0);class wa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new wa(0)}static cr(){return new wa(-1)}}const xa="LruGarbageCollector",Sa=1048576;function _a(e,t){let[n,r]=e,[i,s]=t;const o=gn(n,i);return 0===o?gn(r,s):o}class Ea{constructor(e){this.Ir=e,this.buffer=new Rr(_a),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();_a(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Ta{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){Wt(xa,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Jn(e)?Wt(xa,"Ignoring IndexedDB error during garbage collection: ",e):await Wn(e)}await this.Vr(3e5)})}}class ka{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Xn.resolve($n.ce);const n=new Ea(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Wt("LruGarbageCollector","Garbage collection skipped; disabled"),Xn.resolve(ya)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Wt("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),ya):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Wt("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Qt()<=_e.DEBUG&&Wt("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-c,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(a-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-a)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),Xn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function Ia(e,t){return new ka(e,t)}class Ca{constructor(){this.changes=new ys(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ki.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Xn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Na{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Aa{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&$s(n.mutation,e,Fr.empty(),Fn.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Cs()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cs();const r=_s();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=xs();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=_s();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Cs()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=bs();const s=Ts(),o=Ts();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof no)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),$s(o.mutation,t,o.mutation.getFieldMask(),Fn.now())):s.set(t.key,Fr.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new Na(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Ts();let r=new Or((e,t)=>e-t),i=Cs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Fr.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Cs()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=Es();l.forEach(e=>{if(!i.has(e)){const r=Ys(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Xn.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return In.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):is(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Xn.resolve(_s());let o=zn,a=i;return s.next(t=>Xn.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Xn.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,Cs())).next(e=>({batchId:o,changes:Ss(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new In(t)).next(e=>{let t=xs();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=xs();return this.indexManager.getCollectionParents(e,i).next(o=>Xn.forEach(o,o=>{const a=function(e,t){return new es(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,ki.newInvalidDocument(r)))});let n=xs();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&$s(s.mutation,r,Fr.empty(),Fn.now()),fs(t,r)&&(n=n.insert(e,r))}),n})}}class Da{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Xn.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Uo(e.createTime)}}(t)),Xn.resolve()}getNamedQuery(e,t){return Xn.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:fa(e.bundledQuery),readTime:Uo(e.readTime)}}(t)),Xn.resolve()}}class Ma{constructor(){this.overlays=new Or(In.comparator),this.qr=new Map}getOverlay(e,t){return Xn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=_s();return Xn.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Xn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Xn.resolve()}getOverlaysForCollection(e,t,n){const r=_s(),i=t.length+1,s=new In(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Xn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Or((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=_s(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=_s(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Xn.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new uo(t,n));let i=this.qr.get(t);void 0===i&&(i=Cs(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class Oa{constructor(){this.sessionToken=zr.EMPTY_BYTE_STRING}getSessionToken(e){return Xn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Xn.resolve()}}class Pa{constructor(){this.Qr=new Rr(La.$r),this.Ur=new Rr(La.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new La(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new La(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new In(new En([])),n=new La(t,e),r=new La(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new In(new En([])),n=new La(t,e),r=new La(t,e+1);let i=Cs();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new La(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class La{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return In.comparator(e.key,t.key)||gn(e.Yr,t.Yr)}static Kr(e,t){return gn(e.Yr,t.Yr)||In.comparator(e.key,t.key)}}class Ra{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Rr(La.$r)}checkEmpty(e){return Xn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new lo(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Zr=this.Zr.add(new La(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Xn.resolve(s)}lookupMutationBatch(e,t){return Xn.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return Xn.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Xn.resolve(0===this.mutationQueue.length?Zn:this.tr-1)}getAllMutationBatches(e){return Xn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new La(t,0),r=new La(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),Xn.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Rr(gn);return t.forEach(e=>{const t=new La(e,0),r=new La(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Xn.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;In.isDocumentKey(i)||(i=i.child(""));const s=new La(new In(i),0);let o=new Rr(gn);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},s),Xn.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){en(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Xn.forEach(t.mutations,r=>{const i=new La(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new La(t,0),r=this.Zr.firstAfterOrEqual(n);return Xn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Xn.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ja{constructor(e){this.ri=e,this.docs=new Or(In.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Xn.resolve(n?n.document.mutableCopy():ki.newInvalidDocument(t))}getEntries(e,t){let n=bs();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ki.newInvalidDocument(e))}),Xn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=bs();const s=t.path,o=new In(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Hn(qn(o),n)<=0||(r.has(o.key)||fs(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Xn.resolve(i)}getAllFromCollectionGroup(e,t,n,r){$t(9500)}ii(e,t){return Xn.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Fa(this)}getSize(e){return Xn.resolve(this.size)}}class Fa extends Ca{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Xn.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Va{constructor(e){this.persistence=e,this.si=new ys(e=>Ji(e),$i),this.lastRemoteSnapshotVersion=Vn.min(),this.highestTargetId=0,this.oi=0,this._i=new Pa,this.targetCount=0,this.ai=wa.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Xn.resolve()}getLastRemoteSnapshotVersion(e){return Xn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Xn.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Xn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Xn.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new wa(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Xn.resolve()}updateTargetData(e,t){return this.Pr(t),Xn.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Xn.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Xn.waitFor(i).next(()=>r)}getTargetCount(e){return Xn.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Xn.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Xn.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Xn.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Xn.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Xn.resolve(n)}containsKey(e,t){return Xn.resolve(this._i.containsKey(t))}}class za{constructor(e,t){this.ui={},this.overlays={},this.ci=new $n(0),this.li=!1,this.li=!0,this.hi=new Oa,this.referenceDelegate=e(this),this.Pi=new Va(this),this.indexManager=new ma,this.remoteDocumentCache=function(e){return new ja(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new da(t),this.Ii=new Da(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ma,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Ra(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Wt("MemoryPersistence","Starting transaction:",e);const r=new Ua(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Xn.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Ua extends Qn{constructor(e){super(),this.currentSequenceNumber=e}}class Ba{constructor(e){this.persistence=e,this.Ri=new Pa,this.Vi=null}static mi(e){return new Ba(e)}get fi(){if(this.Vi)return this.Vi;throw $t(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Xn.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Xn.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Xn.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xn.forEach(this.fi,n=>{const r=In.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Vn.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Xn.or([()=>Xn.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class qa{constructor(e,t){this.persistence=e,this.pi=new ys(e=>ir(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Ia(this,t)}static mi(e,t){return new qa(e,t)}Ei(){}di(e){return Xn.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Xn.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Xn.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,Vn.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Xn.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Xn.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Xn.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Xn.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=pi(e.data.value)),t}br(e,t,n){return Xn.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Xn.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ga{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Cs(),r=Cs();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Ga(e,t.fromCache,n,r)}}class Ha{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ka{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=ue()?8:Yn(le())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Ha;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Qt()<=_e.DEBUG&&Wt("QueryEngine","SDK will not create cache indexes for query:",ds(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Xn.resolve()):(Qt()<=_e.DEBUG&&Wt("QueryEngine","Query:",ds(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Qt()<=_e.DEBUG&&Wt("QueryEngine","The SDK decides to create cache indexes for query:",ds(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,os(t))):Xn.resolve())}ys(e,t){if(rs(t))return Xn.resolve(null);let n=os(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=cs(t,null,"F"),n=os(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Cs(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,i,n.readTime)?this.ys(e,cs(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return rs(t)||r.isEqual(Vn.min())?Xn.resolve(null):this.ps.getDocuments(e,n).next(i=>{const s=this.Ds(t,i);return this.Cs(t,s,n,r)?Xn.resolve(null):(Qt()<=_e.DEBUG&&Wt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ds(t)),this.vs(e,s,t,Bn(r,zn)).next(e=>e))})}Ds(e,t){let n=new Rr(ms(e));return t.forEach((t,r)=>{fs(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Qt()<=_e.DEBUG&&Wt("QueryEngine","Using full collection scan to execute query:",ds(t)),this.ps.getDocumentsMatchingQuery(e,t,Gn.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Qa="LocalStore";class Wa{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Or(gn),this.xs=new ys(e=>Ji(e),$i),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Aa(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Xa(e,t,n,r){return new Wa(e,t,n,r)}async function Ya(e,t){const n=tn(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=Cs();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:s}))})})}function Ja(e){const t=tn(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function $a(e,t,n){let r=Cs(),i=Cs();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=bs();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Vn.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Wt(Qa,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{ks:r,qs:i}})}function Za(e,t){const n=tn(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Zn),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function el(e,t){const n=tn(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,Xn.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new ha(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function tl(e,t,n){const r=tn(e),i=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Jn(e))throw e;Wt(Qa,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function nl(e,t,n){const r=tn(e);let i=Vn.min(),s=Cs();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=tn(e),i=r.xs.get(n);return void 0!==i?Xn.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,os(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:Vn.min(),n?s:Cs())).next(e=>(rl(r,ps(t),e),{documents:e,Qs:s})))}function rl(e,t,n){let r=e.Os.get(t)||Vn.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class il{constructor(){this.activeTargetIds=As()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sl{constructor(){this.Mo=new il,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new il,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ol{Oo(e){}shutdown(){}}const al="ConnectivityMonitor";class ll{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Wt(al,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Wt(al,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let cl=null;function ul(){return null===cl?cl=268435456+Math.round(2147483648*Math.random()):cl++,"0x"+cl.toString(16)}const hl="RestConnection",dl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fl{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Zr?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,i){const s=ul(),o=this.zo(e,t.toUriEncodedString());Wt(hl,"Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,i);const{host:l}=new URL(o),c=ie(l);return this.Jo(e,o,a,n,c).then(t=>(Wt(hl,"Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw Yt(hl,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t})}Ho(e,t,n,r,i,s){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ht,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=dl[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class pl{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ml="WebChannelConnection";class gl extends fl{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=ul();return new Promise((i,o)=>{const a=new Mt;a.setWithCredentials(!0),a.listenOnce(Pt.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Lt.NO_ERROR:const n=a.getResponseJson();Wt(ml,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(n)),i(n);break;case Lt.TIMEOUT:Wt(ml,"RPC '".concat(e,"' ").concat(s," timed out")),o(new rn(nn.DEADLINE_EXCEEDED,"Request time out"));break;case Lt.HTTP_ERROR:const r=a.getStatus();if(Wt(ml,"RPC '".concat(e,"' ").concat(s," failed with status:"),r,"response text:",a.getResponseText()),r>0){var t;let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(nn).indexOf(t)>=0?t:nn.UNKNOWN}(n.status);o(new rn(e,n.message))}else o(new rn(nn.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new rn(nn.UNAVAILABLE,"Connection failed."));break;default:$t(9055,{l_:e,streamId:s,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{Wt(ml,"RPC '".concat(e,"' ").concat(s," completed."))}});const l=JSON.stringify(r);Wt(ml,"RPC '".concat(e,"' ").concat(s," sending request:"),r),a.send(t,"POST",l,n,15)})}T_(e,t,n){const r=ul(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Vt(),o=Ft(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");Wt(ml,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),a);const u=s.createWebChannel(c,a);this.I_(u);let h=!1,d=!1;const f=new pl({Yo:t=>{d?Wt(ml,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Wt(ml,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),Wt(ml,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Ot.EventType.OPEN,()=>{d||(Wt(ml,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.o_())}),p(u,Ot.EventType.CLOSE,()=>{d||(d=!0,Wt(ml,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.a_(),this.E_(u))}),p(u,Ot.EventType.ERROR,t=>{d||(d=!0,Yt(ml,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),f.a_(new rn(nn.UNAVAILABLE,"The operation could not be completed")))}),p(u,Ot.EventType.MESSAGE,t=>{if(!d){var n;const i=t.data[0];en(!!i,16349);const s=i,o=(null===s||void 0===s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Wt(ml,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=fo[e];if(void 0!==t)return go(t)}(t),i=o.message;void 0===n&&(n=nn.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.a_(new rn(n,i)),u.close()}else Wt(ml,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.u_(i)}}),p(o,jt.STAT_EVENT,t=>{t.stat===Rt.PROXY?Wt(ml,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Rt.NOPROXY&&Wt(ml,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function yl(){return"undefined"!=typeof document?document:null}function vl(e){return new Ro(e,!0)}class bl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Wt("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const wl="PersistentStream";class xl{constructor(e,t,n,r,i,s,o,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new bl(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===nn.RESOURCE_EXHAUSTED?(Xt(t.toString()),Xt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===nn.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new rn(nn.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Wt(wl,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Wt(wl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Sl extends xl{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:$t(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(en(void 0===t||"string"==typeof t,58123),zr.fromBase64String(t||"")):(en(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),zr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?nn.UNKNOWN:go(e.code);return new rn(t,e.message||"")}(o);n=new Co(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ko(e,r.document.name),s=Uo(r.document.updateTime),o=r.document.createTime?Uo(r.document.createTime):Vn.min(),a=new Ei({mapValue:{fields:r.document.fields}}),l=ki.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new ko(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ko(e,r.document),s=r.readTime?Uo(r.readTime):Vn.min(),o=ki.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ko([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ko(e,r.document),s=r.removedTargetIds||[];n=new ko([],s,i,null)}else{if(!("filter"in t))return $t(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new ho(r,i),o=e.targetId;n=new Io(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Vn.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Vn.min():t.readTime?Uo(t.readTime):Vn.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Xo(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Zi(r)?{documents:Zo(e,r)}:{query:ea(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Vo(e,t.resumeToken);const r=jo(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Vn.min())>0){n.readTime=Fo(e,t.snapshotVersion.toTimestamp());const r=jo(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $t(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Xo(this.serializer),t.removeTarget=e,this.q_(t)}}class _l extends xl{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return en(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,en(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){en(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(en(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Uo(e.updateTime):Uo(t);return n.isEqual(Vn.min())&&(n=Uo(t)),new Ks(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Uo(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Xo(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>$o(this.serializer,e))};this.q_(t)}}class El{}class Tl extends El{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new rn(nn.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Go(e,qo(t,n),r,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===nn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new rn(nn.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Ho(e,qo(t,n),r,o,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===nn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new rn(nn.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class kl{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(Xt(t),this.aa=!1):Wt("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Il="RemoteStore";class Cl{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{jl(this)&&(Wt(Il,"Restarting streams for network reachability change."),await async function(e){const t=tn(e);t.Ea.add(4),await Al(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Nl(t)}(this))})}),this.Ra=new kl(n,r)}}async function Nl(e){if(jl(e))for(const t of e.da)await t(!0)}async function Al(e){for(const t of e.da)await t(!1)}function Dl(e,t){const n=tn(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Rl(n)?Ll(n):nc(n).O_()&&Ol(n,t))}function Ml(e,t){const n=tn(e),r=nc(n);n.Ia.delete(t),r.O_()&&Pl(n,t),0===n.Ia.size&&(r.O_()?r.L_():jl(n)&&n.Ra.set("Unknown"))}function Ol(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Vn.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}nc(e).Y_(t)}function Pl(e,t){e.Va.Ue(t),nc(e).Z_(t)}function Ll(e){e.Va=new Ao({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),nc(e).start(),e.Ra.ua()}function Rl(e){return jl(e)&&!nc(e).x_()&&e.Ia.size>0}function jl(e){return 0===tn(e).Ea.size}function Fl(e){e.Va=void 0}async function Vl(e){e.Ra.set("Online")}async function zl(e){e.Ia.forEach((t,n)=>{Ol(e,t)})}async function Ul(e,t){Fl(e),Rl(e)?(e.Ra.ha(t),Ll(e)):e.Ra.set("Unknown")}async function Bl(e,t,n){if(e.Ra.set("Online"),t instanceof Co&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){Wt(Il,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ql(e,n)}else if(t instanceof ko?e.Va.Ze(t):t instanceof Io?e.Va.st(t):e.Va.tt(t),!n.isEqual(Vn.min()))try{const t=await Ja(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(zr.EMPTY_BYTE_STRING,r.snapshotVersion)),Pl(e,t);const i=new ha(r.target,t,n,r.sequenceNumber);Ol(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Wt(Il,"Failed to raise snapshot:",t),await ql(e,t)}}async function ql(e,t,n){if(!Jn(t))throw t;e.Ea.add(1),await Al(e),e.Ra.set("Offline"),n||(n=()=>Ja(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Wt(Il,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Nl(e)})}function Gl(e,t){return t().catch(n=>ql(e,n,t))}async function Hl(e){const t=tn(e),n=rc(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Zn;for(;Kl(t);)try{const e=await Za(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Ql(t,e)}catch(e){await ql(t,e)}Wl(t)&&Xl(t)}function Kl(e){return jl(e)&&e.Ta.length<10}function Ql(e,t){e.Ta.push(t);const n=rc(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Wl(e){return jl(e)&&!rc(e).x_()&&e.Ta.length>0}function Xl(e){rc(e).start()}async function Yl(e){rc(e).ra()}async function Jl(e){const t=rc(e);for(const n of e.Ta)t.ea(n.mutations)}async function $l(e,t,n){const r=e.Ta.shift(),i=co.from(r,t,n);await Gl(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Hl(e)}async function Zl(e,t){t&&rc(e).X_&&await async function(e,t){if(function(e){return mo(e)&&e!==nn.ABORTED}(t.code)){const n=e.Ta.shift();rc(e).B_(),await Gl(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Hl(e)}}(e,t),Wl(e)&&Xl(e)}async function ec(e,t){const n=tn(e);n.asyncQueue.verifyOperationInProgress(),Wt(Il,"RemoteStore received new credentials");const r=jl(n);n.Ea.add(3),await Al(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Nl(n)}async function tc(e,t){const n=tn(e);t?(n.Ea.delete(2),await Nl(n)):t||(n.Ea.add(2),await Al(n),n.Ra.set("Unknown"))}function nc(e){return e.ma||(e.ma=function(e,t,n){const r=tn(e);return r.sa(),new Sl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Vl.bind(null,e),t_:zl.bind(null,e),r_:Ul.bind(null,e),H_:Bl.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Rl(e)?Ll(e):e.Ra.set("Unknown")):(await e.ma.stop(),Fl(e))})),e.ma}function rc(e){return e.fa||(e.fa=function(e,t,n){const r=tn(e);return r.sa(),new _l(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Yl.bind(null,e),r_:Zl.bind(null,e),ta:Jl.bind(null,e),na:$l.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Hl(e)):(await e.fa.stop(),e.Ta.length>0&&(Wt(Il,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class ic{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new sn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new ic(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new rn(nn.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sc(e,t){if(Xt("AsyncQueue","".concat(t,": ").concat(e)),Jn(e))return new rn(nn.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class oc{static emptySet(e){return new oc(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||In.comparator(t.key,n.key):(e,t)=>In.comparator(e.key,t.key),this.keyedMap=xs(),this.sortedSet=new Or(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof oc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new oc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ac{constructor(){this.ga=new Or(In.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):$t(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class lc{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new lc(e,t,oc.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&us(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class cc{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class uc{constructor(){this.queries=hc(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=tn(e),r=n.queries;n.queries=hc(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new rn(nn.ABORTED,"Firestore shutting down"))}}function hc(){return new ys(e=>hs(e),us)}async function dc(e,t){const n=tn(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.ba()&&t.Da()&&(r=2):(s=new cc,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=sc(e,"Initialization of query '".concat(ds(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&gc(n)}async function fc(e,t){const n=tn(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.Da()?0:1:!s.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function pc(e,t){const n=tn(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&gc(n)}function mc(e,t,n){const r=tn(e),i=r.queries.get(t);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(t)}function gc(e){e.Ca.forEach(e=>{e.next()})}var yc,vc;(vc=yc||(yc={})).Ma="default",vc.Cache="cache";class bc{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new lc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=lc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yc.Cache}}class wc{constructor(e){this.key=e}}class xc{constructor(e){this.key=e}}class Sc{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Cs(),this.mutatedKeys=Cs(),this.eu=ms(e),this.tu=new oc(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new ac,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=fs(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.eu(u,a)>0||l&&this.eu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $t(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const o=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,l=a!==this.Za;return this.Za=a,0!==s.length||l?{snapshot:new lc(this.query,e.tu,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ac,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Cs(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new xc(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new wc(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Cs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return lc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const _c="SyncEngine";class Ec{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Tc{constructor(e){this.key=e,this.hu=!1}}class kc{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new ys(e=>hs(e),us),this.Iu=new Map,this.Eu=new Set,this.du=new Or(In.comparator),this.Au=new Map,this.Ru=new Pa,this.Vu={},this.mu=new Map,this.fu=wa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Ic(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Wc(e);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Nc(r,t,n,!0),i}async function Cc(e,t){const n=Wc(e);await Nc(n,t,!0,!1)}async function Nc(e,t,n,r){const i=await el(e.localStore,os(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Ac(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Dl(e.remoteStore,i),a}async function Ac(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await nl(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Bc(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const s=await nl(e.localStore,t,!0),o=new Sc(t,s.Qs),a=o.ru(s.documents),l=To.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);Bc(e,n,c.au);const u=new Ec(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function Dc(e,t,n){const r=tn(e),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(e=>!us(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await tl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ml(r.remoteStore,i.targetId),zc(r,i.targetId)}).catch(Wn)):(zc(r,i.targetId),await tl(r.localStore,i.targetId,!0))}async function Mc(e,t){const n=tn(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ml(n.remoteStore,r.targetId))}async function Oc(e,t){const n=tn(e);try{const e=await function(e,t){const n=tn(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(zr.EMPTY_BYTE_STRING,Vn.min()).withLastLimboFreeSnapshotVersion(Vn.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&o.push(n.Pi.updateTargetData(e,c))});let a=bs(),l=Cs();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push($a(e,s,t.documentUpdates).next(e=>{a=e.ks,l=e.qs})),!r.isEqual(Vn.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Xn.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(en(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?en(r.hu,14607):e.removedDocuments.size>0&&(en(r.hu,42227),r.hu=!1))}),await Hc(n,e,t)}catch(e){await Wn(e)}}function Pc(e,t,n){const r=tn(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=tn(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&gc(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Lc(e,t,n){const r=tn(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),s=i&&i.key;if(s){let e=new Or(In.comparator);e=e.insert(s,ki.newNoDocument(s,Vn.min()));const n=Cs().add(s),i=new Eo(Vn.min(),new Map,new Or(gn),e,n);await Oc(r,i),r.du=r.du.remove(s),r.Au.delete(t),Gc(r)}else await tl(r.localStore,t,!1).then(()=>zc(r,t,n)).catch(Wn)}async function Rc(e,t){const n=tn(e),r=t.batch.batchId;try{const e=await function(e,t){const n=tn(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Xn.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);en(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Cs();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Vc(n,r,null),Fc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Hc(n,e)}catch(e){await Wn(e)}}async function jc(e,t,n){const r=tn(e);try{const e=await function(e,t){const n=tn(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(en(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Vc(r,t,n),Fc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Hc(r,e)}catch(n){await Wn(n)}}function Fc(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Vc(e,t,n){const r=tn(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function zc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Uc(e,t)})}function Uc(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Ml(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Gc(e))}function Bc(e,t,n){for(const r of n)r instanceof wc?(e.Ru.addReference(r.key,t),qc(e,r)):r instanceof xc?(Wt(_c,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Uc(e,r.key)):$t(19791,{wu:r})}function qc(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(Wt(_c,"New document in limbo: "+n),e.Eu.add(r),Gc(e))}function Gc(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new In(En.fromString(t)),r=e.fu.next();e.Au.set(r,new Tc(n)),e.du=e.du.insert(n,r),Dl(e.remoteStore,new ha(os(ns(n.path)),r,"TargetPurposeLimboResolution",$n.ce))}}async function Hc(e,t,n){const r=tn(e),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{o.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const i=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Ga.As(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(e,t){const n=tn(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Xn.forEach(t,t=>Xn.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Xn.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Jn(e))throw e;Wt(Qa,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,s))}async function Kc(e,t){const n=tn(e);if(!n.currentUser.isEqual(t)){Wt(_c,"User change. New user:",t.toKey());const e=await Ya(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new rn(nn.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Hc(n,e.Ls)}}function Qc(e,t){const n=tn(e),r=n.Au.get(t);if(r&&r.hu)return Cs().add(r.key);{let e=Cs();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Wc(e){const t=tn(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Oc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Lc.bind(null,t),t.Pu.H_=pc.bind(null,t.eventManager),t.Pu.yu=mc.bind(null,t.eventManager),t}function Xc(e){const t=tn(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Rc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=jc.bind(null,t),t}class Yc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Xa(this.persistence,new Ka,e.initialUser,this.serializer)}Cu(e){return new za(Ba.mi,this.serializer)}Du(e){return new sl}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yc.provider={build:()=>new Yc};class Jc extends Yc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){en(this.persistence.referenceDelegate instanceof qa,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ta(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?ba.withCacheSize(this.cacheSizeBytes):ba.DEFAULT;return new za(e=>qa.mi(e,t),this.serializer)}}class $c{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Pc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kc.bind(null,this.syncEngine),await tc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new uc}createDatastore(e){const t=vl(e.databaseInfo.databaseId),n=function(e){return new gl(e)}(e.databaseInfo);return function(e,t,n,r){return new Tl(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Cl(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Pc(this.syncEngine,e,0),ll.v()?new ll:new ol)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new kc(e,t,n,r,i,s);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=tn(e);Wt(Il,"RemoteStore shutting down."),t.Ea.add(5),await Al(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}$c.provider={build:()=>new $c};class Zc{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class eu{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new rn(nn.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=tn(e),r={documents:t.map(e=>Ho(n.serializer,e))},i=await n.Ho("BatchGetDocuments",n.serializer.databaseId,En.emptyPath(),r,t.length),s=new Map;i.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){en(!!t.found,43571),t.found.name,t.found.updateTime;const n=Ko(e,t.found.name),r=Uo(t.found.updateTime),i=t.found.createTime?Uo(t.found.createTime):Vn.min(),s=new Ei({mapValue:{fields:t.found.fields}});return ki.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){en(!!t.missing,3894),en(!!t.readTime,22933);const n=Ko(e,t.missing),r=Uo(t.readTime);return ki.newNoDocument(n,r)}(e,t):$t(7234,{result:t})}(n.serializer,e);s.set(t.key.toString(),t)});const o=[];return t.forEach(e=>{const t=s.get(e.toString());en(!!t,55234,{key:e}),o.push(t)}),o}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new oo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=In.fromPath(t);this.mutations.push(new ao(n,this.precondition(n)))}),await async function(e,t){const n=tn(e),r={writes:t.map(e=>$o(n.serializer,e))};await n.Go("Commit",n.serializer.databaseId,En.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $t(50498,{Gu:e.constructor.name});t=Vn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new rn(nn.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Vn.min())?Qs.exists(!1):Qs.updateTime(t):Qs.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Vn.min()))throw new rn(nn.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qs.updateTime(t)}return Qs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class tu{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.zu=n.maxAttempts,this.M_=new bl(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new eu(this.datastore),t=this.Hu(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Yu(e)}))}).catch(e=>{this.Yu(e)})})}Hu(e){try{const t=this.updateFunction(e);return!er(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if("FirebaseError"===(null===e||void 0===e?void 0:e.name)){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!mo(t)}return!1}}const nu="FirestoreClient";class ru{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Gt.UNAUTHENTICATED,this.clientId=mn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{Wt(nu,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Wt(nu,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=sc(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function iu(e,t){e.asyncQueue.verifyOperationInProgress(),Wt(nu,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Ya(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function su(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ou(e);Wt(nu,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>ec(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>ec(t.remoteStore,n)),e._onlineComponents=t}async function ou(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Wt(nu,"Using user provided OfflineComponentProvider");try{await iu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===nn.FAILED_PRECONDITION||e.code===nn.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Yt("Error using user provided cache. Falling back to memory cache: "+n),await iu(e,new Yc)}}else Wt(nu,"Using default OfflineComponentProvider"),await iu(e,new Jc(void 0));return e._offlineComponents}async function au(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Wt(nu,"Using user provided OnlineComponentProvider"),await su(e,e._uninitializedComponentsProvider._online)):(Wt(nu,"Using default OnlineComponentProvider"),await su(e,new $c))),e._onlineComponents}function lu(e){return au(e).then(e=>e.syncEngine)}function cu(e){return au(e).then(e=>e.datastore)}async function uu(e){const t=await au(e),n=t.eventManager;return n.onListen=Ic.bind(null,t.syncEngine),n.onUnlisten=Dc.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Cc.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Mc.bind(null,t.syncEngine),n}function hu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new sn;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Zc({next:a=>{s.Nu(),t.enqueueAndForget(()=>fc(e,o));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new rn(nn.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new rn(nn.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new bc(ns(n.path),s,{includeMetadataChanges:!0,qa:!0});return dc(e,o)}(await uu(e),e.asyncQueue,t,n,r)),r.promise}function du(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const fu=new Map,pu="firestore.googleapis.com",mu=!0;class gu{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new rn(nn.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pu,this.ssl=mu}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:mu;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=va;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Sa)throw new rn(nn.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new rn(nn.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=du(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new rn(nn.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new rn(nn.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new rn(nn.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rn(nn.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new rn(nn.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gu(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new an;switch(e.type){case"firstParty":return new hn(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new rn(nn.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=fu.get(e);t&&(Wt("ComponentProvider","Removing Datastore"),fu.delete(e),t.terminate())}(this),Promise.resolve()}}function vu(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=On(e,yu);const s=ie(t),o=e._getSettings(),a=(0,r.A)((0,r.A)({},o),{},{emulatorOptions:e._getEmulatorOptions()}),l="".concat(t,":").concat(n);s&&(async function(e){(await fetch(e,{credentials:"include"})).ok}("https://".concat(l)),ae("Firestore",!0)),o.host!==pu&&o.host!==l&&Yt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=(0,r.A)((0,r.A)({},o),{},{host:l,ssl:s,emulatorOptions:i});if(!me(c,a)&&(e._setSettings(c),i.mockUserToken)){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=Gt.MOCK_USER;else{var u;t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=(0,r.A)({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[J(JSON.stringify({alg:"none",type:"JWT"})),J(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new rn(nn.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Gt(s)}e._authCredentials=new ln(new on(t,n))}}class bu{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new bu(this.firestore,e,this._query)}}class wu{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wu(this.firestore,e,this._key)}toJSON(){return{type:wu._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Ln(t,wu._jsonSchema))return new wu(e,n||null,new In(En.fromString(t.referencePath)))}}wu._jsonSchemaVersion="firestore/documentReference/1.0",wu._jsonSchema={type:Pn("string",wu._jsonSchemaVersion),referencePath:Pn("string")};class xu extends bu{constructor(e,t,n){super(e,t,ns(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wu(this.firestore,null,new In(e))}withConverter(e){return new xu(this.firestore,e,this._path)}}function Su(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ye(e),Cn("collection","path",t),e instanceof yu){const n=En.fromString(t,...r);return An(n),new xu(e,null,n)}{if(!(e instanceof wu||e instanceof xu))throw new rn(nn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(En.fromString(t,...r));return An(n),new xu(e.firestore,null,n)}}function _u(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ye(e),1===arguments.length&&(t=mn.newId()),Cn("doc","path",t),e instanceof yu){const n=En.fromString(t,...r);return Nn(n),new wu(e,null,new In(n))}{if(!(e instanceof wu||e instanceof xu))throw new rn(nn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(En.fromString(t,...r));return Nn(n),new wu(e.firestore,e instanceof xu?e.converter:null,new In(n))}}const Eu="AsyncQueue";class Tu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new bl(this,"async_queue_retry"),this._c=()=>{const e=yl();e&&Wt(Eu,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=yl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new sn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Jn(e))throw e;Wt(Eu,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,Xt("INTERNAL UNHANDLED ERROR: ",ku(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=ic.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&$t(47125,{Pc:ku(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ku(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Iu(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Cu extends yu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Tu,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Tu(e),this._firestoreClient=void 0,await e}}}function Nu(e){if(e._terminated)throw new rn(nn.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Au(e),e._firestoreClient}function Au(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new $r(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,du(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new ru(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Du{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Du(zr.fromBase64String(e))}catch(e){throw new rn(nn.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Du(zr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Du._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ln(e,Du._jsonSchema))return Du.fromBase64String(e.bytes)}}Du._jsonSchemaVersion="firestore/bytes/1.0",Du._jsonSchema={type:Pn("string",Du._jsonSchemaVersion),bytes:Pn("string")};class Mu{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new rn(nn.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ou{constructor(e){this._methodName=e}}class Pu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new rn(nn.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new rn(nn.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return gn(this._lat,e._lat)||gn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pu._jsonSchemaVersion}}static fromJSON(e){if(Ln(e,Pu._jsonSchema))return new Pu(e.latitude,e.longitude)}}Pu._jsonSchemaVersion="firestore/geoPoint/1.0",Pu._jsonSchema={type:Pn("string",Pu._jsonSchemaVersion),latitude:Pn("number"),longitude:Pn("number")};class Lu{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Lu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ln(e,Lu._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Lu(e.vectorValues);throw new rn(nn.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Lu._jsonSchemaVersion="firestore/vectorValue/1.0",Lu._jsonSchema={type:Pn("string",Lu._jsonSchemaVersion),vectorValues:Pn("object")};const Ru=/^__.*__$/;class ju{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new no(e,this.data,this.fieldMask,t,this.fieldTransforms):new to(e,this.data,t,this.fieldTransforms)}}class Fu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new no(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Vu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $t(40011,{Ac:e})}}class zu{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new zu((0,r.A)((0,r.A)({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return th(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Vu(this.Ac)&&Ru.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Uu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||vl(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new zu({Ac:e,methodName:t,Dc:n,path:kn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Bu(e){const t=e._freezeSettings(),n=vl(e._databaseId);return new Uu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function qu(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Cc(s.merge||s.mergeFields?2:0,t,n,i);Ju("Data must be an object, but it was:",o,r);const a=Xu(r,o);let l,c;if(s.merge)l=new Fr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=$u(t,r,n);if(!o.contains(i))throw new rn(nn.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));nh(e,i)||e.push(i)}l=new Fr(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new ju(new Ei(a),l,c)}class Gu extends Ou{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gu}}function Hu(e,t,n,r){const i=e.Cc(1,t,n);Ju("Data must be an object, but it was:",i,r);const s=[],o=Ei.empty();Dr(r,(e,r)=>{const a=eh(t,e,n);r=ye(r);const l=i.yc(a);if(r instanceof Gu)s.push(a);else{const e=Wu(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new Fr(s);return new Fu(o,a,i.fieldTransforms)}function Ku(e,t,n,r,i,s){const o=e.Cc(1,t,n),a=[$u(t,r,n)],l=[i];if(s.length%2!=0)throw new rn(nn.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<s.length;d+=2)a.push($u(t,s[d])),l.push(s[d+1]);const c=[],u=Ei.empty();for(let d=a.length-1;d>=0;--d)if(!nh(c,a[d])){const e=a[d];let t=l[d];t=ye(t);const n=o.yc(e);if(t instanceof Gu)c.push(e);else{const r=Wu(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Fr(c);return new Fu(u,h,o.fieldTransforms)}function Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Wu(n,e.Cc(r?4:3,t))}function Wu(e,t){if(Yu(e=ye(e)))return Ju("Unsupported field value:",t,e),Xu(e,t);if(e instanceof Ou)return function(e,t){if(!Vu(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Wu(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=ye(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Os(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Fn.fromDate(e);return{timestampValue:Fo(t.serializer,n)}}if(e instanceof Fn){const n=new Fn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Fo(t.serializer,n)}}if(e instanceof Pu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Du)return{bytesValue:Vo(t.serializer,e._byteString)};if(e instanceof wu){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Bo(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Lu)return function(e,t){return{mapValue:{fields:{[ti]:{stringValue:ii},[si]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return Ds(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(Mn(e)))}(e,t)}function Xu(e,t){const n={};return Mr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Dr(e,(e,r)=>{const i=Wu(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Yu(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Fn||e instanceof Pu||e instanceof Du||e instanceof wu||e instanceof Ou||e instanceof Lu)}function Ju(e,t,n){if(!Yu(n)||!Dn(n)){const r=Mn(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function $u(e,t,n){if((t=ye(t))instanceof Mu)return t._internalPath;if("string"==typeof t)return eh(e,t);throw th("Field path arguments must be of type string or ",e,!1,void 0,n)}const Zu=new RegExp("[~\\*/\\[\\]]");function eh(e,t,n){if(t.search(Zu)>=0)throw th("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Mu(...t.split("."))._internalPath}catch(r){throw th("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function th(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(r)),o&&(l+=" in document ".concat(i)),l+=")"),new rn(nn.INVALID_ARGUMENT,a+e+l)}function nh(e,t){return e.some(e=>e.isEqual(t))}class rh{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new wu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new ih(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(sh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ih extends rh{data(){return super.data()}}function sh(e,t){return"string"==typeof t?eh(e,t):t instanceof Mu?t._internalPath:t._delegate._internalPath}function oh(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new rn(nn.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ah{}class lh extends ah{}function ch(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof ah&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof hh).length,n=e.filter(e=>e instanceof uh).length;if(t>1||t>0&&n>0)throw new rn(nn.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class uh extends lh{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new uh(e,t,n)}_apply(e){const t=this._parse(e);return gh(e._query,t),new bu(e.firestore,e.converter,ls(e._query,t))}_parse(e){const t=Bu(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new rn(nn.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){mh(o,s);const t=[];for(const n of o)t.push(ph(r,e,n));a={arrayValue:{values:t}}}else a=ph(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||mh(o,s),a=Qu(n,t,o,"in"===s||"not-in"===s);return Oi.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class hh extends ah{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new hh(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Pi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)gh(n,i),n=ls(n,i)}(e._query,t),new bu(e.firestore,e.converter,ls(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class dh extends lh{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new dh(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new rn(nn.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new rn(nn.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ai(t,n)}(e._query,this._field,this._direction);return new bu(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new es(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function fh(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=sh("orderBy",e);return dh._create(n,t)}function ph(e,t,n){if("string"==typeof(n=ye(n))){if(""===n)throw new rn(nn.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!is(t)&&-1!==n.indexOf("/"))throw new rn(nn.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(En.fromString(n));if(!In.isDocumentKey(r))throw new rn(nn.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return mi(e,new In(r))}if(n instanceof wu)return mi(e,n._key);throw new rn(nn.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Mn(n),"."))}function mh(e,t){if(!Array.isArray(e)||0===e.length)throw new rn(nn.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function gh(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new rn(nn.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new rn(nn.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class yh{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(oi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $t(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Dr(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[si].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>qr(e.doubleValue));return new Lu(n)}convertGeoPoint(e){return new Pu(qr(e.latitude),qr(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Yr(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Jr(e));default:return null}}convertTimestamp(e){const t=Br(e);return new Fn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=En.fromString(e);en(ua(n),9688,{name:e});const r=new ei(n.get(1),n.get(3)),i=new In(n.popFirst(5));return r.isEqual(t)||Xt("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function vh(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class bh extends yh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Du(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wu(this.firestore,null,t)}}class wh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xh extends rh{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Sh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(sh("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new rn(nn.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}xh._jsonSchemaVersion="firestore/documentSnapshot/1.0",xh._jsonSchema={type:Pn("string",xh._jsonSchemaVersion),bundleSource:Pn("string","DocumentSnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class Sh extends xh{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class _h{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new wh(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Sh(this._firestore,this._userDataWriter,n.key,n,new wh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new rn(nn.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Sh(e._firestore,e._userDataWriter,n.doc.key,n.doc,new wh(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Sh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new wh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Eh(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new rn(nn.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_h._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=mn.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Eh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $t(61501,{type:e})}}function Th(e){e=On(e,wu);const t=On(e.firestore,Cu);return hu(Nu(t),e._key).then(n=>Oh(t,e,n))}_h._jsonSchemaVersion="firestore/querySnapshot/1.0",_h._jsonSchema={type:Pn("string",_h._jsonSchemaVersion),bundleSource:Pn("string","QuerySnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class kh extends yh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Du(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wu(this.firestore,null,t)}}function Ih(e,t,n){e=On(e,wu);const r=On(e.firestore,Cu),i=vh(e.converter,t,n);return Mh(r,[qu(Bu(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Qs.none())])}function Ch(e,t,n){e=On(e,wu);const r=On(e.firestore,Cu),i=Bu(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=ye(t))||t instanceof Mu?Ku(i,"updateDoc",e._key,t,n,a):Hu(i,"updateDoc",e._key,t),Mh(r,[s.toMutation(e._key,Qs.exists(!0))])}function Nh(e){return Mh(On(e.firestore,Cu),[new oo(e._key,Qs.none())])}function Ah(e,t){const n=On(e.firestore,Cu),r=_u(e),i=vh(e.converter,t);return Mh(n,[qu(Bu(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Qs.exists(!1))]).then(()=>r)}function Dh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=ye(e);let i={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof n[s]||Iu(n[s])||(i=n[s++]);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Iu(n[s])){var a,l,c;const e=n[s];n[s]=null===(a=e.next)||void 0===a?void 0:a.bind(e),n[s+1]=null===(l=e.error)||void 0===l?void 0:l.bind(e),n[s+2]=null===(c=e.complete)||void 0===c?void 0:c.bind(e)}let u,h,d;if(e instanceof wu)h=On(e.firestore,Cu),d=ns(e._key.path),u={next:t=>{n[s]&&n[s](Oh(h,e,t))},error:n[s+1],complete:n[s+2]};else{const t=On(e,bu);h=On(t.firestore,Cu),d=t._query;const r=new kh(h);u={next:e=>{n[s]&&n[s](new _h(h,r,t,e))},error:n[s+1],complete:n[s+2]},oh(e._query)}return function(e,t,n,r){const i=new Zc(r),s=new bc(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>dc(await uu(e),s)),()=>{i.Nu(),e.asyncQueue.enqueueAndForget(async()=>fc(await uu(e),s))}}(Nu(h),d,o,u)}function Mh(e,t){return function(e,t){const n=new sn;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Xc(e);try{const e=await function(e,t){const n=tn(e),r=Fn.now(),i=t.reduce((e,t)=>e.add(t.key),Cs());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=bs(),l=Cs();return n.Ns.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Zs(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new no(e.key,t,Ti(t.value.mapValue),Qs.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Ss(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Or(gn)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Hc(r,e.changes),await Hl(r.remoteStore)}catch(e){const t=sc(e,"Failed to persist write");n.reject(t)}}(await lu(e),t,n)),n.promise}(Nu(e),t)}function Oh(e,t,n){const r=n.docs.get(t._key),i=new kh(e);return new xh(e,i,t._key,r,new wh(n.hasPendingWrites,n.fromCache),t.converter)}const Ph={maxAttempts:5};class Lh{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Bu(e)}set(e,t,n){this._verifyNotCommitted();const r=Rh(e,this._firestore),i=vh(r.converter,t,n),s=qu(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Qs.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Rh(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=ye(t))||t instanceof Mu?Ku(this._dataReader,"WriteBatch.update",r._key,t,n,o):Hu(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Qs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Rh(e,this._firestore);return this._mutations=this._mutations.concat(new oo(t._key,Qs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new rn(nn.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Rh(e,t){if((e=ye(e)).firestore!==t)throw new rn(nn.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class jh{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Bu(e)}get(e){const t=Rh(e,this._firestore),n=new bh(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return $t(24041);const r=e[0];if(r.isFoundDocument())return new rh(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new rh(this._firestore,n,t._key,null,t.converter);throw $t(18433,{doc:r})})}set(e,t,n){const r=Rh(e,this._firestore),i=vh(r.converter,t,n),s=qu(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=Rh(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=ye(t))||t instanceof Mu?Ku(this._dataReader,"Transaction.update",r._key,t,n,o):Hu(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=Rh(e,this._firestore);return this._transaction.delete(t._key),this}}class Fh extends jh{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Rh(e,this._firestore),n=new kh(this._firestore);return super.get(e).then(e=>new xh(this._firestore,n,t._key,e._document,new wh(!1,!1),t.converter))}}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Ht=e}("12.6.0"),dt(new ve("firestore",(e,n)=>{let{instanceIdentifier:i,options:s}=n;const o=e.getProvider("app").getImmediate(),a=new Cu(new cn(e.getProvider("auth-internal")),new fn(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new rn(nn.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ei(e.options.projectId,t)}(o,i),o);return s=(0,r.A)({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),yt(Bt,qt,e),yt(Bt,qt,"esm2020")}();var Vh=n(579);const zh="1217v7-AI-Assistant",Uh={apiKey:"AIzaSyCwQjAtEjJGhVv2KuB0HwazdqQ4lhP2I_w",authDomain:"nmsl-accounting.firebaseapp.com",projectId:"nmsl-accounting",storageBucket:"nmsl-accounting.firebasestorage.app",messagingSenderId:"623278577938",appId:"1:623278577938:web:a7fa005c80168303437bcb",measurementId:"G-0B3WN5F2CP"};let Bh;try{const e=gt(Uh);Bh=function(e,t){const n="object"==typeof e?e:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot;const t=lt.get(e);if(!t&&e===ot&&ne())return gt();if(!t)throw pt.create("no-app",{appName:e});return t}(),r="string"==typeof e?e:t||Zr,i=ft(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=te("firestore");e&&vu(i,...e)}return i}(e)}catch(bd){console.error("Firebase \u521d\u59cb\u5316\u5931\u6557\uff0c\u8acb\u6aa2\u67e5\u8a2d\u5b9a\u6a94",bd)}const qh=["\u6c34\u91ce","vina","Avalon","Ricky","\u4e94\u5341\u5d50","\u6c34\u6708","\u5f4c\u7802","Wolf","UBS"],Gh={"\u6c34\u91ce":"1571",vina:"7720",Avalon:"1018",Ricky:"0721","\u4e94\u5341\u5d50":"1225","\u6c34\u6708":"5230","\u5f4c\u7802":"3210",Wolf:"0821",UBS:"0663"},Hh={WORLD:{label:"\u4e16\u754c",tax:.2},GENERAL:{label:"\u4e00\u822c",tax:.1}},Kh=(()=>{try{return"/team-accounting/map.jpg"}catch(e){return"/map.jpg"}})(),Qh=async(e,t)=>{if(e)try{await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t})})}catch(bd){console.error("Discord \u901a\u77e5\u767c\u9001\u5931\u6557",bd)}},Wh=e=>Qh("https://discord.com/api/webhooks/1450050856094535745/0dvodClTjDzQEc_t5z_cCXNjPTF2wCyilpcWtJJNyX0xGhp4lYcRYOgzOam1IWT9Zqgo",e),Xh=(e,t,n)=>{const r=(new Date).toLocaleString("zh-TW",{hour12:!1}),i="`[".concat(r,"]` **").concat(e||"\u672a\u5177\u540d","** ").concat(t,"\uff1a").concat(n);Qh("https://discord.com/api/webhooks/1450325286062260296/_cNDE7s-GKL0QHVGKye5qIRA-xsQH-iOXUyFLWaDsGc0LwXTU94HC4yFdRW-eJm6KmTF",i)},Yh=e=>{if(!e)return"\u7121\u7d00\u9304";try{return new Date(e).toLocaleString("zh-TW",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}catch(t){return"\u65e5\u671f\u932f\u8aa4"}},Jh=e=>{if(!e)return"--:--";try{return new Date(e).toLocaleString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch(t){return"--:--"}},$h=e=>{try{return e.toLocaleString("zh-TW",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch(t){return"--:--:--"}},Zh=e=>{try{const t=new Date(e),n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.round(i/864e5);return-1===s?"yesterday":0===s?"today":1===s?"tomorrow":"other"}catch(t){return"other"}},ed=()=>{const e=Math.floor(360*Math.random()),t=70+30*Math.random(),n=(45+15*Math.random())/100,r=t*Math.min(n,1-n)/100,i=t=>{const i=(t+e/30)%12,s=n-r*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*s).toString(16).padStart(2,"0")};return"#".concat(i(0)).concat(i(8)).concat(i(4))},td=()=>{const e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)},nd=()=>{const e=new Date,t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");return"".concat(t,":").concat(n)},rd=e=>{if(!e)return"";const t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&11===t[2].length?t[2]:e},id=e=>{let{message:t,isVisible:n}=e;return(0,Vh.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-[70] transition-all duration-300 pointer-events-none\n      ".concat(n?"translate-y-0 opacity-100":"-translate-y-10 opacity-0"),children:(0,Vh.jsxs)("div",{className:"bg-green-600 text-white px-6 py-2 rounded-full shadow-lg font-bold flex items-center gap-2",children:[(0,Vh.jsx)(d,{size:18}),t]})})},sd=e=>{let{show:t,remoteVersion:n,onRefresh:r}=e;return t?(0,Vh.jsx)("div",{className:"fixed bottom-6 right-6 z-[100] animate-[bounceIn_0.5s_ease-out]",children:(0,Vh.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-5 rounded-2xl shadow-2xl border-2 border-white/20 max-w-sm",children:(0,Vh.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Vh.jsx)("div",{className:"bg-white/20 p-2 rounded-full animate-pulse",children:(0,Vh.jsx)(f,{size:24,className:"text-white"})}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("h3",{className:"font-bold text-lg mb-1",children:"\ud83d\ude80 \u767c\u73fe\u65b0\u7248\u672c\uff01"}),(0,Vh.jsxs)("p",{className:"text-sm opacity-90 mb-3 leading-relaxed",children:["\u70ba\u4e86\u78ba\u4fdd\u529f\u80fd\u6b63\u5e38\u8207\u8cc7\u6599\u540c\u6b65\uff0c\u8acb\u7acb\u5373\u66f4\u65b0\u7db2\u9801\u3002",(0,Vh.jsx)("br",{}),(0,Vh.jsxs)("span",{className:"text-xs opacity-70 font-mono mt-1 block",children:["Local: ",zh," ",(0,Vh.jsx)("br",{})," New: ",n]})]}),(0,Vh.jsx)("button",{onClick:r,className:"w-full bg-white text-blue-700 font-bold py-2 rounded-lg hover:bg-blue-50 transition-colors shadow-md active:scale-95",children:"\u7acb\u5373\u91cd\u65b0\u6574\u7406"})]})]})})}):null},od=t=>{let{videoId:n,isDarkMode:r}=t;const[i,s]=(0,e.useState)(null),[o,a]=(0,e.useState)(!1),[l,c]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[d,f]=(0,e.useState)(50),[x,S]=(0,e.useState)(!0),[_,E]=(0,e.useState)(!1),T=(0,e.useRef)(_);(0,e.useEffect)(()=>{const e=localStorage.getItem("accounting_player_settings");if(e)try{const t=JSON.parse(e);void 0!==t.volume&&f(t.volume),void 0!==t.isMuted&&S(t.isMuted),void 0!==t.isLoop&&(E(t.isLoop),T.current=t.isLoop)}catch(t){console.error("\u8b80\u53d6\u64ad\u653e\u5668\u8a2d\u5b9a\u5931\u6557",t)}},[]),(0,e.useEffect)(()=>{const e={volume:d,isMuted:x,isLoop:_};localStorage.setItem("accounting_player_settings",JSON.stringify(e)),T.current=_},[d,x,_]),(0,e.useEffect)(()=>{if(!window.YT){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}},[]),(0,e.useEffect)(()=>{if(n&&window.YT&&window.YT.Player){if(i)return void i.loadVideoById(n);const e=new window.YT.Player("youtube-player",{height:"0",width:"0",videoId:n,playerVars:{autoplay:0,controls:0,rel:0,playsinline:1},events:{onReady:e=>{h(!0),x?e.target.mute():e.target.unMute(),e.target.setVolume(d)},onStateChange:e=>{a(e.data===window.YT.PlayerState.PLAYING),0===e.data&&T.current&&e.target.playVideo()}}});s(e)}else if(n){const e=setInterval(()=>{window.YT&&window.YT.Player&&(clearInterval(e),s(null))},500);return()=>clearInterval(e)}},[n]);return n?(0,Vh.jsxs)("div",{className:"fixed bottom-4 left-4 z-40 transition-all duration-300 shadow-xl rounded-lg border overflow-hidden\n      ".concat(r?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800","\n      ").concat(l?"w-10 h-10 rounded-full":"w-64 p-3","\n    "),children:[(0,Vh.jsx)("div",{id:"youtube-player",className:"hidden"}),l?(0,Vh.jsx)("button",{onClick:()=>c(!1),className:"w-full h-full flex items-center justify-center hover:bg-gray-200/20 rounded-full",children:(0,Vh.jsx)(p,{size:20,className:o?"animate-pulse text-green-500":"text-gray-400"})}):(0,Vh.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Vh.jsxs)("div",{className:"flex justify-between items-center border-b pb-1 border-gray-500/20",children:[(0,Vh.jsxs)("span",{className:"text-xs font-bold flex items-center gap-1",children:[(0,Vh.jsx)(p,{size:14})," \u97f3\u6a02\u64ad\u653e\u5668"]}),(0,Vh.jsx)("button",{onClick:()=>c(!0),children:(0,Vh.jsx)(m,{size:16})})]}),(0,Vh.jsxs)("div",{className:"flex items-center gap-2 justify-center py-1",children:[(0,Vh.jsx)("button",{onClick:()=>{i&&u&&(o?i.pauseVideo():i.playVideo())},className:"p-2 rounded-full transition-colors ".concat(o?"bg-red-500 text-white":"bg-green-500 text-white"),title:o?"\u66ab\u505c":"\u64ad\u653e",children:o?(0,Vh.jsx)(g,{size:16}):(0,Vh.jsx)(y,{size:16})}),(0,Vh.jsx)("button",{onClick:()=>{i&&u&&(x?i.unMute():i.mute(),S(!x))},className:"p-2 rounded-full transition-colors ".concat(x?"bg-gray-600 text-white":"bg-gray-200 text-gray-700"),title:"\u975c\u97f3/\u53d6\u6d88\u975c\u97f3",children:x?(0,Vh.jsx)(v,{size:16}):(0,Vh.jsx)(b,{size:16})}),(0,Vh.jsx)("button",{onClick:()=>{E(!_)},className:"p-2 rounded-full transition-colors ".concat(_?"bg-blue-500 text-white":"bg-gray-200 text-gray-400"),title:"\u5faa\u74b0\u64ad\u653e",children:(0,Vh.jsx)(w,{size:16})})]}),(0,Vh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vh.jsx)(b,{size:12,className:"opacity-50"}),(0,Vh.jsx)("input",{type:"range",min:"0",max:"100",value:d,onChange:e=>{const t=parseInt(e.target.value);f(t),i&&u&&(i.setVolume(t),t>0&&x&&(i.unMute(),S(!1)))},className:"w-full h-1 bg-gray-300 rounded-lg appearance-none cursor-pointer"})]}),(0,Vh.jsxs)("div",{className:"text-[10px] opacity-60 text-center truncate",children:["ID: ",n]})]})]}):null},ad=t=>{let{isOpen:n,onClose:i,theme:s,currentSettings:o,isDarkMode:a,currentUser:l}=t;const[c,u]=(0,e.useState)({appVersion:zh,mapShowMins:60,mapBlinkMins:10,mapLineGapSecs:120,youtubeVideoId:"",geminiApiKey:""});if((0,e.useEffect)(()=>{o&&u(o)},[o]),!n)return null;return(0,Vh.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:(0,Vh.jsxs)("div",{className:"w-full max-w-lg p-6 rounded-xl shadow-2xl ".concat(s.card," max-h-[90vh] overflow-y-auto"),children:[(0,Vh.jsxs)("div",{className:"flex justify-between items-center mb-6 border-b pb-2 border-gray-600",children:[(0,Vh.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2 ".concat(s.text),children:[(0,Vh.jsx)(x,{size:24})," \u7cfb\u7d71\u5168\u57df\u8a2d\u5b9a"]}),(0,Vh.jsx)("button",{onClick:i,className:"p-1 rounded hover:bg-red-500 hover:text-white transition-colors",children:(0,Vh.jsx)(S,{size:24})})]}),(0,Vh.jsxs)("div",{className:"space-y-6",children:[(0,Vh.jsxs)("div",{className:"p-4 bg-blue-900/20 rounded-lg border border-blue-500/30",children:[(0,Vh.jsxs)("h4",{className:"font-bold text-blue-500 mb-2 flex items-center gap-2",children:[(0,Vh.jsx)(f,{size:16})," \u7248\u672c\u865f\u63a7\u7ba1","Wolf"!==l&&(0,Vh.jsxs)("span",{className:"text-xs text-red-400 bg-red-900/20 px-2 py-0.5 rounded ml-2 flex items-center gap-1",children:[(0,Vh.jsx)(_,{size:10})," \u6b0a\u9650\u4e0d\u8db3"]})]}),(0,Vh.jsx)("p",{className:"text-xs mb-3 opacity-70 ".concat(s.text),children:"* \u4fee\u6539\u6b64\u865f\u78bc\u8207\u4f7f\u7528\u8005\u7576\u524d\u7248\u672c\u4e0d\u540c\u6642\uff0c\u6703\u8df3\u51fa\u66f4\u65b0\u63d0\u793a\u3002"}),(0,Vh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vh.jsx)("label",{className:"text-sm w-24 font-bold ".concat(s.text),children:"\u96f2\u7aef\u7248\u672c"}),(0,Vh.jsx)("input",{type:"text",className:"flex-1 p-2 rounded border ".concat(s.input," ").concat("Wolf"!==l?"opacity-50 cursor-not-allowed":""),value:c.appVersion||"",onChange:e=>u((0,r.A)((0,r.A)({},c),{},{appVersion:e.target.value})),disabled:"Wolf"!==l,title:"Wolf"!==l?"\u53ea\u6709 Wolf \u53ef\u4ee5\u4fee\u6539\u6b64\u6b04\u4f4d":""})]}),(0,Vh.jsxs)("div",{className:"text-xs text-right mt-1 opacity-50",children:["\u60a8\u7684\u672c\u6a5f\u7248\u672c: ",zh]})]}),(0,Vh.jsxs)("div",{className:"p-4 bg-yellow-900/20 rounded-lg border border-yellow-500/30",children:[(0,Vh.jsxs)("h4",{className:"font-bold text-yellow-500 mb-2 flex items-center gap-2",children:[(0,Vh.jsx)(E,{size:16})," AI \u8a2d\u5b9a (Gemini)"]}),(0,Vh.jsx)("p",{className:"text-xs mb-3 opacity-70 ".concat(s.text),children:"* \u586b\u5165 Google Gemini API Key \u4ee5\u555f\u7528\u667a\u6167\u554f\u7b54\u529f\u80fd\u3002"}),(0,Vh.jsx)("div",{className:"flex flex-col gap-2",children:(0,Vh.jsx)("input",{type:"password",placeholder:"API Key (\u4f8b\u5982: AIzaSy...)",className:"w-full p-2 rounded border ".concat(s.input),value:c.geminiApiKey||"",onChange:e=>u((0,r.A)((0,r.A)({},c),{},{geminiApiKey:e.target.value}))})})]}),(0,Vh.jsxs)("div",{className:"p-4 bg-purple-900/20 rounded-lg border border-purple-500/30",children:[(0,Vh.jsxs)("h4",{className:"font-bold text-purple-500 mb-4 flex items-center gap-2",children:[(0,Vh.jsx)(T,{size:16})," Boss \u5730\u5716\u53c3\u6578"]}),(0,Vh.jsxs)("div",{className:"space-y-4",children:[(0,Vh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vh.jsx)("label",{className:"text-sm w-32 ".concat(s.text),children:"\u986f\u793a\u7bc4\u570d (\u5206)"}),(0,Vh.jsx)("input",{type:"number",className:"w-24 p-2 rounded border ".concat(s.input),value:c.mapShowMins||60,onChange:e=>u((0,r.A)((0,r.A)({},c),{},{mapShowMins:Number(e.target.value)}))}),(0,Vh.jsx)("span",{className:"text-xs opacity-50",children:"\u91cd\u751f\u524d N \u5206\u9418\u986f\u793a"})]}),(0,Vh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vh.jsx)("label",{className:"text-sm w-32 ".concat(s.text),children:"\u9583\u720d\u63d0\u793a (\u5206)"}),(0,Vh.jsx)("input",{type:"number",className:"w-24 p-2 rounded border ".concat(s.input),value:c.mapBlinkMins||10,onChange:e=>u((0,r.A)((0,r.A)({},c),{},{mapBlinkMins:Number(e.target.value)}))}),(0,Vh.jsx)("span",{className:"text-xs opacity-50",children:"\u91cd\u751f\u524d N \u5206\u9418\u958b\u59cb\u9583\u720d"})]}),(0,Vh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vh.jsx)("label",{className:"text-sm w-32 ".concat(s.text),children:"\u9023\u7dda\u7fa4\u7d44 (\u79d2)"}),(0,Vh.jsx)("input",{type:"number",className:"w-24 p-2 rounded border ".concat(s.input),value:c.mapLineGapSecs||120,onChange:e=>u((0,r.A)((0,r.A)({},c),{},{mapLineGapSecs:Number(e.target.value)}))}),(0,Vh.jsx)("span",{className:"text-xs opacity-50",children:"\u9593\u9694 N \u79d2\u5167\u8996\u70ba\u540c\u4e00\u7d44"})]})]})]}),(0,Vh.jsxs)("div",{className:"p-4 bg-green-900/20 rounded-lg border border-green-500/30",children:[(0,Vh.jsxs)("h4",{className:"font-bold text-green-500 mb-4 flex items-center gap-2",children:[(0,Vh.jsx)(p,{size:16})," \u80cc\u666f\u97f3\u6a02\u8a2d\u5b9a"]}),(0,Vh.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Vh.jsx)("label",{className:"text-sm ".concat(s.text),children:"YouTube \u7db2\u5740\u6216 ID"}),(0,Vh.jsx)("input",{type:"text",placeholder:"\u4f8b\u5982: dQw4w9WgXcQ",className:"w-full p-2 rounded border ".concat(s.input),value:c.youtubeVideoId||"",onChange:e=>u((0,r.A)((0,r.A)({},c),{},{youtubeVideoId:e.target.value}))}),(0,Vh.jsx)("span",{className:"text-xs opacity-50",children:"* \u66f4\u65b0\u5f8c\uff0c\u6240\u6709\u5728\u7dda\u6210\u54e1\u7684\u64ad\u653e\u5668\u6703\u540c\u6b65\u8f09\u5165\u6b64\u5f71\u7247\u3002"})]})]})]}),(0,Vh.jsxs)("div",{className:"mt-8 flex justify-end gap-3",children:[(0,Vh.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"\u53d6\u6d88"}),(0,Vh.jsxs)("button",{onClick:async()=>{if(Bh)try{const e=(0,r.A)((0,r.A)({},c),{},{youtubeVideoId:rd(c.youtubeVideoId)});await Ih(_u(Bh,"system_data","global_settings"),e,{merge:!0}),Xh(l,"\u4fee\u6539\u7cfb\u7d71\u8a2d\u5b9a","\u7248\u672c:".concat(e.appVersion,", \u97f3\u6a02:").concat(e.youtubeVideoId)),alert("\u8a2d\u5b9a\u5df2\u5132\u5b58\uff01"),i()}catch(e){console.error(e),alert("\u5132\u5b58\u5931\u6557")}},className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-bold flex items-center gap-2",children:[(0,Vh.jsx)(k,{size:18})," \u5132\u5b58\u8a2d\u5b9a"]})]})]})})},ld=t=>{let{isOpen:n,onSelectUser:r,theme:i}=t;const[s,o]=(0,e.useState)("SELECT"),[a,l]=(0,e.useState)(null),[c,u]=(0,e.useState)(""),[h,d]=(0,e.useState)("");if(!n)return null;const f=()=>{c===Gh[a]?(r(a),Xh(a,"\u7d81\u5b9a\u8a2d\u5099","\u767b\u5165\u6210\u529f (\u65b0\u8a2d\u5099\u7d81\u5b9a)")):(d("\u5bc6\u78bc\u932f\u8aa4"),Xh(a,"\u767b\u5165\u5931\u6557","\u5bc6\u78bc\u932f\u8aa4\u5617\u8a66"))};return(0,Vh.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-md p-4",children:(0,Vh.jsxs)("div",{className:"w-full max-w-md p-6 rounded-2xl shadow-2xl ".concat(i.card," text-center"),children:["SELECT"===s?(0,Vh.jsxs)(Vh.Fragment,{children:[(0,Vh.jsx)(I,{size:64,className:"mx-auto mb-4 text-blue-500"}),(0,Vh.jsx)("h2",{className:"text-2xl font-bold mb-2 ".concat(i.text),children:"\u6b61\u8fce\uff01\u8acb\u554f\u60a8\u662f\u54ea\u4f4d\u6210\u54e1\uff1f"}),(0,Vh.jsx)("p",{className:"text-sm mb-6 ".concat(i.subText),children:"\u8acb\u9078\u64c7\u60a8\u7684\u8eab\u4efd\u4ee5\u7d81\u5b9a\u6b64\u8a2d\u5099\u3002"}),(0,Vh.jsx)("div",{className:"grid grid-cols-3 gap-3",children:qh.map(e=>(0,Vh.jsx)("button",{onClick:()=>(e=>{Gh[e]?(l(e),o("PASSWORD"),d(""),u("")):alert("\u5c1a\u672a\u63d0\u4f9b\u5bc6\u78bc\uff0c\u8acb\u79c1\u8a0a Wolf \u7372\u53d6\u4e00\u7d44\u56db\u4f4d\u6578\u5bc6\u78bc\u3002")})(e),className:"p-3 rounded-xl bg-blue-600 hover:bg-blue-500 text-white font-bold transition-transform hover:scale-105 active:scale-95",children:e},e))})]}):(0,Vh.jsxs)(Vh.Fragment,{children:[(0,Vh.jsx)(_,{size:64,className:"mx-auto mb-4 text-yellow-500"}),(0,Vh.jsx)("h2",{className:"text-2xl font-bold mb-2 ".concat(i.text),children:"\u8acb\u8f38\u5165\u5bc6\u78bc"}),(0,Vh.jsxs)("p",{className:"text-sm mb-4 ".concat(i.subText),children:["\u6b63\u5728\u9a57\u8b49\u8eab\u4efd\uff1a",(0,Vh.jsx)("span",{className:"font-bold text-blue-500",children:a})]}),(0,Vh.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Vh.jsx)("input",{type:"password",maxLength:"4",placeholder:"4\u4f4d\u6578\u5bc6\u78bc",className:"w-full p-3 rounded-lg text-center text-xl tracking-widest border-2 outline-none ".concat(h?"border-red-500":"border-gray-300"),value:c,onChange:e=>u(e.target.value),onKeyDown:e=>"Enter"===e.key&&f()}),h&&(0,Vh.jsx)("p",{className:"text-red-500 text-sm font-bold animate-pulse",children:h}),(0,Vh.jsxs)("div",{className:"flex gap-2",children:[(0,Vh.jsx)("button",{onClick:()=>{o("SELECT"),l(null),u(""),d("")},className:"flex-1 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"\u8fd4\u56de"}),(0,Vh.jsx)("button",{onClick:f,className:"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold",children:"\u78ba\u8a8d"})]})]})]}),(0,Vh.jsx)("div",{className:"mt-6 text-xs ".concat(i.subText),children:"* \u7d81\u5b9a\u5f8c\uff0c\u4e0b\u6b21\u958b\u555f\u7db2\u9801\u7121\u9700\u518d\u6b21\u767b\u5165\u3002"})]})})},cd=t=>{let{isOpen:n,onClose:i,theme:s,isDarkMode:o,currentUser:a}=t;const[l,c]=(0,e.useState)({}),[u,h]=(0,e.useState)(!0);(0,e.useEffect)(()=>{if(!n||!Bh)return;const e=Dh(_u(Bh,"settlement_data","main_grid"),e=>{e.exists()?c(e.data().matrix||{}):c({}),h(!1)});return()=>e()},[n]);if(!n)return null;const d={headerCell:o?"bg-gray-700 text-gray-200 border-gray-600":"bg-gray-100 text-gray-700 border-gray-300",headerCellSticky:o?"bg-gray-800 text-gray-200 border-gray-600":"bg-gray-50 text-gray-700 border-gray-300",totalHeader:o?"bg-blue-900/50 text-blue-200 border-gray-600":"bg-blue-50 text-blue-800 border-gray-300",rowHeader:o?"bg-gray-800 text-gray-200 border-gray-600":"bg-gray-50 text-gray-800 border-gray-300",cell:o?"border-gray-600":"border-gray-300",input:o?"text-gray-100":"text-gray-800",selfCell:o?"bg-black/50":"bg-black/80",rowTotal:o?"bg-blue-900/30 text-blue-400 border-gray-600":"bg-blue-50/30 text-blue-600 border-gray-300",incomeHeader:o?"bg-green-900/50 text-green-200 border-gray-600":"bg-green-100 text-green-800 border-gray-300",incomeLabel:o?"bg-green-900/30 text-green-200 border-gray-600":"bg-green-50/50 text-green-800 border-gray-300",incomeCell:o?"text-green-400 border-gray-600":"text-green-600 border-gray-300",emptyCorner:o?"bg-gray-700 border-gray-600":"bg-gray-200 border-gray-300"};return(0,Vh.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 overflow-auto",children:(0,Vh.jsxs)("div",{className:"w-full max-w-6xl rounded-xl p-6 h-[90vh] flex flex-col ".concat(s.card),children:[(0,Vh.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b pb-2 ".concat(o?"border-gray-700":"border-gray-200"),children:[(0,Vh.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vh.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2 ".concat(s.text),children:[(0,Vh.jsx)(C,{size:24})," \u6210\u54e1\u9918\u984d\u8868 (Excel \u6a21\u5f0f)"]}),(0,Vh.jsxs)("button",{onClick:async()=>{if(!Bh)return;if(!window.confirm("\u78ba\u5b9a\u8981\u57f7\u884c\u300c\u81ea\u52d5\u5283\u5e33\u300d\u55ce\uff1f\n\u9019\u5c07\u6703\u91cd\u65b0\u8a08\u7b97\u4e26\u8986\u84cb\u76ee\u524d\u7684\u8868\u683c\uff0c\u5c07\u6240\u6709\u8907\u96dc\u7684\u50b5\u52d9\u7c21\u5316\u70ba\u6700\u5c11\u7b46\u6578\u3002"))return;const e={};qh.forEach(t=>e[t]=0),qh.forEach(t=>{qh.forEach(n=>{if(t===n)return;const r=parseFloat(l["".concat(t,"_").concat(n)])||0;e[t]-=r,e[n]+=r})});let t=[],n=[];qh.forEach(r=>{const i=e[r];i<-1?t.push({name:r,balance:Math.abs(i)}):i>1&&n.push({name:r,balance:i})}),t.sort((e,t)=>t.balance-e.balance),n.sort((e,t)=>t.balance-e.balance);const r={};let i=0,s=0;for(;i<t.length&&s<n.length;){let e=t[i],o=n[s],a=Math.min(e.balance,o.balance);const l="".concat(e.name,"_").concat(o.name);r[l]=(r[l]||0)+a,e.balance-=a,o.balance-=a,e.balance<1&&i++,o.balance<1&&s++}try{await Ih(_u(Bh,"settlement_data","main_grid"),{matrix:r},{merge:!1}),Wh("\u2696\ufe0f [\u7cfb\u7d71\u516c\u544a] **".concat(a,"** \u57f7\u884c\u4e86\u300c\u81ea\u52d5\u5283\u5e33\u300d\uff0c\u5168\u57df\u50b5\u52d9\u5df2\u5b8c\u6210\u7c21\u5316\u3002")),Xh(a,"\u57f7\u884c\u81ea\u52d5\u5283\u5e33","\u91cd\u7f6e\u4e26\u7c21\u5316\u6240\u6709\u50b5\u52d9"),alert("\u5283\u5e33\u5b8c\u6210\uff01\u50b5\u52d9\u5df2\u7c21\u5316\u3002")}catch(o){console.error("Auto balance failed",o),alert("\u5283\u5e33\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")}},className:"flex items-center gap-2 px-3 py-1 text-sm bg-purple-600 text-white rounded hover:bg-purple-700 shadow transition-colors",title:"\u91cd\u65b0\u8a08\u7b97\u4e26\u7c21\u5316\u6240\u6709\u50b5\u52d9",children:[(0,Vh.jsx)(N,{size:16})," \u81ea\u52d5\u5283\u5e33"]})]}),(0,Vh.jsx)("button",{onClick:i,className:"p-1 rounded ".concat(o?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-200 text-gray-500"),children:(0,Vh.jsx)(S,{size:24})})]}),(0,Vh.jsx)("div",{className:"flex-1 overflow-auto",children:u?(0,Vh.jsx)("div",{className:"p-10 text-center ".concat(s.subText),children:"\u8f09\u5165\u4e2d..."}):(0,Vh.jsxs)("table",{className:"w-full border-collapse min-w-[1000px]",children:[(0,Vh.jsx)("thead",{children:(0,Vh.jsxs)("tr",{children:[(0,Vh.jsx)("th",{className:"p-2 border min-w-[100px] sticky top-0 left-0 z-20 font-bold ".concat(d.headerCell),children:"\u4ed8\u6b3e\\\u6536\u6b3e"}),qh.map(e=>(0,Vh.jsx)("th",{className:"p-2 border min-w-[100px] sticky top-0 z-10 font-bold ".concat(d.headerCellSticky),children:e},e)),(0,Vh.jsx)("th",{className:"p-2 border min-w-[100px] sticky top-0 z-10 font-bold ".concat(d.totalHeader),children:"\u7e3d\u8a08\u652f\u51fa"})]})}),(0,Vh.jsxs)("tbody",{children:[qh.map(e=>{let t=0;return(0,Vh.jsxs)("tr",{className:s.card,children:[(0,Vh.jsx)("th",{className:"p-2 border sticky left-0 z-10 font-bold ".concat(d.rowHeader),children:e}),qh.map(n=>{const i=e===n,s="".concat(e,"_").concat(n),o=l[s]||0;i||(t+=o);const u=e===a||n===a;return(0,Vh.jsx)("td",{className:"p-1 border text-center ".concat(d.cell," ").concat(i?d.selfCell:""),children:!i&&(0,Vh.jsx)("input",{type:"number",className:"w-full h-full p-1 text-center bg-transparent outline-none font-mono ".concat(d.input," ").concat(o>0?"text-red-500 font-bold":"opacity-60"," ").concat(u?"":"cursor-not-allowed opacity-30"),value:0===o?"":o,placeholder:"0",readOnly:!u,onClick:()=>{u||(Xh(a,"\u6b0a\u9650\u4e0d\u8db3","\u5617\u8a66\u4fee\u6539\u9918\u984d\u8868\uff1a".concat(e," -> ").concat(n)),alert("\u6b0a\u9650\u4e0d\u8db3\uff1a\u60a8\u53ea\u80fd\u4fee\u6539\u8207\u81ea\u5df1\u6709\u95dc\u7684\u5e33\u52d9\uff08\u60a8\u662f\u4ed8\u6b3e\u4eba\u6216\u6536\u6b3e\u4eba\uff09"))},onChange:e=>{if(!u)return;const t=e.target.value;c(e=>(0,r.A)((0,r.A)({},e),{},{[s]:t}))},onBlur:t=>(async(e,t,n)=>{const i="".concat(e,"_").concat(t),s=parseFloat(n)||0;if(e===a||t===a){if(l[i]!==s){const n="\ud83d\udcdd [\u5e33\u52d9\u4fee\u6539] ".concat(e," \u5c0d ").concat(t," \u7684\u6b20\u6b3e\u5df2\u624b\u52d5\u4fee\u6539\u70ba $").concat(s.toLocaleString());Wh(n),Xh(a,"\u4fee\u6539\u9918\u984d\u8868","".concat(e," -> ").concat(t," \u6539\u70ba ").concat(s))}c(e=>(0,r.A)((0,r.A)({},e),{},{[i]:s})),Bh&&await Ih(_u(Bh,"settlement_data","main_grid"),{matrix:(0,r.A)((0,r.A)({},l),{},{[i]:s})},{merge:!0})}})(e,n,t.target.value)})},n)}),(0,Vh.jsx)("td",{className:"p-2 border text-center font-bold ".concat(d.rowTotal),children:t.toLocaleString()})]},e)}),(0,Vh.jsxs)("tr",{className:d.incomeLabel,children:[(0,Vh.jsx)("td",{className:"p-2 border text-right sticky left-0 z-10 ".concat(d.incomeHeader),children:"\u9810\u5b9a\u6536\u5165"}),qh.map(e=>{let t=0;return qh.forEach(n=>{n!==e&&(t+=parseFloat(l["".concat(n,"_").concat(e)]||0))}),(0,Vh.jsx)("td",{className:"p-2 border text-center ".concat(d.incomeCell),children:t.toLocaleString()},e)}),(0,Vh.jsx)("td",{className:"p-2 border ".concat(d.emptyCorner)})]})]})]})}),(0,Vh.jsxs)("div",{className:"mt-2 text-xs ".concat(s.subText),children:["* \u8aaa\u660e\uff1a\u8868\u683c\u6578\u5b57\u4ee3\u8868\u300c\u4ed8\u6b3e\u4eba\u300d\u6b20\u300c\u6536\u6b3e\u4eba\u300d\u7684\u91d1\u984d\u3002 ",(0,Vh.jsx)("br",{}),"* \ud83d\udd12 \u60a8\u53ea\u80fd\u4fee\u6539\u8207\u81ea\u5df1\u6709\u95dc\u7684\u6b04\u4f4d\uff08\u60a8\u662f\u4ed8\u6b3e\u4eba\u6216\u6536\u6b3e\u4eba\uff09\u3002"]})]})})},ud=e=>{var t,n,r,i;let{item:s,isHistory:o,theme:a,updateItemValue:l,handleSettleAll:c,handleDelete:u,confirmSettleId:h,setConfirmSettleId:f,confirmDeleteId:p,setConfirmDeleteId:m,currentUser:g}=e;const y=s.listingHistory||[],{afterTaxPrice:v,perPersonSplit:b,totalListingFee:w}=function(e,t,n){var r;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const o=parseFloat(e)||0,a=parseFloat(i)||0,l=o*((null===(r=Hh[t])||void 0===r?void 0:r.tax)||0),c=s.reduce((e,t)=>e+Math.floor(.02*(parseFloat(t)||0)),0),u=Math.floor(o-l-a-c),h=n>0?n:1;let d=Math.floor(u/h);return{afterTaxPrice:u,perPersonSplit:1e4*Math.floor(d/1e4),taxAmount:l,cost:a,totalListingFee:c}}(s.price,s.exchangeType,(null===(t=s.participants)||void 0===t?void 0:t.length)||0,s.cost,y);return(0,Vh.jsxs)("div",{className:"rounded-xl shadow-md border-l-4 p-6 relative ".concat(a.card," ").concat(o?"border-gray-500 opacity-90":"border-blue-500"),children:[(0,Vh.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Vh.jsxs)("div",{className:"flex flex-col gap-1 w-full pr-10",children:[(0,Vh.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,Vh.jsx)("span",{className:"bg-blue-100 text-blue-800 font-bold px-2 py-1 rounded text-xs",children:s.seller}),(0,Vh.jsx)("h3",{className:"text-xl font-bold ".concat(a.text),children:s.itemName}),(0,Vh.jsx)("span",{className:"px-2 py-0.5 text-xs rounded-full border bg-green-100 text-green-700 border-green-200",children:(null===(n=Hh[s.exchangeType])||void 0===n?void 0:n.label)||"\u672a\u77e5"})]}),o&&(0,Vh.jsxs)("div",{className:"text-xs text-gray-400 flex gap-2",children:[(0,Vh.jsxs)("span",{children:["\u5efa: ",Yh(s.createdAt)]}),(0,Vh.jsxs)("span",{children:["\u7d50: ",Yh(s.settledAt)]})]})]}),(0,Vh.jsx)("div",{className:"absolute top-4 right-4 z-10",children:p===s.id?(0,Vh.jsxs)("div",{className:"flex gap-2 bg-red-50 p-1 rounded border border-red-200",children:[(0,Vh.jsx)("button",{onClick:()=>u(s.id),className:"text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition-colors",children:"\u522a\u9664"}),(0,Vh.jsx)("button",{onClick:()=>m(null),className:"text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300 transition-colors",children:"\u53d6\u6d88"})]}):(0,Vh.jsx)("button",{onClick:()=>{if(s.seller!==g)return alert("\u6b0a\u9650\u4e0d\u8db3\uff1a\u53ea\u6709\u8ca9\u8ce3\u4eba (".concat(s.seller,") \u53ef\u4ee5\u522a\u9664\u6b64\u9805\u76ee")),void Xh(g,"\u6b0a\u9650\u4e0d\u8db3","\u5617\u8a66\u522a\u9664\u975e\u672c\u4eba\u7269\u54c1\uff1a".concat(s.itemName," (\u8ce3\u5bb6: ").concat(s.seller,")"));m(s.id),f(null)},className:"text-gray-400 hover:text-red-500 p-1 rounded hover:bg-gray-100 transition-colors",children:(0,Vh.jsx)(A,{size:18})})})]}),(0,Vh.jsxs)("div",{className:"grid grid-cols-3 gap-4 p-4 rounded mb-4 ".concat(a.sectionBg),children:[(0,Vh.jsxs)("div",{className:"flex flex-col",children:[(0,Vh.jsx)("span",{className:"text-xs ".concat(a.subText),children:"\u552e\u50f9 (\u542b\u7a05)"}),(0,Vh.jsx)("div",{className:"text-lg font-bold ".concat(a.text),children:o?s.price:(0,Vh.jsx)("input",{type:"number",className:"bg-transparent w-full border-b border-gray-400 focus:border-blue-500 outline-none",value:s.price,onChange:e=>l(s.id,"price",e.target.value)})}),(0,Vh.jsxs)("div",{className:"text-[10px] text-gray-400 mt-1",children:["\u7a05: ",(s.price*((null===(r=Hh[s.exchangeType])||void 0===r?void 0:r.tax)||0)).toFixed(0)]})]}),(0,Vh.jsxs)("div",{className:"flex flex-col",children:[(0,Vh.jsxs)("span",{className:"text-xs ".concat(a.subText," flex items-center gap-1"),children:["\u520a\u767b\u8cbb (2%)",!o&&(0,Vh.jsx)("button",{onClick:()=>{const e=prompt("\u8acb\u8f38\u5165\u8a72\u6b21\u520a\u767b\u7684\u300c\u7269\u54c1\u50f9\u683c\u300d(\u7cfb\u7d71\u5c07\u81ea\u52d5\u8a08\u7b972%):",s.price);if(e){const t=parseFloat(e);if(!isNaN(t)){const e=[...y,t];l(s.id,"listingHistory",e)}}},className:"bg-blue-500 text-white rounded-full p-0.5 hover:bg-blue-600",title:"\u65b0\u589e\u4e00\u7b46\u520a\u767b\u7d00\u9304",children:(0,Vh.jsx)(D,{size:10})})]}),(0,Vh.jsxs)("div",{className:"flex flex-col gap-1 mt-1 max-h-20 overflow-y-auto",children:[y.map((e,t)=>(0,Vh.jsxs)("div",{className:"flex items-center justify-between text-xs bg-black/5 p-1 rounded",children:[(0,Vh.jsxs)("span",{children:["$",e," ",(0,Vh.jsxs)("span",{className:"text-gray-400",children:["\u2192 ",Math.floor(.02*e)]})]}),!o&&(0,Vh.jsx)("button",{onClick:()=>(e=>{const t=y.filter((t,n)=>n!==e);l(s.id,"listingHistory",t)})(t),className:"text-red-400 hover:text-red-600",children:(0,Vh.jsx)(S,{size:10})})]},t)),0===y.length&&(0,Vh.jsx)("span",{className:"text-gray-400 text-xs",children:"- \u7121\u7d00\u9304 -"})]}),(0,Vh.jsxs)("div",{className:"text-[10px] text-blue-500 mt-1 font-bold",children:["\u7e3d\u8a08: ",w]})]}),(0,Vh.jsxs)("div",{className:"flex flex-col",children:[(0,Vh.jsx)("span",{className:"text-xs ".concat(a.subText),children:"\u984d\u5916\u6210\u672c (\u624b\u52d5)"}),(0,Vh.jsx)("div",{className:"flex items-center gap-2",children:o?(0,Vh.jsxs)("span",{className:"text-red-400 font-mono",children:["-",s.cost||0]}):(0,Vh.jsx)("input",{type:"number",className:"w-full text-right rounded border ".concat(a.input," text-sm p-1"),value:s.cost||0,onChange:e=>l(s.id,"cost",e.target.value)})}),(0,Vh.jsxs)("div",{className:"text-xs text-green-500 mt-2 font-bold border-t pt-1 border-gray-300",children:["\u6de8\u5229/\u4eba: ",b.toLocaleString()]})]})]}),(0,Vh.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(i=s.participants)||void 0===i?void 0:i.map((e,t)=>(0,Vh.jsx)("div",{className:"px-2 py-1 rounded border text-xs flex items-center select-none ".concat(a.card," opacity-80"),children:e.name},t))}),!o&&(0,Vh.jsx)("div",{className:"mt-4 flex justify-end",children:h===s.id?(0,Vh.jsxs)("div",{className:"flex gap-2 items-center flex-wrap justify-end",children:[(0,Vh.jsxs)("span",{className:"text-sm text-red-500",children:["\u5c07 ",(0,Vh.jsxs)("b",{children:["$",b]}),"/\u4eba \u52a0\u5165\u9918\u984d\u8868?"]}),(0,Vh.jsx)("button",{onClick:()=>c(s,b),className:"bg-red-500 text-white px-3 py-1 rounded text-sm",children:"\u78ba\u8a8d"}),(0,Vh.jsx)("button",{onClick:()=>f(null),className:"bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm",children:"\u53d6\u6d88"})]}):(0,Vh.jsxs)("button",{onClick:()=>{if(s.seller!==g)return alert("\u6b0a\u9650\u4e0d\u8db3\uff1a\u53ea\u6709\u8ca9\u8ce3\u4eba (".concat(s.seller,") \u53ef\u4ee5\u57f7\u884c\u6b64\u64cd\u4f5c")),void Xh(g,"\u6b0a\u9650\u4e0d\u8db3","\u5617\u8a66\u51fa\u552e\u975e\u672c\u4eba\u7269\u54c1\uff1a".concat(s.itemName," (\u8ce3\u5bb6: ").concat(s.seller,")"));f(s.id),m(null)},className:"flex items-center gap-2 px-4 py-2 rounded font-bold text-sm bg-blue-600 text-white shadow hover:bg-blue-700",children:[(0,Vh.jsx)(d,{size:16})," \u5df2\u51fa\u552e"]})})]})},hd=e=>{let{event:t,theme:n,confirmDeleteId:r,setConfirmDeleteId:i,handleDeleteEvent:s,handleOpenEditEvent:o}=e;return(0,Vh.jsx)("div",{className:"p-3 mb-2 rounded border-l-4 shadow-sm flex justify-between items-center ".concat(n.card),style:{borderLeftColor:t.color},children:(0,Vh.jsxs)("div",{children:[(0,Vh.jsxs)("div",{className:"font-bold text-sm flex items-center gap-2",children:[t.name,t.mapPos&&(0,Vh.jsx)(M,{size:12,className:"text-blue-500"})]}),(0,Vh.jsxs)("div",{className:"text-xs opacity-70 flex items-center gap-1",children:[(0,Vh.jsx)(O,{size:10})," \u4ea1: ",Jh(t.deathTime)]}),(0,Vh.jsxs)("div",{className:"text-lg font-mono font-bold text-blue-500 flex items-center gap-1",children:[(0,Vh.jsx)(P,{size:14})," ",Jh(t.respawnTime)]})]})})},dd=e=>{let{displayEvents:t,now:n,globalSettings:r}=e;if(!t||0===t.length)return null;const i=(null===r||void 0===r?void 0:r.mapLineGapSecs)||120,s=[...t].sort((e,t)=>new Date(e.respawnTime)-new Date(t.respawnTime)),o=[];if(s.length>0){let e=[s[0]];for(let t=1;t<s.length;t++){const n=e[e.length-1];Math.abs(new Date(s[t].respawnTime)-new Date(n.respawnTime))/1e3<=i?e.push(s[t]):(o.push(e),e=[s[t]])}o.push(e)}if(0===o.length)return null;if((new Date(o[0][0].respawnTime)-n)/1e3/60>10)return null;const a=[];for(let l=0;l<o.length-1;l++){const e=o[l],t=o[l+1];e.forEach(e=>{e.mapPos&&t.forEach(t=>{t.mapPos&&a.push((0,Vh.jsx)("line",{x1:"".concat(e.mapPos.x,"%"),y1:"".concat(e.mapPos.y,"%"),x2:"".concat(t.mapPos.x,"%"),y2:"".concat(t.mapPos.y,"%"),stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"2",strokeDasharray:"5,5",className:"path-flow"},"".concat(e.id,"-").concat(t.id)))})})}return(0,Vh.jsxs)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none z-0",children:[(0,Vh.jsx)("style",{children:"\n          .path-flow {\n            animation: dash 1s linear infinite;\n          }\n          @keyframes dash {\n            to {\n              stroke-dashoffset: -10;\n            }\n          }\n        "}),a]})},fd=e=>{let{isOpen:t,onClose:n,bossTemplates:r,handleAddQuickRecord:i,isDarkMode:s,theme:o}=e;return t?(0,Vh.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:(0,Vh.jsxs)("div",{className:"w-full max-w-5xl h-[85vh] rounded-xl flex flex-col relative shadow-2xl border-2 ".concat(s?"bg-gray-900 border-gray-700":"bg-white border-white"),children:[(0,Vh.jsxs)("div",{className:"p-4 border-b flex justify-between items-center ".concat(s?"border-gray-700":"border-gray-200"),children:[(0,Vh.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2 ".concat(o.text),children:[(0,Vh.jsx)(L,{size:24,className:"text-yellow-500"})," \u5feb\u901f\u6a19\u7c64 (\u9ede\u64ca\u5373\u7d00\u9304)"]}),(0,Vh.jsx)("button",{onClick:n,className:"p-2 rounded-full hover:bg-red-500 hover:text-white transition-colors",children:(0,Vh.jsx)(S,{size:24})})]}),(0,Vh.jsxs)("div",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden",children:[(0,Vh.jsxs)("div",{className:"flex-1 relative overflow-hidden flex items-center justify-center ".concat(s?"bg-gray-800":"bg-gray-100"),children:[(0,Vh.jsxs)("div",{className:"relative w-auto h-auto max-w-full max-h-full",style:{aspectRatio:"1152/851"},children:[(0,Vh.jsx)("img",{src:Kh,alt:"Map",className:"w-full h-full block pointer-events-none opacity-80"}),r.filter(e=>e.mapPos).map((e,t)=>(0,Vh.jsx)("div",{onClick:()=>i(e),className:"absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer group hover:scale-110 transition-transform z-10",style:{left:"".concat(e.mapPos.x,"%"),top:"".concat(e.mapPos.y,"%")},title:"\u9ede\u64ca\u7d00\u9304: ".concat(e.name),children:(0,Vh.jsxs)("div",{className:"relative",children:[(0,Vh.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:e.color}}),(0,Vh.jsx)("div",{className:"absolute top-5 left-1/2 -translate-x-1/2 text-[10px] px-1.5 py-0.5 rounded whitespace-nowrap font-bold shadow-md\n                        ".concat(s?"bg-black/80 text-white":"bg-white/90 text-gray-800"),children:e.name})]})},e.id))]}),(0,Vh.jsx)("div",{className:"absolute bottom-4 left-4 text-xs opacity-50 bg-black/30 px-2 py-1 rounded text-white pointer-events-none",children:"* \u9ede\u64ca\u5730\u5716\u4e0a\u7684\u9ede\u6216\u53f3\u5074\u5217\u8868\u7686\u53ef\u5feb\u901f\u7d00\u9304"})]}),(0,Vh.jsx)("div",{className:"w-full lg:w-72 border-l overflow-y-auto ".concat(s?"border-gray-700 bg-gray-900":"border-gray-200 bg-white"),children:(0,Vh.jsxs)("div",{className:"p-3",children:[(0,Vh.jsx)("h4",{className:"text-sm font-bold mb-3 opacity-70 ".concat(o.text),children:"Boss \u5217\u8868"}),(0,Vh.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,Vh.jsxs)("button",{onClick:()=>i(e),className:"w-full text-left p-2 rounded flex items-center gap-2 transition-all active:scale-95\n                      ".concat(s?"hover:bg-gray-800 border border-gray-700":"hover:bg-gray-50 border border-gray-100 shadow-sm"),children:[(0,Vh.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,Vh.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Vh.jsx)("div",{className:"font-bold text-sm truncate ".concat(o.text),children:e.name}),(0,Vh.jsxs)("div",{className:"text-xs opacity-60 ".concat(o.text),children:["CD: ",e.respawnMinutes,"m"]})]}),(0,Vh.jsx)(D,{size:16,className:"opacity-40"})]},e.id))})]})})]})]})}):null},pd=t=>{let{isDarkMode:r,currentUser:i,globalSettings:s,theme:o}=t;const[a,l]=(0,e.useState)(""),[c,u]=(0,e.useState)([{role:"assistant",content:"\u4f60\u597d\uff01\u6211\u662f\u4f60\u7684\u8a18\u5e33\u52a9\u624b\u3002\u6211\u53ef\u4ee5\u5e6b\u4f60\u67e5\u8a62\u8ab0\u8ce3\u4e86\u591a\u5c11\u9322\u3001\u76ee\u524d\u7684\u6b20\u6b3e\u72c0\u6cc1\u6216\u662f\u6700\u8fd1\u7684\u4ea4\u6613\u7d00\u9304\u3002\u8acb\u554f\u6709\u4ec0\u9ebc\u53ef\u4ee5\u5e6b\u4f60\u7684\u55ce\uff1f"}]),[h,d]=(0,e.useState)(!1),f=(0,e.useRef)(null);(0,e.useEffect)(()=>{(()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[c]);const p=async()=>{if(!a.trim())return;if(!s.geminiApiKey)return u(e=>[...e,{role:"user",content:a},{role:"assistant",content:"\u26a0\ufe0f \u8acb\u5148\u81f3\u300c\u7cfb\u7d71\u5168\u57df\u8a2d\u5b9a\u300d\u4e2d\u8a2d\u5b9a Google Gemini API Key \u624d\u80fd\u4f7f\u7528\u6b64\u529f\u80fd\u3002"}]),void l("");const e=a;u(t=>[...t,{role:"user",content:e}]),l(""),d(!0);try{var t,r,i,o,c;await Th(_u(Bh,"settlement_data","main_grid")),await ch(Su(Bh,"history_items"),fh("settledAt","desc")),await ch(Su(Bh,"active_items"));const{getDocs:a,limit:l}=n(544),h=ch(Su(Bh,"history_items"),fh("settledAt","desc"),l(50)),d=await a(h),f=await a(Su(Bh,"active_items")),p=await Th(_u(Bh,"settlement_data","main_grid")),m=d.docs.map(e=>{const t=e.data();return{"\u540d\u7a31":t.itemName,"\u8ce3\u5bb6":t.seller,"\u50f9\u683c":t.price,"\u53c3\u8207\u8005":t.participants.map(e=>e.name).join(","),"\u6642\u9593":t.settledAt?t.settledAt.split("T")[0]:"\u672a\u77e5"}}),g=f.docs.map(e=>{const t=e.data();return{"\u540d\u7a31":t.itemName,"\u8ce3\u5bb6":t.seller,"\u50f9\u683c":t.price,"\u53c3\u8207\u8005":t.participants.map(e=>e.name).join(","),"\u72c0\u614b":"\u8ca9\u8ce3\u4e2d"}}),y=p.exists()?p.data().matrix:{},v="\n          \u4f60\u662f\u4e00\u500b\u8a18\u5e33\u52a9\u624b\u3002\n          \u8acb\u6839\u64da\u4ee5\u4e0b\u7684 JSON \u8cc7\u6599\u56de\u7b54\u4f7f\u7528\u8005\u7684\u554f\u984c\u3002\n          \u8acb\u7528\u7e41\u9ad4\u4e2d\u6587\u56de\u7b54\uff0c\u8a9e\u6c23\u53cb\u5584\u3002\n          \n          [\u76ee\u524d\u7684\u6b20\u6b3e\u72c0\u6cc1 (A_B \u4ee3\u8868 A \u6b20 B \u591a\u5c11\u9322)]:\n          ".concat(JSON.stringify(y),"\n\n          [\u6700\u8fd1 50 \u7b46\u5df2\u51fa\u552e\u7d00\u9304]:\n          ").concat(JSON.stringify(m),"\n\n          [\u6b63\u5728\u8ca9\u8ce3\u4e2d\u7684\u7269\u54c1]:\n          ").concat(JSON.stringify(g),"\n\n          \u5982\u679c\u8cc7\u6599\u4e2d\u6c92\u6709\u7b54\u6848\uff0c\u8acb\u76f4\u63a5\u8aaa\u4f60\u4e0d\u77e5\u9053\uff0c\u4e0d\u8981\u7de8\u9020\u3002\n          \u56de\u7b54\u8acb\u7c21\u6f54\u6709\u529b\u3002\n        "),b=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=".concat(s.geminiApiKey),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:v+"\n\n\u4f7f\u7528\u8005\u554f\u984c: "+e}]}]})}),w=await b.json();if(w.error)throw new Error(w.error.message);const x=(null===(t=w.candidates)||void 0===t||null===(r=t[0])||void 0===r||null===(i=r.content)||void 0===i||null===(o=i.parts)||void 0===o||null===(c=o[0])||void 0===c?void 0:c.text)||"\u62b1\u6b49\uff0c\u6211\u7121\u6cd5\u89e3\u8b80\u8cc7\u6599\u3002";u(e=>[...e,{role:"assistant",content:x}])}catch(h){console.error("AI Error:",h),u(e=>[...e,{role:"assistant",content:"\u767c\u751f\u932f\u8aa4: ".concat(h.message)}])}finally{d(!1)}};return(0,Vh.jsxs)("div",{className:"flex flex-col h-full rounded-xl overflow-hidden ".concat(o.card," shadow-xl border-2 border-yellow-500/30"),children:[(0,Vh.jsxs)("div",{className:"p-4 border-b flex items-center gap-3 ".concat(r?"bg-yellow-900/20 border-yellow-500/30":"bg-yellow-50 border-yellow-200"),children:[(0,Vh.jsx)("div",{className:"bg-yellow-500 p-2 rounded-full text-white shadow-lg",children:(0,Vh.jsx)(R,{size:24})}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("h3",{className:"font-bold text-lg ".concat(o.text),children:"AI \u8ca1\u52d9\u52a9\u624b"}),(0,Vh.jsx)("p",{className:"text-xs opacity-60 ".concat(o.text),children:"Powered by Gemini 1.5 Flash"})]})]}),(0,Vh.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-black/5",children:[c.map((e,t)=>(0,Vh.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,Vh.jsx)("div",{className:"max-w-[80%] p-3 rounded-2xl shadow-sm whitespace-pre-wrap ".concat("user"===e.role?"bg-blue-600 text-white rounded-br-none":"".concat(r?"bg-gray-700 text-gray-100":"bg-white text-gray-800"," rounded-bl-none")),children:e.content})},t)),h&&(0,Vh.jsx)("div",{className:"flex justify-start",children:(0,Vh.jsxs)("div",{className:"p-3 rounded-2xl rounded-bl-none flex items-center gap-2 ".concat(r?"bg-gray-700":"bg-white"),children:[(0,Vh.jsx)(E,{size:16,className:"animate-spin text-yellow-500"}),(0,Vh.jsx)("span",{className:"text-xs opacity-50",children:"AI \u6b63\u5728\u601d\u8003\u4e2d..."})]})}),(0,Vh.jsx)("div",{ref:f})]}),(0,Vh.jsxs)("div",{className:"p-4 border-t ".concat(r?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:[(0,Vh.jsxs)("div",{className:"flex gap-2",children:[(0,Vh.jsx)("input",{type:"text",className:"flex-1 p-3 rounded-xl border focus:ring-2 focus:ring-yellow-500 outline-none transition-all ".concat(o.input),placeholder:"\u8f38\u5165\u554f\u984c\uff0c\u4f8b\u5982\uff1a\u6c34\u91ce\u8ce3\u4e86\u591a\u5c11\u9322\uff1f",value:a,onChange:e=>l(e.target.value),onKeyDown:e=>"Enter"===e.key&&p()}),(0,Vh.jsx)("button",{onClick:p,disabled:h,className:"p-3 rounded-xl bg-yellow-500 text-white hover:bg-yellow-600 transition-colors shadow-lg ".concat(h?"opacity-50 cursor-not-allowed":""),children:(0,Vh.jsx)(j,{size:20})})]}),(0,Vh.jsx)("div",{className:"text-[10px] text-center mt-2 opacity-40",children:"* AI \u56de\u7b54\u50c5\u4f9b\u53c3\u8003\uff0c\u8acb\u4ee5\u5be6\u969b\u8868\u683c\u70ba\u6e96\u3002"})]})]})},md=t=>{let{isDarkMode:n,dbReady:i,currentUser:s}=t;const[o,a]=(0,e.useState)([]),[l,c]=(0,e.useState)([]),[u,h]=(0,e.useState)(!1),[d,f]=(0,e.useState)(!1),[p,m]=(0,e.useState)(null),[g,y]=(0,e.useState)(null),[v,b]=(0,e.useState)(!1),[w,x]=(0,e.useState)({name:"",date:"",dateType:"created"}),[_,E]=(0,e.useState)({seller:s||qh[0],itemName:"",price:"",cost:0,exchangeType:"GENERAL",participants:[...qh]});(0,e.useEffect)(()=>{s&&E(e=>(0,r.A)((0,r.A)({},e),{},{seller:s}))},[s]);const[T,k]=(0,e.useState)(qh[0]);(0,e.useEffect)(()=>{if(!Bh)return;const e=Dh(ch(Su(Bh,"active_items"),fh("createdAt","desc")),e=>{a(e.docs.map(e=>(0,r.A)((0,r.A)({},e.data()),{},{id:e.id})))}),t=Dh(ch(Su(Bh,"history_items"),fh("settledAt","desc")),e=>{c(e.docs.map(e=>(0,r.A)((0,r.A)({},e.data()),{},{id:e.id})))});return()=>{e(),t()}},[i]);const I=async(e,t,n)=>{Bh&&await Ch(_u(Bh,"active_items",e),{[t]:n})},N=async(e,t)=>{if(Bh)try{await function(e,t,n){e=On(e,Cu);const i=(0,r.A)((0,r.A)({},Ph),n);return function(e){if(e.maxAttempts<1)throw new rn(nn.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(e,t,n){const r=new sn;return e.asyncQueue.enqueueAndForget(async()=>{const i=await cu(e);new tu(e.asyncQueue,i,n,t,r).ju()}),r.promise}(Nu(e),n=>t(new Fh(e,n)),i)}(Bh,async n=>{const r=_u(Bh,"settlement_data","main_grid"),i=await n.get(r);let s={};i.exists()&&(s=i.data().matrix||{});const o=e.seller;e.participants.forEach(e=>{if(e.name!==o){const n="".concat(o,"_").concat(e.name),r=parseFloat(s[n])||0;s[n]=r+t}}),n.set(r,{matrix:s},{merge:!0})}),await Ah(Su(Bh,"history_items"),(0,r.A)((0,r.A)({},e),{},{settledAt:(new Date).toISOString()})),await Nh(_u(Bh,"active_items",e.id)),m(null);const n="\ud83d\udcb0 [\u51fa\u552e\u901a\u77e5] \n**".concat(e.seller,"** \u6210\u529f\u51fa\u552e\u4e86 **").concat(e.itemName,"**\uff01\n\u6bcf\u4eba\u5206\u7d05: **$").concat(t.toLocaleString(),"**\n(\u5df2\u81ea\u52d5\u8a08\u5165\u9918\u984d\u8868)");Wh(n),Xh(s,"\u51fa\u552e\u7269\u54c1","".concat(e.itemName," (\u5206\u7d05: $").concat(t,")")),alert("\u5df2\u51fa\u552e\uff01\u6bcf\u4eba\u5206\u7d05 $".concat(t," \u5df2\u52a0\u5165\u9918\u984d\u8868\u3002"))}catch(n){console.error("Settle transaction failed: ",n),alert("\u51fa\u552e\u5931\u6557\uff0c\u8acb\u91cd\u8a66")}},A=async e=>{if(Bh)try{const t=_u(Bh,d?"history_items":"active_items",e),n=await Th(t);if(!n.exists())return void alert("\u627e\u4e0d\u5230\u8a72\u9805\u76ee\uff0c\u53ef\u80fd\u5df2\u88ab\u522a\u9664");const r=n.data();if(r.seller!==s)return alert("\u6b0a\u9650\u4e0d\u8db3\uff1a\u53ea\u6709\u8ca9\u8ce3\u4eba (".concat(r.seller,") \u53ef\u4ee5\u522a\u9664\u6b64\u9805\u76ee")),Xh(s,"\u6b0a\u9650\u4e0d\u8db3","\u5617\u8a66\u522a\u9664\u975e\u672c\u4eba\u7269\u54c1\uff1a".concat(r.itemName," (\u8ce3\u5bb6: ").concat(r.seller,")")),void y(null);await Nh(t),Xh(s,"\u522a\u9664\u8a18\u5e33\u9805\u76ee","".concat(r.itemName," (").concat(d?"\u6b77\u53f2\u7d00\u9304":"\u9032\u884c\u4e2d",")")),y(null)}catch(bd){console.error("Delete failed",bd),alert("\u522a\u9664\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66")}},M={card:n?"bg-gray-800 border-gray-700":"bg-white border-gray-200",text:n?"text-gray-100":"text-gray-800",subText:n?"text-gray-400":"text-gray-500",input:n?"bg-gray-700 border-gray-600 text-white":"bg-gray-50 border-gray-200 text-gray-800",sectionBg:n?"bg-gray-700/30":"bg-gray-50"},O=l.filter(e=>{if(w.name&&!e.itemName.toLowerCase().includes(w.name.toLowerCase()))return!1;if(w.date){const t="created"===w.dateType?e.createdAt:e.settledAt;if(!t||!t.startsWith(w.date))return!1}return!0});return(0,Vh.jsxs)("div",{className:"p-4 md:p-6 max-w-7xl mx-auto",children:[(0,Vh.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vh.jsx)("h2",{className:"text-xl font-bold border-l-4 pl-3 ".concat(d?"border-gray-500":"border-blue-500"," ").concat(M.text),children:d?"\u6b77\u53f2\u7d00\u9304 (".concat(O.length,")"):"\u9032\u884c\u4e2d\u9805\u76ee (".concat(o.length,")")}),(0,Vh.jsxs)("div",{className:"flex gap-2",children:[(0,Vh.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-3 py-2 rounded bg-purple-600 text-white shadow hover:bg-purple-700",children:[(0,Vh.jsx)(C,{size:18})," \u9918\u984d\u8868\u683c"]}),(0,Vh.jsxs)("button",{onClick:()=>f(!d),className:"flex items-center gap-2 px-3 py-2 rounded ".concat(d?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:[(0,Vh.jsx)(F,{size:18})," ",d?"\u8fd4\u56de":"\u6b77\u53f2"]}),!d&&(0,Vh.jsxs)("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-3 py-2 rounded bg-blue-600 text-white shadow hover:bg-blue-700",children:[(0,Vh.jsx)(D,{size:18})," \u65b0\u589e\u9805\u76ee"]})]})]}),d&&(0,Vh.jsxs)("div",{className:"p-4 rounded mb-6 flex flex-wrap gap-4 items-end ".concat(n?"bg-gray-800":"bg-white shadow-sm"),children:[(0,Vh.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,Vh.jsx)("label",{className:"text-xs ".concat(M.subText),children:"\u641c\u5c0b\u540d\u7a31"}),(0,Vh.jsx)("input",{type:"text",className:"w-full p-2 rounded border ".concat(M.input),value:w.name,onChange:e=>x((0,r.A)((0,r.A)({},w),{},{name:e.target.value}))})]}),(0,Vh.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,Vh.jsx)("label",{className:"text-xs ".concat(M.subText),children:"\u65e5\u671f"}),(0,Vh.jsx)("input",{type:"date",className:"w-full p-2 rounded border ".concat(M.input),value:w.date,onChange:e=>x((0,r.A)((0,r.A)({},w),{},{date:e.target.value}))})]}),(0,Vh.jsx)("button",{onClick:()=>x({name:"",date:"",dateType:"created"}),className:"p-2 bg-gray-200 rounded hover:bg-red-200",children:(0,Vh.jsx)(S,{size:20})})]}),(0,Vh.jsxs)("div",{className:"space-y-6",children:[(d?O:o).map(e=>(0,Vh.jsx)(ud,{item:e,isHistory:d,theme:M,updateItemValue:I,handleSettleAll:N,handleDelete:A,confirmSettleId:p,setConfirmSettleId:m,confirmDeleteId:g,setConfirmDeleteId:y,currentUser:s},e.id)),0===(d?O:o).length&&(0,Vh.jsx)("div",{className:"text-center py-20 ".concat(M.subText),children:"\u6c92\u6709\u8cc7\u6599"})]}),u&&(0,Vh.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,Vh.jsxs)("div",{className:"w-full max-w-2xl rounded-xl p-6 ".concat(n?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,Vh.jsx)("h3",{className:"text-xl font-bold mb-4",children:"\u5efa\u7acb\u65b0\u8a18\u5e33\u9805\u76ee"}),(0,Vh.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"block text-xs mb-1 opacity-70",children:"\u8ca9\u8ce3\u4eba"}),(0,Vh.jsx)("select",{className:"w-full p-2 rounded border ".concat(M.input," bg-gray-100 cursor-not-allowed"),value:_.seller,disabled:!0,children:qh.map(e=>(0,Vh.jsx)("option",{value:e,children:e},e))})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"block text-xs mb-1 opacity-70",children:"\u50f9\u683c"}),(0,Vh.jsx)("input",{type:"number",className:"w-full p-2 rounded border ".concat(M.input),value:_.price,onChange:e=>E((0,r.A)((0,r.A)({},_),{},{price:e.target.value}))})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"block text-xs mb-1 opacity-70",children:"\u7269\u54c1\u540d\u7a31"}),(0,Vh.jsx)("input",{type:"text",className:"w-full p-2 rounded border ".concat(M.input),value:_.itemName,onChange:e=>E((0,r.A)((0,r.A)({},_),{},{itemName:e.target.value}))})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"block text-xs mb-1 opacity-70",children:"\u984d\u5916\u6210\u672c (\u624b\u52d5)"}),(0,Vh.jsx)("input",{type:"number",className:"w-full p-2 rounded border ".concat(M.input),value:_.cost,onChange:e=>E((0,r.A)((0,r.A)({},_),{},{cost:e.target.value}))})]})]}),(0,Vh.jsx)("div",{className:"mb-4 flex gap-2",children:Object.keys(Hh).map(e=>(0,Vh.jsx)("button",{onClick:()=>E((0,r.A)((0,r.A)({},_),{},{exchangeType:e})),className:"flex-1 py-1 rounded border ".concat(_.exchangeType===e?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-200 opacity-60"),children:Hh[e].label},e))}),(0,Vh.jsxs)("div",{className:"mb-4 pt-4 border-t border-gray-200",children:[(0,Vh.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,Vh.jsx)("select",{className:"flex-1 p-2 rounded border ".concat(M.input),value:T,onChange:e=>k(e.target.value),children:qh.map(e=>(0,Vh.jsx)("option",{value:e,children:e},e))}),(0,Vh.jsx)("button",{onClick:()=>{_.participants.includes(T)||E((0,r.A)((0,r.A)({},_),{},{participants:[..._.participants,T]}))},className:"bg-green-500 text-white p-2 rounded",children:(0,Vh.jsx)(D,{})})]}),(0,Vh.jsx)("div",{className:"flex flex-wrap gap-2",children:_.participants.map(e=>(0,Vh.jsxs)("span",{className:"bg-gray-100 px-2 py-1 rounded text-sm flex items-center gap-1 text-gray-700",children:[e,(0,Vh.jsx)("button",{onClick:()=>{return t=e,void E((0,r.A)((0,r.A)({},_),{},{participants:_.participants.filter(e=>e!==t)}));var t},children:(0,Vh.jsx)(S,{size:12})})]},e))})]}),(0,Vh.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,Vh.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300 text-gray-700",children:"\u53d6\u6d88"}),(0,Vh.jsx)("button",{onClick:async()=>{if(!Bh)return;if(!_.itemName||!_.price)return void alert("\u8acb\u586b\u5beb\u7269\u54c1\u540d\u7a31\u8207\u50f9\u683c");const e=[...new Set([..._.participants,_.seller])],t=(0,r.A)((0,r.A)({},_),{},{cost:parseFloat(_.cost)||0,listingHistory:[],participants:e.map(e=>({name:e})),isSold:!1,createdAt:(new Date).toISOString(),settledAt:null});await Ah(Su(Bh,"active_items"),t),Xh(s,"\u65b0\u589e\u8a18\u5e33\u9805\u76ee","".concat(t.itemName," ($").concat(t.price,")")),E({seller:s||qh[0],itemName:"",price:"",cost:0,exchangeType:"GENERAL",participants:[...qh]}),h(!1),f(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"\u5efa\u7acb\u9805\u76ee"})]})]})}),(0,Vh.jsx)(cd,{isOpen:v,onClose:()=>b(!1),theme:M,isDarkMode:n,currentUser:s})]})},gd=t=>{let{isDarkMode:n,currentUser:i,globalSettings:s}=t;const[o,a]=(0,e.useState)([]),[l,c]=(0,e.useState)([]),[u,h]=(0,e.useState)(new Date),[d,p]=(0,e.useState)(null),[m,g]=(0,e.useState)(!1),[y,v]=(0,e.useState)(!1),[b,w]=(0,e.useState)(!1),[x,_]=(0,e.useState)(null),[E,k]=(0,e.useState)(null),[I,C]=(0,e.useState)(null),[N,M]=(0,e.useState)("LIST"),[O,R]=(0,e.useState)({name:"",respawnMinutes:60,color:"#FF5733",mapPos:null}),[j,F]=(0,e.useState)({templateId:"",timeMode:"current",specificDate:"",specificTime:""}),q=(null===s||void 0===s?void 0:s.mapShowMins)||60,G=(null===s||void 0===s?void 0:s.mapBlinkMins)||10,H={text:n?"text-gray-100":"text-gray-800",subText:n?"text-gray-400":"text-gray-500",card:n?"bg-gray-800 border-gray-700":"bg-white border-gray-200",input:n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"};(0,e.useEffect)(()=>{if(!Bh)return;const e=Dh(Su(Bh,"boss_templates"),e=>{a(e.docs.map(e=>(0,r.A)({id:e.id},e.data())))}),t=Dh(ch(Su(Bh,"boss_events"),fh("respawnTime","asc")),e=>{c(e.docs.map(e=>(0,r.A)({id:e.id},e.data())))});return()=>{e(),t()}},[]),(0,e.useEffect)(()=>{const e=setInterval(()=>{const e=new Date;h(e),l.forEach(t=>{const n=new Date(t.respawnTime);(e-n)/1e3/60>.5&&Bh&&Nh(_u(Bh,"boss_events",t.id)).catch(e=>console.error("Auto delete fail",e))})},1e3);return()=>clearInterval(e)},[l]);const K=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(k(e.id),R({name:e.name,respawnMinutes:e.respawnMinutes,color:e.color,mapPos:e.mapPos||null})):(k(null),R({name:"",respawnMinutes:60,color:ed(),mapPos:null})),g(!0)},Q=e=>{C(e.id);const t=new Date(e.deathTime),n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");F({templateId:e.templateId,timeMode:"specific",specificDate:"".concat(n,"-").concat(r,"-").concat(i),specificTime:"".concat(s,":").concat(o)}),v(!0)},W=async e=>{try{const t=l.find(t=>t.id===e);await Nh(_u(Bh,"boss_events",e)),Xh(i,"\u522a\u9664\u6642\u9593\u7d00\u9304",(null===t||void 0===t?void 0:t.name)||"\u672a\u77e5"),_(null)}catch(t){console.error(t)}},X={yesterday:l.filter(e=>"yesterday"===Zh(e.respawnTime)),today:l.filter(e=>"today"===Zh(e.respawnTime)),tomorrow:l.filter(e=>"tomorrow"===Zh(e.respawnTime))},Y=l.filter(e=>(u-new Date(e.respawnTime))/1e3/60<=.5),J=Y.filter(e=>(new Date(e.respawnTime)-u)/1e3/60<=q),$=l.find(e=>new Date(e.respawnTime)>u);return(0,Vh.jsxs)("div",{className:"p-4 h-[calc(100vh-80px)] flex flex-col",children:[(0,Vh.jsx)(id,{message:d,isVisible:!!d}),(0,Vh.jsxs)("div",{className:"mb-6 p-4 rounded-xl shadow-lg flex flex-col md:flex-row items-center justify-between ".concat(n?"bg-indigo-900/50 text-white":"bg-indigo-600 text-white"),children:[(0,Vh.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vh.jsx)(P,{size:40,className:"opacity-80"}),(0,Vh.jsxs)("div",{className:"flex flex-col",children:[(0,Vh.jsx)("span",{className:"text-xs opacity-70 font-bold tracking-widest",children:"CURRENT TIME"}),(0,Vh.jsx)("span",{className:"text-3xl font-mono font-bold",children:$h(u)})]})]}),$?(0,Vh.jsxs)("div",{className:"mt-4 md:mt-0 flex items-center gap-3 bg-white/10 px-4 py-2 rounded-lg backdrop-blur-sm border border-white/20",children:[(0,Vh.jsx)("span",{className:"text-xs font-bold opacity-70",children:"NEXT BOSS"}),(0,Vh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vh.jsx)("div",{className:"w-3 h-3 rounded-full shadow-[0_0_8px_rgba(255,255,255,0.8)]",style:{backgroundColor:$.color}}),(0,Vh.jsx)("span",{className:"text-xl font-bold",children:$.name}),(0,Vh.jsx)("span",{className:"font-mono text-lg ml-2",children:Jh($.respawnTime)})]})]}):(0,Vh.jsx)("div",{className:"mt-4 md:mt-0 text-white/50 text-sm italic",children:"\u76ee\u524d\u6c92\u6709\u7b49\u5f85\u4e2d\u7684 Boss"})]}),(0,Vh.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,Vh.jsxs)("button",{onClick:()=>K(),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded shadow",children:[(0,Vh.jsx)(D,{size:18})," \u5efa\u7acb Boss"]}),(0,Vh.jsxs)("button",{onClick:()=>{var e;F({templateId:(null===(e=o[0])||void 0===e?void 0:e.id)||"",timeMode:"current",specificDate:td(),specificTime:nd(),mapPos:null}),v(!0)},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded shadow",children:[(0,Vh.jsx)(V,{size:18})," \u65b0\u589e\u7d00\u9304"]}),(0,Vh.jsxs)("button",{onClick:()=>w(!0),className:"flex items-center gap-2 bg-yellow-500 hover:bg-yellow-400 text-white px-4 py-2 rounded shadow",children:[(0,Vh.jsx)(L,{size:18})," \u5feb\u901f\u6a19\u7c64"]}),(0,Vh.jsxs)("div",{className:"ml-auto bg-gray-200 rounded-lg p-1 flex",children:["MAP"===N&&(0,Vh.jsxs)("button",{onClick:async()=>{if(!Bh)return;if(!window.confirm("\u9019\u5c07\u6703\u6839\u64da\u76ee\u524d\u7684 Boss \u8a2d\u5b9a\uff0c\u66f4\u65b0\u6240\u6709\u9032\u884c\u4e2d\u8a08\u6642\u7684\u5730\u5716\u4f4d\u7f6e\u3002\n\u78ba\u5b9a\u8981\u57f7\u884c\u55ce\uff1f"))return;const e=(Nu(t=On(t=Bh,Cu)),new Lh(t,e=>Mh(t,e)));var t;let n=0;if(l.forEach(t=>{const r=o.find(e=>e.id===t.templateId);if(r&&r.mapPos&&(!t.mapPos||t.mapPos.x!==r.mapPos.x||t.mapPos.y!==r.mapPos.y)){const i=_u(Bh,"boss_events",t.id);e.update(i,{mapPos:r.mapPos}),n++}}),n>0)try{await e.commit(),Xh(i,"\u540c\u6b65\u4f4d\u7f6e","\u66f4\u65b0\u4e86 ".concat(n," \u7b46\u8a08\u6642")),alert("\u5df2\u66f4\u65b0 ".concat(n," \u7b46\u8a08\u6642\u7684\u5730\u5716\u4f4d\u7f6e\uff01"))}catch(t){console.error("Batch update failed",t),alert("\u66f4\u65b0\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66")}else alert("\u76ee\u524d\u6240\u6709\u8a08\u6642\u7684\u4f4d\u7f6e\u7686\u70ba\u6700\u65b0\u3002")},className:"px-3 py-1 rounded flex items-center gap-1 text-sm border-r border-gray-300 text-gray-500 hover:text-blue-500 hover:bg-gray-100",children:[(0,Vh.jsx)(f,{size:14})," \u540c\u6b65\u4f4d\u7f6e"]}),(0,Vh.jsxs)("button",{onClick:()=>M("LIST"),className:"px-3 py-1 rounded flex items-center gap-1 text-sm ".concat("LIST"===N?"bg-white shadow text-blue-600":"text-gray-500"),children:[(0,Vh.jsx)(z,{size:14})," \u5217\u8868"]}),(0,Vh.jsxs)("button",{onClick:()=>M("MAP"),className:"px-3 py-1 rounded flex items-center gap-1 text-sm ".concat("MAP"===N?"bg-white shadow text-blue-600":"text-gray-500"),children:[(0,Vh.jsx)(T,{size:14})," \u5730\u5716"]})]})]}),(0,Vh.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden",children:["LIST"===N?(0,Vh.jsx)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4 h-full overflow-y-auto pb-20",children:["yesterday","today","tomorrow"].map(e=>(0,Vh.jsxs)("div",{className:"rounded-xl p-4 flex flex-col ".concat(n?"bg-gray-800/50":"bg-gray-50 border"),children:[(0,Vh.jsx)("h3",{className:"font-bold mb-3 capitalize text-center py-2 border-b ".concat(H.text),children:"yesterday"===e?"\u6628\u5929":"today"===e?"\u4eca\u5929":"\u660e\u5929"}),(0,Vh.jsx)("div",{className:"flex-1 overflow-y-auto space-y-2",children:X[e].length>0?X[e].map(e=>(0,Vh.jsx)(hd,{event:e,theme:H,confirmDeleteId:x,setConfirmDeleteId:_,handleDeleteEvent:W,handleOpenEditEvent:Q},e.id)):(0,Vh.jsx)("div",{className:"text-center text-sm opacity-40 py-4",children:"\u7121\u91cd\u751f\u7d00\u9304"})})]},e))}):(0,Vh.jsx)("div",{className:"flex-1 relative rounded-xl overflow-hidden shadow-inner flex items-center justify-center ".concat(n?"bg-gray-900":"bg-gray-200"),children:(0,Vh.jsxs)("div",{className:"relative w-auto h-auto max-w-full max-h-full",style:{aspectRatio:"1152/851"},children:[(0,Vh.jsx)("img",{src:Kh,alt:"Game Map",className:"w-full h-full block",onError:e=>{const t=e.target.parentElement;t&&(e.target.style.display="none",t.classList.add("flex","items-center","justify-center","text-gray-500","text-xs","bg-gray-300","h-64"),t.innerText="\u8acb\u5c07 map.jpg \u653e\u5165 public \u8cc7\u6599\u593e")}}),(0,Vh.jsx)(dd,{displayEvents:J,now:u,globalSettings:s}),J.filter(e=>e.mapPos).map((e,t)=>{const r=new Date(e.respawnTime)-u<=60*G*1e3;return(0,Vh.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center group cursor-pointer z-10",style:{left:"".concat(e.mapPos.x,"%"),top:"".concat(e.mapPos.y,"%")},onClick:()=>Q(e),title:"\u9ede\u64ca\u7de8\u8f2f",children:[(0,Vh.jsxs)("div",{className:"relative flex items-center justify-center",children:[r&&(0,Vh.jsx)("div",{className:"absolute w-full h-full rounded-full animate-ping opacity-75",style:{backgroundColor:e.color,transform:"scale(1.5)"}}),(0,Vh.jsx)("div",{className:"w-5 h-5 rounded-full border-2 border-white shadow-md flex items-center justify-center relative z-10",style:{backgroundColor:e.color},children:(0,Vh.jsx)("span",{className:"text-white text-[10px] font-bold pointer-events-none",children:t+1})})]}),(0,Vh.jsx)("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 text-[10px] px-1.5 py-0.5 rounded whitespace-nowrap font-bold shadow-md z-20 pointer-events-none\n                        ".concat(n?"bg-black/80 text-white":"bg-white/90 text-gray-800"),children:e.name}),(0,Vh.jsxs)("div",{className:"absolute top-12 bg-black/90 text-white text-[10px] px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-30 pointer-events-none border border-white/20",children:[t+1,". ",e.name," (",Jh(e.respawnTime),")"]})]},e.id)})]})}),(0,Vh.jsxs)("div",{className:"w-full lg:w-80 rounded-xl p-4 flex flex-col ".concat(n?"bg-gray-800":"bg-white shadow border"),children:[(0,Vh.jsxs)("h3",{className:"font-bold mb-3 flex items-center gap-2 ".concat(H.text),children:[(0,Vh.jsx)(z,{size:20})," \u91cd\u751f\u9806\u5e8f\u5217\u8868"]}),(0,Vh.jsx)("div",{className:"flex-1 overflow-y-auto space-y-2",children:Y.length>0?Y.map(e=>(0,Vh.jsxs)("div",{className:"flex items-center p-2 border-b border-gray-100 last:border-0 relative hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[(0,Vh.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0 mr-2",children:[(0,Vh.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,Vh.jsx)("span",{className:"text-sm truncate ".concat(H.text),title:e.name,children:e.name})]}),(0,Vh.jsx)("div",{className:"w-14 text-right font-mono font-bold ".concat(new Date(e.respawnTime)-u<=60*G*1e3?"text-red-500 animate-pulse":"text-blue-500"),children:Jh(e.respawnTime)}),(0,Vh.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,Vh.jsx)("button",{onClick:()=>Q(e),className:"text-gray-400 hover:text-blue-500 p-1 rounded",title:"\u7de8\u8f2f",children:(0,Vh.jsx)(U,{size:14})}),x===e.id?(0,Vh.jsx)("button",{onClick:()=>W(e.id),className:"bg-red-500 text-white text-[10px] px-2 py-0.5 rounded animate-bounce",children:"\u78ba\u8a8d"}):(0,Vh.jsx)("button",{onClick:()=>_(e.id),className:"text-gray-400 hover:text-red-500 p-1 rounded",title:"\u522a\u9664",children:(0,Vh.jsx)(A,{size:14})})]})]},"list"+e.id)):(0,Vh.jsx)("div",{className:"text-center opacity-50 py-4",children:"\u76ee\u524d\u6c92\u6709\u7b49\u5f85\u4e2d\u7684 Boss"})}),(0,Vh.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,Vh.jsx)("h4",{className:"text-xs font-bold mb-2 opacity-70",children:"Boss \u8a2d\u5b9a\u5217\u8868"}),(0,Vh.jsx)("div",{className:"flex flex-col gap-2 max-h-40 overflow-y-auto pr-1",children:o.map(e=>(0,Vh.jsxs)("div",{className:"text-xs px-2 py-1.5 rounded flex items-center justify-between ".concat(n?"bg-gray-700":"bg-gray-100"),children:[(0,Vh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vh.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),(0,Vh.jsxs)("span",{className:H.text,children:[e.name," (",e.respawnMinutes,"m)"]})]}),(0,Vh.jsxs)("div",{className:"flex gap-2",children:[(0,Vh.jsx)("button",{onClick:()=>K(e),className:"text-blue-500 hover:text-blue-600",children:(0,Vh.jsx)(U,{size:12})}),(0,Vh.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u78ba\u5b9a\u8981\u522a\u9664\u9019\u500b Boss \u8a2d\u5b9a\u55ce\uff1f"))try{const t=o.find(t=>t.id===e);await Nh(_u(Bh,"boss_templates",e)),Xh(i,"\u522a\u9664Boss\u8a2d\u5b9a",(null===t||void 0===t?void 0:t.name)||"\u672a\u77e5")}catch(t){console.error(t)}})(e.id),className:"text-gray-400 hover:text-red-500",children:(0,Vh.jsx)(S,{size:12})})]})]},e.id))})]})]})]}),m&&(0,Vh.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,Vh.jsxs)("div",{className:"w-full max-w-lg rounded-xl p-6 ".concat(n?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,Vh.jsx)("h3",{className:"text-lg font-bold mb-4",children:E?"\u7de8\u8f2f Boss \u8a2d\u5b9a":"\u5efa\u7acb Boss \u8a2d\u5b9a"}),(0,Vh.jsxs)("div",{className:"space-y-4",children:[(0,Vh.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"Boss \u540d\u7a31"}),(0,Vh.jsx)("input",{type:"text",className:"w-full p-2 rounded border ".concat(H.input),value:O.name,onChange:e=>R((0,r.A)((0,r.A)({},O),{},{name:e.target.value}))})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u91cd\u751f\u6642\u9593 (\u5206\u9418)"}),(0,Vh.jsx)("input",{type:"number",className:"w-full p-2 rounded border ".concat(H.input),value:O.respawnMinutes,onChange:e=>R((0,r.A)((0,r.A)({},O),{},{respawnMinutes:parseInt(e.target.value)||0}))})]})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u6a19\u7c64\u984f\u8272"}),(0,Vh.jsxs)("div",{className:"flex gap-2",children:[(0,Vh.jsx)("input",{type:"color",className:"flex-1 h-10 rounded cursor-pointer",value:O.color,onChange:e=>R((0,r.A)((0,r.A)({},O),{},{color:e.target.value}))}),(0,Vh.jsx)("button",{onClick:()=>R((0,r.A)((0,r.A)({},O),{},{color:ed()})),className:"bg-gray-200 text-gray-700 px-3 rounded hover:bg-gray-300",title:"\u96a8\u6a5f\u984f\u8272",children:(0,Vh.jsx)(B,{size:16})})]})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u91cd\u751f\u4f4d\u7f6e (\u8acb\u76f4\u63a5\u9ede\u64ca\u5730\u5716)"}),(0,Vh.jsxs)("div",{className:"relative w-full h-auto bg-gray-200 mt-1 cursor-crosshair rounded overflow-hidden",onClick:e=>{const t=e.currentTarget.getBoundingClientRect(),n=(e.clientX-t.left)/t.width*100,i=(e.clientY-t.top)/t.height*100;R(e=>(0,r.A)((0,r.A)({},e),{},{mapPos:{x:n,y:i}}))},children:[(0,Vh.jsx)("img",{src:Kh,alt:"Map",className:"w-full h-auto block pointer-events-none",onError:e=>{const t=e.target.parentElement;t&&(e.target.style.display="none",t.classList.add("flex","items-center","justify-center","text-gray-500","text-xs","bg-gray-300","h-64"),t.innerText="\u8acb\u5c07 map.jpg \u653e\u5165 public \u8cc7\u6599\u593e")}}),O.mapPos&&(0,Vh.jsx)("div",{className:"absolute w-4 h-4 bg-red-500 rounded-full border-2 border-white transform -translate-x-1/2 -translate-y-1/2 pointer-events-none shadow",style:{left:"".concat(O.mapPos.x,"%"),top:"".concat(O.mapPos.y,"%")}})]}),(0,Vh.jsx)("div",{className:"text-[10px] text-gray-400 mt-1 text-center",children:O.mapPos?"\u5df2\u8a2d\u5b9a\u4f4d\u7f6e: ".concat(O.mapPos.x.toFixed(1),"%, ").concat(O.mapPos.y.toFixed(1),"%"):"\u5c1a\u672a\u8a2d\u5b9a\u4f4d\u7f6e (\u9078\u586b)"})]})]}),(0,Vh.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,Vh.jsx)("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"\u53d6\u6d88"}),(0,Vh.jsx)("button",{onClick:async()=>{if(!O.name)return alert("\u8acb\u8f38\u5165 Boss \u540d\u7a31");E?(await Ch(_u(Bh,"boss_templates",E),O),Xh(i,"\u4fee\u6539Boss\u8a2d\u5b9a",O.name)):(await Ah(Su(Bh,"boss_templates"),O),Xh(i,"\u65b0\u589eBoss\u8a2d\u5b9a",O.name)),g(!1)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:E?"\u66f4\u65b0":"\u5efa\u7acb"})]})]})}),y&&(0,Vh.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,Vh.jsxs)("div",{className:"w-full max-w-sm rounded-xl p-6 ".concat(n?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,Vh.jsx)("h3",{className:"text-lg font-bold mb-4",children:I?"\u7de8\u8f2f\u6a19\u7c64\u6642\u9593":"\u65b0\u589e Boss \u6a19\u7c64"}),(0,Vh.jsxs)("div",{className:"space-y-4",children:[(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u9078\u64c7 Boss"}),(0,Vh.jsxs)("select",{className:"w-full p-2 rounded border ".concat(H.input),value:j.templateId,onChange:e=>F((0,r.A)((0,r.A)({},j),{},{templateId:e.target.value})),disabled:!!I,children:[(0,Vh.jsx)("option",{value:"",disabled:!0,children:"\u8acb\u9078\u64c7..."}),o.map(e=>(0,Vh.jsxs)("option",{value:e.id,children:[e.name," (CD: ",e.respawnMinutes,"m)"]},e.id))]})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u6b7b\u4ea1\u6642\u9593\u57fa\u6e96"}),!I&&(0,Vh.jsxs)("div",{className:"flex gap-2 mt-1 mb-2",children:[(0,Vh.jsx)("button",{onClick:()=>F((0,r.A)((0,r.A)({},j),{},{timeMode:"current"})),className:"flex-1 py-2 rounded text-sm border ".concat("current"===j.timeMode?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-200 opacity-60"),children:"\u7576\u524d\u6642\u9593"}),(0,Vh.jsx)("button",{onClick:()=>F((0,r.A)((0,r.A)({},j),{},{timeMode:"specific"})),className:"flex-1 py-2 rounded text-sm border ".concat("specific"===j.timeMode?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-200 opacity-60"),children:"\u6307\u5b9a\u6642\u9593"})]})]}),("specific"===j.timeMode||I)&&(0,Vh.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u65e5\u671f"}),(0,Vh.jsx)("input",{type:"date",className:"w-full p-2 rounded border ".concat(H.input),value:j.specificDate,onChange:e=>F((0,r.A)((0,r.A)({},j),{},{specificDate:e.target.value}))})]}),(0,Vh.jsxs)("div",{children:[(0,Vh.jsx)("label",{className:"text-xs opacity-70",children:"\u6642\u9593 (24h)"}),(0,Vh.jsx)("input",{type:"time",className:"w-full p-2 rounded border ".concat(H.input),value:j.specificTime,onChange:e=>F((0,r.A)((0,r.A)({},j),{},{specificTime:e.target.value}))})]})]})]}),(0,Vh.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,Vh.jsx)("button",{onClick:()=>{v(!1),C(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"\u53d6\u6d88"}),(0,Vh.jsx)("button",{onClick:async()=>{var e;if(!j.templateId)return alert("\u8acb\u9078\u64c7 Boss");const t=o.find(e=>e.id===j.templateId);let n,r,s,a,c=new Date;if("specific"===j.timeMode){if(!j.specificDate||!j.specificTime)return alert("\u8acb\u8f38\u5165\u5b8c\u6574\u7684\u65e5\u671f\u8207\u6642\u9593");c=new Date("".concat(j.specificDate,"T").concat(j.specificTime))}if(t)n=new Date(c.getTime()+6e4*t.respawnMinutes),r=t.name,s=t.color,a=t.mapPos;else{if(!I)return alert("\u627e\u4e0d\u5230 Boss \u8a2d\u5b9a (\u53ef\u80fd\u5df2\u88ab\u522a\u9664)");{const e=l.find(e=>e.id===I);if(!e)return alert("\u627e\u4e0d\u5230\u539f\u59cb Boss \u8a2d\u5b9a\uff0c\u7121\u6cd5\u7de8\u8f2f");{const t=new Date(e.respawnTime)-new Date(e.deathTime);n=new Date(c.getTime()+t),r=e.name,s=e.color,a=e.mapPos}}}const u={templateId:j.templateId,name:r,color:s,mapPos:a||null,deathTime:c.toISOString(),respawnTime:n.toISOString()};I?(await Ch(_u(Bh,"boss_events",I),u),Xh(i,"\u4fee\u6539\u6642\u9593\u7d00\u9304",r)):(u.createdAt=(new Date).toISOString(),await Ah(Su(Bh,"boss_events"),u),Xh(i,"\u624b\u52d5\u65b0\u589e\u7d00\u9304",r)),v(!1),C(null),F({templateId:(null===(e=o[0])||void 0===e?void 0:e.id)||"",timeMode:"current",specificDate:td(),specificTime:nd()})},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:I?"\u66f4\u65b0":"\u5efa\u7acb"})]})]})}),(0,Vh.jsx)(fd,{isOpen:b,onClose:()=>w(!1),bossTemplates:o,handleAddQuickRecord:async e=>{if(!Bh||!e)return;const t=new Date,n=new Date(t.getTime()+6e4*e.respawnMinutes),r={templateId:e.id,name:e.name,color:e.color,mapPos:e.mapPos||null,deathTime:t.toISOString(),respawnTime:n.toISOString(),createdAt:(new Date).toISOString()};try{await Ah(Su(Bh,"boss_events"),r),Xh(i,"\u5feb\u901f\u7d00\u9304","".concat(e.name)),s="\u2705 \u5df2\u7d00\u9304\uff1a".concat(e.name),p(s),setTimeout(()=>p(null),2e3)}catch(o){console.error("Quick add failed",o),alert("\u65b0\u589e\u5931\u6557")}var s},isDarkMode:n,theme:H})]})};function yd(){const[t,n]=(0,e.useState)("BOSS_TIMER"),[r,i]=(0,e.useState)(!1),[s,o]=(0,e.useState)(!1),[a,l]=(0,e.useState)(null),[c,u]=(0,e.useState)(!1),[h,d]=(0,e.useState)({appVersion:zh,mapShowMins:60,mapBlinkMins:10,mapLineGapMins:2,youtubeVideoId:"",geminiApiKey:""}),[f,p]=(0,e.useState)(!1),[m,g]=(0,e.useState)(!1),[y,v]=(0,e.useState)("");(0,e.useEffect)(()=>{Bh&&o(!0);const e=localStorage.getItem("accounting_theme");e&&i("dark"===e);const t=localStorage.getItem("accounting_user");if(t?l(t):u(!0),Bh){const e=Dh(_u(Bh,"system_data","global_settings"),e=>{if(e.exists()){const t=e.data();d(t),t.appVersion&&t.appVersion!==zh?(console.log("\u5075\u6e2c\u5230\u65b0\u7248\u672c:",t.appVersion),v(t.appVersion),g(!0)):g(!1)}});return()=>e()}},[Bh]),(0,e.useEffect)(()=>{localStorage.setItem("accounting_theme",r?"dark":"light")},[r]);const b={bg:r?"bg-gray-900":"bg-slate-100",nav:r?"bg-gray-800":"bg-slate-900",text:r?"text-gray-100":"text-gray-800",card:r?"bg-gray-800":"bg-white",subText:r?"text-gray-400":"text-gray-500",input:r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"};return(0,Vh.jsxs)("div",{className:"min-h-screen font-sans transition-colors duration-300 ".concat(b.bg," ").concat(b.text),children:[!s&&(0,Vh.jsx)("div",{className:"bg-red-600 text-white p-2 text-center text-sm font-bold sticky top-0 z-50",children:"\u5c1a\u672a\u521d\u59cb\u5316 Firebase\uff0c\u8acb\u6aa2\u67e5\u91d1\u9470\u8a2d\u5b9a\uff01"}),(0,Vh.jsx)("div",{className:"absolute top-0 left-0 p-1 text-[10px] text-gray-500 opacity-50 pointer-events-none z-50",children:zh}),(0,Vh.jsx)(sd,{show:m,remoteVersion:y,onRefresh:()=>{window.location.reload()}}),(0,Vh.jsx)("nav",{className:"".concat(b.nav," text-white px-4 py-3 shadow-lg sticky top-0 z-40"),children:(0,Vh.jsxs)("div",{className:"max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,Vh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vh.jsx)("div",{className:"bg-blue-500 p-2 rounded-lg",children:"ACCOUNTING"===t?(0,Vh.jsx)(q,{size:24,className:"text-white"}):"BOSS_TIMER"===t?(0,Vh.jsx)(G,{size:24,className:"text-white"}):(0,Vh.jsx)(R,{size:24,className:"text-white"})}),(0,Vh.jsx)("h1",{className:"text-2xl font-bold tracking-wider hidden md:block",children:"ACCOUNTING"===t?"\u5718\u968a\u8a18\u5e33\u8868":"BOSS_TIMER"===t?"Boss \u91cd\u751f\u8a08\u6642":"AI \u8ca1\u52d9\u52a9\u624b"}),(0,Vh.jsxs)("div",{className:"flex md:hidden bg-gray-700 rounded-lg p-1",children:[(0,Vh.jsx)("button",{onClick:()=>n("ACCOUNTING"),className:"px-2 py-1 rounded text-xs ".concat("ACCOUNTING"===t?"bg-blue-600 text-white":"text-gray-300"),children:"\u8a18\u5e33"}),(0,Vh.jsx)("button",{onClick:()=>n("BOSS_TIMER"),className:"px-2 py-1 rounded text-xs ".concat("BOSS_TIMER"===t?"bg-purple-600 text-white":"text-gray-300"),children:"Boss"}),(0,Vh.jsx)("button",{onClick:()=>n("AI_ASSISTANT"),className:"px-2 py-1 rounded text-xs ".concat("AI_ASSISTANT"===t?"bg-yellow-500 text-white":"text-gray-300"),children:"AI"})]})]}),(0,Vh.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,Vh.jsx)("button",{onClick:()=>p(!0),className:"p-2 rounded-full hover:bg-white/10 transition-colors",title:"\u7cfb\u7d71\u5168\u57df\u8a2d\u5b9a",children:(0,Vh.jsx)(x,{size:20})}),a&&(0,Vh.jsxs)("div",{className:"flex items-center gap-2 bg-black/20 px-3 py-1 rounded-full text-sm",children:[(0,Vh.jsx)(I,{size:14})," ",a,(0,Vh.jsx)("button",{onClick:()=>{localStorage.removeItem("accounting_user"),l(null),u(!0)},className:"ml-2 p-1 bg-red-500/80 hover:bg-red-600 rounded text-white transition-colors",title:"\u767b\u51fa / \u5207\u63db\u4f7f\u7528\u8005",children:(0,Vh.jsx)(H,{size:12})})]}),(0,Vh.jsxs)("div",{className:"hidden md:flex gap-2 mr-4 bg-gray-700/50 p-1 rounded-lg",children:[(0,Vh.jsxs)("button",{onClick:()=>n("ACCOUNTING"),className:"flex items-center gap-2 px-4 py-1.5 rounded-md transition-all ".concat("ACCOUNTING"===t?"bg-blue-600 text-white shadow":"hover:bg-white/10 text-gray-300"),children:[(0,Vh.jsx)(q,{size:16})," \u5718\u968a\u8a18\u5e33"]}),(0,Vh.jsxs)("button",{onClick:()=>n("BOSS_TIMER"),className:"flex items-center gap-2 px-4 py-1.5 rounded-md transition-all ".concat("BOSS_TIMER"===t?"bg-purple-600 text-white shadow":"hover:bg-white/10 text-gray-300"),children:[(0,Vh.jsx)(G,{size:16})," Boss \u6642\u9593"]}),(0,Vh.jsxs)("button",{onClick:()=>n("AI_ASSISTANT"),className:"flex items-center gap-2 px-4 py-1.5 rounded-md transition-all ".concat("AI_ASSISTANT"===t?"bg-yellow-500 text-white shadow":"hover:bg-white/10 text-gray-300"),children:[(0,Vh.jsx)(R,{size:16})," AI \u52a9\u624b"]})]}),(0,Vh.jsx)("button",{onClick:()=>i(!r),className:"p-2 rounded-full hover:bg-white/10 transition-colors",children:r?(0,Vh.jsx)(K,{size:20,className:"text-yellow-300"}):(0,Vh.jsx)(Q,{size:20})})]})]})}),(0,Vh.jsxs)("main",{className:"relative h-[calc(100vh-80px)] overflow-hidden",children:[(0,Vh.jsx)(ld,{isOpen:c,onSelectUser:e=>{l(e),localStorage.setItem("accounting_user",e),u(!1)},theme:b}),(0,Vh.jsx)(ad,{isOpen:f,onClose:()=>p(!1),theme:b,currentSettings:h,isDarkMode:r,currentUser:a}),(0,Vh.jsx)(od,{videoId:h.youtubeVideoId,isDarkMode:r}),(0,Vh.jsx)("div",{className:"h-full overflow-y-auto",children:"ACCOUNTING"===t?(0,Vh.jsx)(md,{isDarkMode:r,dbReady:s,currentUser:a}):"BOSS_TIMER"===t?(0,Vh.jsx)(gd,{isDarkMode:r,currentUser:a,globalSettings:h}):(0,Vh.jsx)("div",{className:"p-4 h-full max-w-4xl mx-auto",children:(0,Vh.jsx)(pd,{isDarkMode:r,currentUser:a,globalSettings:h,theme:b})})})]})]})}const vd=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)})};t.createRoot(document.getElementById("root")).render((0,Vh.jsx)(e.StrictMode,{children:(0,Vh.jsx)(yd,{})})),vd()})()})();
//# sourceMappingURL=main.e0ddee8f.js.map